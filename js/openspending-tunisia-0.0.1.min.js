(function(v){var u="0.4.0",t="hasOwnProperty",s=/[\.\/]/,r="*",q=function(){},p=function(e,d){return e-d},o,n,m={n:{}},l=function(D,C){var B=m,A=n,z=Array.prototype.slice.call(arguments,2),y=l.listeners(D),x=0,w=!1,k,j=[],i={},h=[],g=[];o=D,n=0;for(var F=0,E=y.length;F<E;F++){"zIndex" in y[F]&&(j.push(y[F].zIndex),y[F].zIndex<0&&(i[y[F].zIndex]=y[F]))}j.sort(p);while(j[x]<0){k=i[j[x++]],h.push(k.apply(C,z));if(n){n=A;return h}}for(F=0;F<E;F++){k=y[F];if("zIndex" in k){if(k.zIndex==j[x]){h.push(k.apply(C,z));if(n){n=A;return h}do{x++,k=i[j[x]],k&&h.push(k.apply(C,z));if(n){n=A;return h}}while(k)}else{i[k.zIndex]=k}}else{h.push(k.apply(C,z));if(n){n=A;return h}}}n=A;return h.length?h:null};l.listeners=function(F){var E=F.split(s),D=m,C,B,A,z,y,x,w,j,e=[D],d=[];for(z=0,y=E.length;z<y;z++){j=[];for(x=0,w=e.length;x<w;x++){D=e[x].n,B=[D[E[z]],D[r]],A=2;while(A--){C=B[A],C&&(j.push(C),d=d.concat(C.f||[]))}}e=j}return d},l.on=function(f,d){var w=f.split(s),k=m;for(var j=0,i=w.length;j<i;j++){k=k.n,!k[w[j]]&&(k[w[j]]={n:{}}),k=k[w[j]]}k.f=k.f||[];for(j=0,i=k.f.length;j<i;j++){if(k.f[j]==d){return q}}k.f.push(d);return function(b){+b==+b&&(d.zIndex=+b)}},l.stop=function(){n=1},l.nt=function(b){if(b){return(new RegExp("(?:\\.|\\/|^)"+b+"(?:\\.|\\/|$)")).test(o)}return o},l.unbind=function(E,D){var C=E.split(s),B,A,z,y,x,w,j,e=[m];for(y=0,x=C.length;y<x;y++){for(w=0;w<e.length;w+=z.length-2){z=[w,1],B=e[w].n;if(C[y]!=r){B[C[y]]&&z.push(B[C[y]])}else{for(A in B){B[t](A)&&z.push(B[A])}}e.splice.apply(e,z)}}for(y=0,x=e.length;y<x;y++){B=e[y];while(B.n){if(D){if(B.f){for(w=0,j=B.f.length;w<j;w++){if(B.f[w]==D){B.f.splice(w,1);break}}!B.f.length&&delete B.f}for(A in B.n){if(B.n[t](A)&&B.n[A].f){var d=B.n[A].f;for(w=0,j=d.length;w<j;w++){if(d[w]==D){d.splice(w,1);break}}!d.length&&delete B.n[A].f}}}else{delete B.f;for(A in B.n){B.n[t](A)&&B.n[A].f&&delete B.n[A].f}}B=B.n}}},l.once=function(e,d){var f=function(){d.apply(this,arguments),l.unbind(e,f)};return l.on(e,f)},l.version=u,l.toString=function(){return"You are running Eve "+u},typeof module!="undefined"&&module.exports?module.exports=l:v.eve=l})(this),function(){function ad(bs,br,bq,bp,bo,bn){bq=cF(bq);var bm,bl,bk,bj=[],bi,bh,bf,bc=bs.ms,ba={},Y={},W={};if(bp){for(S=0,N=ak.length;S<N;S++){var U=ak[S];if(U.el.id==br.id&&U.anim==bs){U.percent!=bq?(ak.splice(S,1),bk=1):bl=U,br.attr(U.totalOrigin);break}}}else{bp=+Y}for(var S=0,N=bs.percents.length;S<N;S++){if(bs.percents[S]==bq||bs.percents[S]>bp*bs.top){bq=bs.percents[S],bh=bs.percents[S-1]||0,bc=bc/bs.top*(bq-bh),bi=bs.percents[S+1],bm=bs.anim[bq];break}bp&&br.attr(bs.anim[bs.percents[S]])}if(!!bm){if(!bl){for(var bg in bm){if(bm[aR](bg)){if(cx[aR](bg)||br.paper.customAttributes[aR](bg)){ba[bg]=br.attr(bg),ba[bg]==null&&(ba[bg]=cz[bg]),Y[bg]=bm[bg];switch(cx[bg]){case c2:W[bg]=(Y[bg]-ba[bg])/bc;break;case"colour":ba[bg]=a2.getRGB(ba[bg]);var be=a2.getRGB(Y[bg]);W[bg]={r:(be.r-ba[bg].r)/bc,g:(be.g-ba[bg].g)/bc,b:(be.b-ba[bg].b)/bc};break;case"path":var bd=di(ba[bg],Y[bg]),bb=bd[1];ba[bg]=bd[0],W[bg]=[];for(S=0,N=ba[bg].length;S<N;S++){W[bg][S]=[0];for(var Z=1,X=ba[bg][S].length;Z<X;Z++){W[bg][S][Z]=(bb[S][Z]-ba[bg][S][Z])/bc}}break;case"transform":var V=br._,T=c9(V[bg],Y[bg]);if(T){ba[bg]=T.from,Y[bg]=T.to,W[bg]=[],W[bg].real=!0;for(S=0,N=ba[bg].length;S<N;S++){W[bg][S]=[ba[bg][S][0]];for(Z=1,X=ba[bg][S].length;Z<X;Z++){W[bg][S][Z]=(Y[bg][S][Z]-ba[bg][S][Z])/bc}}}else{var Q=br.matrix||new c8,C={_:{transform:V.transform},getBBox:function(){return br.getBBox(1)}};ba[bg]=[Q.a,Q.b,Q.c,Q.d,Q.e,Q.f],db(C,Y[bg]),Y[bg]=C._.transform,W[bg]=[(C.matrix.a-Q.a)/bc,(C.matrix.b-Q.b)/bc,(C.matrix.c-Q.c)/bc,(C.matrix.d-Q.d)/bc,(C.matrix.e-Q.e)/bc,(C.matrix.e-Q.f)/bc]}break;case"csv":var s=aA(bm[bg])[ay](aZ),r=aA(ba[bg])[ay](aZ);if(bg=="clip-rect"){ba[bg]=r,W[bg]=[],S=r.length;while(S--){W[bg][S]=(s[S]-ba[bg][S])/bc}}Y[bg]=s;break;default:s=[][aI](bm[bg]),r=[][aI](ba[bg]),W[bg]=[],S=br.paper.customAttributes[bg].length;while(S--){W[bg][S]=((s[S]||0)-(r[S]||0))/bc}}}}}var n=bm.easing,g=a2.easing_formulas[n];if(!g){g=aA(n).match(cK);if(g&&g.length==5){var a=g;g=function(b){return af(b,+a[1],+a[2],+a[3],+a[4],bc)}}else{g=cA}}bf=bm.start||bs.start||+(new Date),U={anim:bs,percent:bq,timestamp:bf,start:bf+(bs.del||0),status:0,initstatus:bp||0,stop:!1,ms:bc,easing:g,from:ba,diff:W,to:Y,el:br,callback:bm.callback,prev:bh,next:bi,repeat:bn||bs.times,origin:br.attr(),totalOrigin:bo},ak.push(U);if(bp&&!bl&&!bk){U.stop=!0,U.start=new Date-bc*bp;if(ak.length==1){return ah()}}bk&&(U.start=new Date-U.ms*bp),ak.length==1&&ai(ah)}else{bl.initstatus=bp,bl.start=new Date-bl.ms*bp}eve("anim.start."+br.id,br,bs)}}function ae(g,f){var j=[],i={};this.ms=f,this.times=1;if(g){for(var h in g){g[aR](h)&&(i[cF(h)]=g[h],j.push(cF(h)))}j.sort(cE)}this.anim=i,this.top=j[j.length-1],this.percents=j}function af(D,C,B,A,z,y){function p(h,g){var E,o,n,m,l,i;for(n=h,i=0;i<8;i++){m=r(n)-h;if(aj(m)<g){return n}l=(3*v*n+2*w)*n+x;if(aj(l)<0.000001){break}n=n-m/l}E=0,o=1,n=h;if(n<E){return E}if(n>o){return o}while(E<o){m=r(n);if(aj(m-h)<g){return n}h>m?E=n:o=n,n=(o-E)/2+E}return n}function q(e,d){var f=p(e,d);return((s*f+t)*f+u)*f}function r(b){return((v*b+w)*b+x)*b}var x=3*C,w=3*(A-C)-x,v=1-x-w,u=3*B,t=3*(z-B)-u,s=1-u-t;return q(D,1/(200*y))}function aC(){return this.x+aB+this.y+aB+this.width+" × "+this.height}function aE(){return this.x+aB+this.y}function c8(h,g,l,k,j,i){h!=null?(this.a=+h,this.b=+g,this.c=+l,this.d=+k,this.e=+j,this.f=+i):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0)}function aV(g){var f=[];for(var j=0,i=g.length;i-2>j;j+=2){var h=[{x:+g[j],y:+g[j+1]},{x:+g[j],y:+g[j+1]},{x:+g[j+2],y:+g[j+3]},{x:+g[j+4],y:+g[j+5]}];i-4==j?(h[0]={x:+g[j-2],y:+g[j-1]},h[3]=h[2]):j&&(h[0]={x:+g[j-2],y:+g[j-1]}),f.push(["C",(-h[0].x+6*h[1].x+h[2].x)/6,(-h[0].y+6*h[1].y+h[2].y)/6,(h[1].x+6*h[2].x-h[3].x)/6,(h[1].y+6*h[2].y-h[3].y)/6,h[2].x,h[2].y])}return f}function aX(){return this.hex}function a1(f,e,h){function g(){var j=Array.prototype.slice.call(arguments,0),d=j.join("␀"),b=g.cache=g.cache||{},a=g.count=g.count||[];if(b[aR](d)){a3(a,d);return h?h(b[d]):b[d]}a.length>=1000&&delete b[a.shift()],a.push(d),b[d]=f[aJ](e,j);return h?h(b[d]):b[d]}return g}function a3(f,e){for(var h=0,g=f.length;h<g;h++){if(f[h]===e){return f.push(f.splice(h,1)[0])}}}function a2(f){if(a2.is(f,"function")){return a0?f():eve.on("DOMload",f)}if(a2.is(f,cY)){return a2._engine.create[aJ](a2,f.splice(0,3+a2.is(f[0],c2))).add(f)}var b=Array.prototype.slice.call(arguments,0);if(a2.is(b[b.length-1],"function")){var a=b.pop();return a0?a.call(a2._engine.create[aJ](a2,b)):eve.on("DOMload",function(){a.call(a2._engine.create[aJ](a2,b))})}return a2._engine.create[aJ](a2,arguments)}a2.version="2.0.1",a2.eve=eve;var a0,aZ=/[, ]+/,aW={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},aU=/\{(\d+)\}/g,aT="prototype",aR="hasOwnProperty",aP={doc:document,win:window},aN={was:Object.prototype[aR].call(aP.win,"Raphael"),is:aP.win.Raphael},aM=function(){this.ca=this.customAttributes={}},aL,aK="appendChild",aJ="apply",aI="concat",aG="createTouch" in aP.doc,aD="",aB=" ",aA=String,ay="split",aw="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend touchcancel"[ay](aB),au={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},ar=aA.prototype.toLowerCase,ap=Math,an=ap.max,al=ap.min,aj=ap.abs,c6=ap.pow,c4=ap.PI,c2="number",c0="string",cY="array",cW="toString",cU="fill",cS=Object.prototype.toString,cQ={},cP="push",cO=a2._ISURL=/^url\(['"]?([^\)]+?)['"]?\)$/i,cN=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,cM={NaN:1,Infinity:1,"-Infinity":1},cK=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,cJ=ap.round,cH="setAttribute",cF=parseFloat,cD=parseInt,cB=aA.prototype.toUpperCase,cz=a2._availableAttrs={"arrow-end":"none","arrow-start":"none",blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/","letter-spacing":0,opacity:1,path:"M0,0",r:0,rx:0,ry:0,src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",transform:"",width:0,x:0,y:0},cx=a2._availableAnimAttrs={blur:c2,"clip-rect":"csv",cx:c2,cy:c2,fill:"colour","fill-opacity":c2,"font-size":c2,height:c2,opacity:c2,path:"path",r:c2,rx:c2,ry:c2,stroke:"colour","stroke-opacity":c2,"stroke-width":c2,transform:"transform",width:c2,x:c2,y:c2},cv=/\s*,\s*/,b8={hs:1,rg:1},b6=/,?([achlmqrstvxz]),?/gi,b4=/([achlmrqstvz])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,b2=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?\s*,?\s*)+)/ig,dq=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)\s*,?\s*/ig,a6=a2._radial_gradient=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,cI={},cG=function(e,d){return e.key-d.key},cE=function(e,d){return cF(e)-cF(d)},cC=function(){},cA=function(b){return b},cy=a2._rectPath=function(g,f,j,i,h){if(h){return[["M",g+h,f],["l",j-h*2,0],["a",h,h,0,0,1,h,h],["l",0,i-h*2],["a",h,h,0,0,1,-h,h],["l",h*2-j,0],["a",h,h,0,0,1,-h,-h],["l",0,h*2-i],["a",h,h,0,0,1,h,-h],["z"]]}return[["M",g,f],["l",j,0],["l",0,i],["l",-j,0],["z"]]},cw=function(f,e,h,g){g==null&&(g=h);return[["M",f,e],["m",0,-g],["a",h,g,0,1,1,0,2*g],["a",h,g,0,1,1,0,-2*g],["z"]]},b9=a2._getPath={path:function(b){return b.attr("path")},circle:function(e){var d=e.attrs;return cw(d.cx,d.cy,d.r)},ellipse:function(e){var d=e.attrs;return cw(d.cx,d.cy,d.rx,d.ry)},rect:function(e){var d=e.attrs;return cy(d.x,d.y,d.width,d.height,d.r)},image:function(e){var d=e.attrs;return cy(d.x,d.y,d.width,d.height)},text:function(e){var d=e._getBBox();return cy(d.x,d.y,d.width,d.height)}},b7=a2.mapPath=function(r,q){if(!q){return r}var p,o,n,m,l,k,j;r=di(r);for(n=0,l=r.length;n<l;n++){j=r[n];for(m=1,k=j.length;m<k;m+=2){p=q.x(j[m],j[m+1]),o=q.y(j[m],j[m+1]),j[m]=p,j[m+1]=o}}return r};a2._g=aP,a2.type=aP.win.SVGAngle||aP.doc.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if(a2.type=="VML"){var b5=aP.doc.createElement("div"),b3;b5.innerHTML='<v:shape adj="1"/>',b3=b5.firstChild,b3.style.behavior="url(#default#VML)";if(!b3||typeof b3.adj!="object"){return a2.type=aD}b5=null}a2.svg=!(a2.vml=a2.type=="VML"),a2._Paper=aM,a2.fn=aL=aM.prototype=a2.prototype,a2._id=0,a2._oid=0,a2.is=function(e,d){d=ar.call(d);if(d=="finite"){return !cM[aR](+e)}if(d=="array"){return e instanceof Array}return d=="null"&&e===null||d==typeof e&&e!==null||d=="object"&&e===Object(e)||d=="array"&&Array.isArray&&Array.isArray(e)||cS.call(e).slice(8,-1).toLowerCase()==d},a2.angle=function(a,p,o,n,m,l){if(m==null){var k=a-o,j=p-n;if(!k&&!j){return 0}return(180+ap.atan2(-j,-k)*180/c4+360)%360}return a2.angle(a,p,m,l)-a2.angle(o,n,m,l)},a2.rad=function(b){return b%360*c4/180},a2.deg=function(b){return b*180/c4%360},a2.snapTo=function(a,j,i){i=a2.is(i,"finite")?i:10;if(a2.is(a,cY)){var h=a.length;while(h--){if(aj(a[h]-j)<=i){return a[h]}}}else{a=+a;var g=j%a;if(g<i){return j-g}if(g>a-i){return j-g+a}}return j};var b1=a2.createUUID=function(e,d){return function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(e,d).toUpperCase()}}(/[xy]/g,function(e){var d=ap.random()*16|0,f=e=="x"?d:d&3|8;return f.toString(16)});a2.setWindow=function(a){eve("setWindow",a2,aP.win,a),aP.win=a,aP.doc=aP.win.document,a2._engine.initWin&&a2._engine.initWin(aP.win)};var b0=function(a){if(a2.vml){var n=/^\s+|\s+$/g,m;try{var l=new ActiveXObject("htmlfile");l.write("<body>"),l.close(),m=l.body}catch(k){m=createPopup().document.body}var j=m.createTextRange();b0=a1(function(f){try{m.style.color=aA(f).replace(n,aD);var d=j.queryCommandValue("ForeColor");d=(d&255)<<16|d&65280|(d&16711680)>>>16;return"#"+("000000"+d.toString(16)).slice(-6)}catch(g){return"none"}})}else{var h=aP.doc.createElement("i");h.title="Raphaël Colour Picker",h.style.display="none",aP.doc.body.appendChild(h),b0=a1(function(b){h.style.color=b;return aP.doc.defaultView.getComputedStyle(h,aD).getPropertyValue("color")})}return b0(a)},a9=function(){return"hsb("+[this.h,this.s,this.b]+")"},a8=function(){return"hsl("+[this.h,this.s,this.l]+")"},a7=function(){return this.hex},a5=function(a,h,g){h==null&&a2.is(a,"object")&&"r" in a&&"g" in a&&"b" in a&&(g=a.b,h=a.g,a=a.r);if(h==null&&a2.is(a,c0)){var f=a2.getRGB(a);a=f.r,h=f.g,g=f.b}if(a>1||h>1||g>1){a/=255,h/=255,g/=255}return[a,h,g]},a4=function(a,j,i,h){a*=255,j*=255,i*=255;var g={r:a,g:j,b:i,hex:a2.rgb(a,j,i),toString:a7};a2.is(h,"finite")&&(g.opacity=h);return g};a2.color=function(a){var d;a2.is(a,"object")&&"h" in a&&"s" in a&&"b" in a?(d=a2.hsb2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):a2.is(a,"object")&&"h" in a&&"s" in a&&"l" in a?(d=a2.hsl2rgb(a),a.r=d.r,a.g=d.g,a.b=d.b,a.hex=d.hex):(a2.is(a,"string")&&(a=a2.getRGB(a)),a2.is(a,"object")&&"r" in a&&"g" in a&&"b" in a?(d=a2.rgb2hsl(a),a.h=d.h,a.s=d.s,a.l=d.l,d=a2.rgb2hsb(a),a.v=d.b):(a={hex:"none"},a.r=a.g=a.b=a.h=a.s=a.v=a.l=-1)),a.toString=a7;return a},a2.hsb2rgb=function(r,q,p,o){this.is(r,"object")&&"h" in r&&"s" in r&&"b" in r&&(p=r.b,q=r.s,r=r.h,o=r.o),r*=360;var n,m,l,k,j;r=r%360/60,j=p*q,k=j*(1-aj(r%2-1)),n=m=l=p-j,r=~~r,n+=[j,k,0,0,k,j][r],m+=[k,j,j,k,0,0][r],l+=[0,0,k,j,j,k][r];return a4(n,m,l,o)},a2.hsl2rgb=function(r,q,p,o){this.is(r,"object")&&"h" in r&&"s" in r&&"l" in r&&(p=r.l,q=r.s,r=r.h);if(r>1||q>1||p>1){r/=360,q/=100,p/=100}r*=360;var n,m,l,k,j;r=r%360/60,j=2*q*(p<0.5?p:1-p),k=j*(1-aj(r%2-1)),n=m=l=p-j/2,r=~~r,n+=[j,k,0,0,k,j][r],m+=[k,j,j,k,0,0][r],l+=[0,0,k,j,j,k][r];return a4(n,m,l,o)},a2.rgb2hsb=function(i,h,n){n=a5(i,h,n),i=n[0],h=n[1],n=n[2];var m,l,k,j;k=an(i,h,n),j=k-al(i,h,n),m=j==0?null:k==i?(h-n)/j:k==h?(n-i)/j+2:(i-h)/j+4,m=(m+360)%6*60/360,l=j==0?0:j/k;return{h:m,s:l,b:k,toString:a9}},a2.rgb2hsl=function(r,q,p){p=a5(r,q,p),r=p[0],q=p[1],p=p[2];var o,n,m,l,k,j;l=an(r,q,p),k=al(r,q,p),j=l-k,o=j==0?null:l==r?(q-p)/j:l==q?(p-r)/j+2:(r-q)/j+4,o=(o+360)%6*60/360,m=(l+k)/2,n=j==0?0:m<0.5?j/(2*m):j/(2-2*m);return{h:o,s:n,l:m,toString:a8}},a2._path2string=function(){return this.join(",").replace(b6,"$1")};var aY=a2._preload=function(e,d){var f=aP.doc.createElement("img");f.style.cssText="position:absolute;left:-9999em;top:-9999em",f.onload=function(){d.call(this),this.onload=null,aP.doc.body.removeChild(this)},f.onerror=function(){aP.doc.body.removeChild(this)},aP.doc.body.appendChild(f),f.src=e};a2.getRGB=a1(function(r){if(!r||!!((r=aA(r)).indexOf("-")+1)){return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aX}}if(r=="none"){return{r:-1,g:-1,b:-1,hex:"none",toString:aX}}!b8[aR](r.toLowerCase().substring(0,2))&&r.charAt()!="#"&&(r=b0(r));var q,p,o,n,m,l,g,a=r.match(cN);if(a){a[2]&&(n=cD(a[2].substring(5),16),o=cD(a[2].substring(3,5),16),p=cD(a[2].substring(1,3),16)),a[3]&&(n=cD((l=a[3].charAt(3))+l,16),o=cD((l=a[3].charAt(2))+l,16),p=cD((l=a[3].charAt(1))+l,16)),a[4]&&(g=a[4][ay](cv),p=cF(g[0]),g[0].slice(-1)=="%"&&(p*=2.55),o=cF(g[1]),g[1].slice(-1)=="%"&&(o*=2.55),n=cF(g[2]),g[2].slice(-1)=="%"&&(n*=2.55),a[1].toLowerCase().slice(0,4)=="rgba"&&(m=cF(g[3])),g[3]&&g[3].slice(-1)=="%"&&(m/=100));if(a[5]){g=a[5][ay](cv),p=cF(g[0]),g[0].slice(-1)=="%"&&(p*=2.55),o=cF(g[1]),g[1].slice(-1)=="%"&&(o*=2.55),n=cF(g[2]),g[2].slice(-1)=="%"&&(n*=2.55),(g[0].slice(-3)=="deg"||g[0].slice(-1)=="°")&&(p/=360),a[1].toLowerCase().slice(0,4)=="hsba"&&(m=cF(g[3])),g[3]&&g[3].slice(-1)=="%"&&(m/=100);return a2.hsb2rgb(p,o,n,m)}if(a[6]){g=a[6][ay](cv),p=cF(g[0]),g[0].slice(-1)=="%"&&(p*=2.55),o=cF(g[1]),g[1].slice(-1)=="%"&&(o*=2.55),n=cF(g[2]),g[2].slice(-1)=="%"&&(n*=2.55),(g[0].slice(-3)=="deg"||g[0].slice(-1)=="°")&&(p/=360),a[1].toLowerCase().slice(0,4)=="hsla"&&(m=cF(g[3])),g[3]&&g[3].slice(-1)=="%"&&(m/=100);return a2.hsl2rgb(p,o,n,m)}a={r:p,g:o,b:n,toString:aX},a.hex="#"+(16777216|n|o<<8|p<<16).toString(16).slice(1),a2.is(m,"finite")&&(a.opacity=m);return a}return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:aX}},a2),a2.hsb=a1(function(a,f,e){return a2.hsb2rgb(a,f,e).hex}),a2.hsl=a1(function(a,f,e){return a2.hsl2rgb(a,f,e).hex}),a2.rgb=a1(function(e,d,f){return"#"+(16777216|f|d<<8|e<<16).toString(16).slice(1)}),a2.getColor=function(e){var d=this.getColor.start=this.getColor.start||{h:0,s:1,b:e||0.75},f=this.hsb2rgb(d.h,d.s,d.b);d.h+=0.075,d.h>1&&(d.h=0,d.s-=0.2,d.s<=0&&(this.getColor.start={h:0,s:1,b:d.b}));return f.hex},a2.getColor.reset=function(){delete this.start},a2.parsePathString=a1(function(a){if(!a){return null}var f={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},e=[];a2.is(a,cY)&&a2.is(a[0],cY)&&(e=aQ(a)),e.length||aA(a).replace(b4,function(h,d,k){var j=[],i=d.toLowerCase();k.replace(dq,function(l,g){g&&j.push(+g)}),i=="m"&&j.length>2&&(e.push([d][aI](j.splice(0,2))),i="l",d=d=="m"?"l":"L");if(i=="r"){e.push([d][aI](j))}else{while(j.length>=f[i]){e.push([d][aI](j.splice(0,f[i])));if(!f[i]){break}}}}),e.toString=a2._path2string;return e}),a2.parseTransformString=a1(function(a){if(!a){return null}var f={r:3,s:4,t:2,m:6},e=[];a2.is(a,cY)&&a2.is(a[0],cY)&&(e=aQ(a)),e.length||aA(a).replace(b2,function(g,d,j){var i=[],h=ar.call(d);j.replace(dq,function(l,k){k&&i.push(+k)}),e.push([d][aI](i))}),e.toString=a2._path2string;return e}),a2.findDotsAtSegment=function(X,W,V,U,T,S,R,Q,P){var O=1-P,N=c6(O,3),M=c6(O,2),L=P*P,K=L*P,J=N*X+M*3*P*V+O*3*P*P*T+K*R,I=N*W+M*3*P*U+O*3*P*P*S+K*Q,H=X+2*P*(V-X)+L*(T-2*V+X),G=W+2*P*(U-W)+L*(S-2*U+W),F=V+2*P*(T-V)+L*(R-2*T+V),E=U+2*P*(S-U)+L*(Q-2*S+U),D=O*X+P*V,C=O*W+P*U,B=O*T+P*R,A=O*S+P*Q,w=90-ap.atan2(H-F,G-E)*180/c4;(H>F||G<E)&&(w+=180);return{x:J,y:I,m:{x:H,y:G},n:{x:F,y:E},start:{x:D,y:C},end:{x:B,y:A},alpha:w}},a2._removedFactory=function(b){return function(){throw new Error("Raphaël: you are calling to method “"+b+"” of removed object")}};var aS=a1(function(v){if(!v){return{x:0,y:0,width:0,height:0}}v=di(v);var u=0,t=0,s=[],r=[],q;for(var p=0,o=v.length;p<o;p++){q=v[p];if(q[0]=="M"){u=q[1],t=q[2],s.push(u),r.push(t)}else{var n=dj(u,t,q[1],q[2],q[3],q[4],q[5],q[6]);s=s[aI](n.min.x,n.max.x),r=r[aI](n.min.y,n.max.y),u=q[5],t=q[6]}}var m=al[aJ](0,s),l=al[aJ](0,r);return{x:m,y:l,width:an[aJ](0,s)-m,height:an[aJ](0,r)-l}},null,function(b){return{x:b.x,y:b.y,width:b.width,height:b.height}}),aQ=function(a){var l=[];if(!a2.is(a,cY)||!a2.is(a&&a[0],cY)){a=a2.parsePathString(a)}for(var k=0,j=a.length;k<j;k++){l[k]=[];for(var i=0,h=a[k].length;i<h;i++){l[k][i]=a[k][i]}}l.toString=a2._path2string;return l},aO=a2._pathToRelative=a1(function(F){if(!a2.is(F,cY)||!a2.is(F&&F[0],cY)){F=a2.parsePathString(F)}var E=[],D=0,C=0,B=0,A=0,z=0;F[0][0]=="M"&&(D=F[0][1],C=F[0][2],B=D,A=C,z++,E.push(["M",D,C]));for(var y=z,x=F.length;y<x;y++){var w=E[y]=[],v=F[y];if(v[0]!=ar.call(v[0])){w[0]=ar.call(v[0]);switch(w[0]){case"a":w[1]=v[1],w[2]=v[2],w[3]=v[3],w[4]=v[4],w[5]=v[5],w[6]=+(v[6]-D).toFixed(3),w[7]=+(v[7]-C).toFixed(3);break;case"v":w[1]=+(v[1]-C).toFixed(3);break;case"m":B=v[1],A=v[2];default:for(var u=1,t=v.length;u<t;u++){w[u]=+(v[u]-(u%2?D:C)).toFixed(3)}}}else{w=E[y]=[],v[0]=="m"&&(B=v[1]+D,A=v[2]+C);for(var s=0,r=v.length;s<r;s++){E[y][s]=v[s]}}var a=E[y].length;switch(E[y][0]){case"z":D=B,C=A;break;case"h":D+=+E[y][a-1];break;case"v":C+=+E[y][a-1];break;default:D+=+E[y][a-2],C+=+E[y][a-1]}}E.toString=a2._path2string;return E},0,aQ),dp=a2._pathToAbsolute=a1(function(F){if(!a2.is(F,cY)||!a2.is(F&&F[0],cY)){F=a2.parsePathString(F)}if(!F||!F.length){return[["M",0,0]]}var E=[],D=0,C=0,B=0,A=0,z=0;F[0][0]=="M"&&(D=+F[0][1],C=+F[0][2],B=D,A=C,z++,E[0]=["M",D,C]);for(var y,x,w=z,v=F.length;w<v;w++){E.push(y=[]),x=F[w];if(x[0]!=cB.call(x[0])){y[0]=cB.call(x[0]);switch(y[0]){case"A":y[1]=x[1],y[2]=x[2],y[3]=x[3],y[4]=x[4],y[5]=x[5],y[6]=+(x[6]+D),y[7]=+(x[7]+C);break;case"V":y[1]=+x[1]+C;break;case"H":y[1]=+x[1]+D;break;case"R":var u=[D,C][aI](x.slice(1));for(var t=2,s=u.length;t<s;t++){u[t]=+u[t]+D,u[++t]=+u[t]+C}E.pop(),E=E[aI](aV(u));break;case"M":B=+x[1]+D,A=+x[2]+C;default:for(t=1,s=x.length;t<s;t++){y[t]=+x[t]+(t%2?D:C)}}}else{if(x[0]=="R"){u=[D,C][aI](x.slice(1)),E.pop(),E=E[aI](aV(u)),y=["R"][aI](x.slice(-2))}else{for(var n=0,a=x.length;n<a;n++){y[n]=x[n]}}}switch(y[0]){case"Z":D=B,C=A;break;case"H":D=y[1];break;case"V":C=y[1];break;case"M":B=y[y.length-2],A=y[y.length-1];default:D=y[y.length-2],C=y[y.length-1]}}E.toString=a2._path2string;return E},null,aQ),dn=function(f,e,h,g){return[f,e,h,g,h,g]},dm=function(j,i,p,o,n,m){var l=1/3,k=2/3;return[l*j+k*p,l*i+k*o,l*n+k*p,l*m+k*o,n,m]},dl=function(bL,bK,bJ,bI,bH,bG,bF,bE,bD,bC){var bB=c4*120/180,bA=c4/180*(+bH||0),bz=[],by,bx=a1(function(g,f,j){var i=g*ap.cos(j)-f*ap.sin(j),h=g*ap.sin(j)+f*ap.cos(j);return{x:i,y:h}});if(!bC){by=bx(bL,bK,-bA),bL=by.x,bK=by.y,by=bx(bE,bD,-bA),bE=by.x,bD=by.y;var bw=ap.cos(c4/180*bH),bv=ap.sin(c4/180*bH),bu=(bL-bE)/2,bt=(bK-bD)/2,bs=bu*bu/(bJ*bJ)+bt*bt/(bI*bI);bs>1&&(bs=ap.sqrt(bs),bJ=bs*bJ,bI=bs*bI);var br=bJ*bJ,bq=bI*bI,bp=(bG==bF?-1:1)*ap.sqrt(aj((br*bq-br*bt*bt-bq*bu*bu)/(br*bt*bt+bq*bu*bu))),bo=bp*bJ*bt/bI+(bL+bE)/2,bn=bp*-bI*bu/bJ+(bK+bD)/2,bm=ap.asin(((bK-bn)/bI).toFixed(9)),bl=ap.asin(((bD-bn)/bI).toFixed(9));bm=bL<bo?c4-bm:bm,bl=bE<bo?c4-bl:bl,bm<0&&(bm=c4*2+bm),bl<0&&(bl=c4*2+bl),bF&&bm>bl&&(bm=bm-c4*2),!bF&&bl>bm&&(bl=bl-c4*2)}else{bm=bC[0],bl=bC[1],bo=bC[2],bn=bC[3]}var bk=bl-bm;if(aj(bk)>bB){var bj=bl,bi=bE,bh=bD;bl=bm+bB*(bF&&bl>bm?1:-1),bE=bo+bJ*ap.cos(bl),bD=bn+bI*ap.sin(bl),bz=dl(bE,bD,bJ,bI,bH,0,bF,bi,bh,[bl,bj,bo,bn])}bk=bl-bm;var bg=ap.cos(bm),bf=ap.sin(bm),be=ap.cos(bl),bd=ap.sin(bl),bc=ap.tan(bk/4),bb=4/3*bJ*bc,ba=4/3*bI*bc,Z=[bL,bK],Y=[bL+bb*bf,bK-ba*bg],B=[bE+bb*bd,bD-ba*be],z=[bE,bD];Y[0]=2*Z[0]-Y[0],Y[1]=2*Z[1]-Y[1];if(bC){return[Y,B,z][aI](bz)}bz=[Y,B,z][aI](bz).join()[ay](",");var w=[];for(var s=0,n=bz.length;s<n;s++){w[s]=s%2?bx(bz[s-1],bz[s],bA).y:bx(bz[s],bz[s+1],bA).x}return w},dk=function(t,s,r,q,p,o,n,m,l){var k=1-l;return{x:c6(k,3)*t+c6(k,2)*3*l*r+k*3*l*l*p+c6(l,3)*n,y:c6(k,3)*s+c6(k,2)*3*l*q+k*3*l*l*o+c6(l,3)*m}},dj=a1(function(F,E,D,C,B,A,z,y){var x=B-2*D+F-(z-2*B+D),w=2*(D-F)-2*(B-D),v=F-D,u=(-w+ap.sqrt(w*w-4*x*v))/2/x,t=(-w-ap.sqrt(w*w-4*x*v))/2/x,s=[E,y],r=[F,z],m;aj(u)>"1e12"&&(u=0.5),aj(t)>"1e12"&&(t=0.5),u>0&&u<1&&(m=dk(F,E,D,C,B,A,z,y,u),r.push(m.x),s.push(m.y)),t>0&&t<1&&(m=dk(F,E,D,C,B,A,z,y,t),r.push(m.x),s.push(m.y)),x=A-2*C+E-(y-2*A+C),w=2*(C-E)-2*(A-C),v=E-C,u=(-w+ap.sqrt(w*w-4*x*v))/2/x,t=(-w-ap.sqrt(w*w-4*x*v))/2/x,aj(u)>"1e12"&&(u=0.5),aj(t)>"1e12"&&(t=0.5),u>0&&u<1&&(m=dk(F,E,D,C,B,A,z,y,u),r.push(m.x),s.push(m.y)),t>0&&t<1&&(m=dk(F,E,D,C,B,A,z,y,t),r.push(m.x),s.push(m.y));return{min:{x:al[aJ](0,r),y:al[aJ](0,s)},max:{x:an[aJ](0,r),y:an[aJ](0,s)}}}),di=a2._path2curve=a1(function(D,C){var B=dp(D),A=C&&dp(C),z={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},y={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},x=function(f,e){var h,g;if(!f){return["C",e.x,e.y,e.x,e.y,e.x,e.y]}!(f[0] in {T:1,Q:1})&&(e.qx=e.qy=null);switch(f[0]){case"M":e.X=f[1],e.Y=f[2];break;case"A":f=["C"][aI](dl[aJ](0,[e.x,e.y][aI](f.slice(1))));break;case"S":h=e.x+(e.x-(e.bx||e.x)),g=e.y+(e.y-(e.by||e.y)),f=["C",h,g][aI](f.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),f=["C"][aI](dm(e.x,e.y,e.qx,e.qy,f[1],f[2]));break;case"Q":e.qx=f[1],e.qy=f[2],f=["C"][aI](dm(e.x,e.y,f[1],f[2],f[3],f[4]));break;case"L":f=["C"][aI](dn(e.x,e.y,f[1],f[2]));break;case"H":f=["C"][aI](dn(e.x,e.y,f[1],e.y));break;case"V":f=["C"][aI](dn(e.x,e.y,e.x,f[1]));break;case"Z":f=["C"][aI](dn(e.x,e.y,e.X,e.Y))}return f},w=function(f,d){if(f[d].length>7){f[d].shift();var g=f[d];while(g.length){f.splice(d++,0,["C"][aI](g.splice(0,6)))}f.splice(d,1),t=an(B.length,A&&A.length||0)}},v=function(h,d,k,j,i){h&&d&&h[i][0]=="M"&&d[i][0]!="M"&&(d.splice(i,0,["M",j.x,j.y]),k.bx=0,k.by=0,k.x=h[i][1],k.y=h[i][2],t=an(B.length,A&&A.length||0))};for(var u=0,t=an(B.length,A&&A.length||0);u<t;u++){B[u]=x(B[u],z),w(B,u),A&&(A[u]=x(A[u],y)),A&&w(A,u),v(B,A,z,y,u),v(A,B,y,z,u);var s=B[u],r=A&&A[u],n=s.length,m=A&&r.length;z.x=s[n-2],z.y=s[n-1],z.bx=cF(s[n-4])||z.x,z.by=cF(s[n-3])||z.y,y.bx=A&&(cF(r[m-4])||y.x),y.by=A&&(cF(r[m-3])||y.y),y.x=A&&r[m-2],y.y=A&&r[m-1]}return A?[B,A]:B},null,aQ),dh=a2._parseDots=a1(function(t){var s=[];for(var r=0,q=t.length;r<q;r++){var p={},o=t[r].match(/^([^:]*):?([\d\.]*)/);p.color=a2.getRGB(o[1]);if(p.color.error){return null}p.color=p.color.hex,o[2]&&(p.offset=o[2]+"%"),s.push(p)}for(r=1,q=s.length-1;r<q;r++){if(!s[r].offset){var n=cF(s[r-1].offset||0),m=0;for(var l=r+1;l<q;l++){if(s[l].offset){m=s[l].offset;break}}m||(m=100,l=q),m=cF(m);var a=(m-n)/(l-r+1);for(;r<l;r++){n+=a,s[r].offset=n+"%"}}}return s}),dg=a2._tear=function(e,d){e==d.top&&(d.top=e.prev),e==d.bottom&&(d.bottom=e.next),e.next&&(e.next.prev=e.prev),e.prev&&(e.prev.next=e.next)},df=a2._tofront=function(e,d){d.top!==e&&(dg(e,d),e.next=null,e.prev=d.top,d.top.next=e,d.top=e)},de=a2._toback=function(e,d){d.bottom!==e&&(dg(e,d),e.next=d.bottom,e.prev=null,d.bottom.prev=e,d.bottom=e)},dd=a2._insertafter=function(e,d,f){dg(e,f),d==f.top&&(f.top=e),d.next&&(d.next.prev=e),e.next=d.next,e.prev=d,d.next=e},dc=a2._insertbefore=function(e,d,f){dg(e,f),d==f.bottom&&(f.bottom=e),d.prev&&(d.prev.next=e),e.prev=d.prev,d.prev=e,e.next=d},db=a2._extractTransform=function(R,Q){if(Q==null){return R._.transform}Q=aA(Q).replace(/\.{3}|\u2026/g,R._.transform||aD);var P=a2.parseTransformString(Q),O=0,N=0,M=0,L=1,K=1,J=R._,I=new c8;J.transform=P||[];if(P){for(var H=0,G=P.length;H<G;H++){var F=P[H],E=F.length,D=aA(F[0]).toLowerCase(),C=F[0]!=D,B=C?I.invert():0,A,z,r,p,a;D=="t"&&E==3?C?(A=B.x(0,0),z=B.y(0,0),r=B.x(F[1],F[2]),p=B.y(F[1],F[2]),I.translate(r-A,p-z)):I.translate(F[1],F[2]):D=="r"?E==2?(a=a||R.getBBox(1),I.rotate(F[1],a.x+a.width/2,a.y+a.height/2),O+=F[1]):E==4&&(C?(r=B.x(F[2],F[3]),p=B.y(F[2],F[3]),I.rotate(F[1],r,p)):I.rotate(F[1],F[2],F[3]),O+=F[1]):D=="s"?E==2||E==3?(a=a||R.getBBox(1),I.scale(F[1],F[E-1],a.x+a.width/2,a.y+a.height/2),L*=F[1],K*=F[E-1]):E==5&&(C?(r=B.x(F[3],F[4]),p=B.y(F[3],F[4]),I.scale(F[1],F[2],r,p)):I.scale(F[1],F[2],F[3],F[4]),L*=F[1],K*=F[2]):D=="m"&&E==7&&I.add(F[1],F[2],F[3],F[4],F[5],F[6]),J.dirtyT=1,R.matrix=I}}R.matrix=I,J.sx=L,J.sy=K,J.deg=O,J.dx=N=I.e,J.dy=M=I.f,L==1&&K==1&&!O&&J.bbox?(J.bbox.x+=+N,J.bbox.y+=+M):J.dirtyT=1},da=function(e){var d=e[0];switch(d.toLowerCase()){case"t":return[d,0,0];case"m":return[d,1,0,0,1,0,0];case"r":return e.length==4?[d,0,e[2],e[3]]:[d,0];case"s":return e.length==5?[d,1,1,e[3],e[4]]:e.length==3?[d,1,1]:[d,1]}},c9=a2._equaliseTransform=function(t,s){s=aA(s).replace(/\.{3}|\u2026/g,t),t=a2.parseTransformString(t)||[],s=a2.parseTransformString(s)||[];var r=an(t.length,s.length),q=[],p=[],o=0,n,m,l,a;for(;o<r;o++){l=t[o]||da(s[o]),a=s[o]||da(l);if(l[0]!=a[0]||l[0].toLowerCase()=="r"&&(l[2]!=a[2]||l[3]!=a[3])||l[0].toLowerCase()=="s"&&(l[3]!=a[3]||l[4]!=a[4])){return}q[o]=[],p[o]=[];for(n=0,m=an(l.length,a.length);n<m;n++){n in l&&(q[o][n]=l[n]),n in a&&(p[o][n]=a[n])}}return{from:q,to:p}};a2._getContainer=function(a,j,i,h){var g;g=h==null&&!a2.is(a,"object")?aP.doc.getElementById(a):a;if(g!=null){if(g.tagName){return j==null?{container:g,width:g.style.pixelWidth||g.offsetWidth,height:g.style.pixelHeight||g.offsetHeight}:{container:g,width:j,height:i}}return{container:1,x:a,y:j,width:i,height:h}}},a2.pathToRelative=aO,a2._engine={},a2.path2curve=di,a2.matrix=function(h,g,l,k,j,i){return new c8(h,g,l,k,j,i)},function(a){function e(g){var d=ap.sqrt(f(g));g[0]&&(g[0]/=d),g[1]&&(g[1]/=d)}function f(b){return b[0]*b[0]+b[1]*b[1]}a.add=function(z,y,x,w,v,u){var t=[[],[],[]],s=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],r=[[z,x,v],[y,w,u],[0,0,1]],q,p,o,n;z&&z instanceof c8&&(r=[[z.a,z.c,z.e],[z.b,z.d,z.f],[0,0,1]]);for(q=0;q<3;q++){for(p=0;p<3;p++){n=0;for(o=0;o<3;o++){n+=s[q][o]*r[o][p]}t[q][p]=n}}this.a=t[0][0],this.b=t[1][0],this.c=t[0][1],this.d=t[1][1],this.e=t[0][2],this.f=t[1][2]},a.invert=function(){var g=this,d=g.a*g.d-g.b*g.c;return new c8(g.d/d,-g.b/d,-g.c/d,g.a/d,(g.c*g.f-g.d*g.e)/d,(g.b*g.e-g.a*g.f)/d)},a.clone=function(){return new c8(this.a,this.b,this.c,this.d,this.e,this.f)},a.translate=function(g,d){this.add(1,0,0,1,g,d)},a.scale=function(h,g,j,i){g==null&&(g=h),(j||i)&&this.add(1,0,0,1,j,i),this.add(h,0,0,g,0,0),(j||i)&&this.add(1,0,0,1,-j,-i)},a.rotate=function(g,k,j){g=a2.rad(g),k=k||0,j=j||0;var i=+ap.cos(g).toFixed(9),h=+ap.sin(g).toFixed(9);this.add(i,h,-h,i,k,j),this.add(1,0,0,1,-k,-j)},a.x=function(g,d){return g*this.a+d*this.c+this.e},a.y=function(g,d){return g*this.b+d*this.d+this.f},a.get=function(b){return +this[aA.fromCharCode(97+b)].toFixed(4)},a.toString=function(){return a2.svg?"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")":[this.get(0),this.get(2),this.get(1),this.get(3),0,0].join()},a.toFilter=function(){return"progid:DXImageTransform.Microsoft.Matrix(M11="+this.get(0)+", M12="+this.get(2)+", M21="+this.get(1)+", M22="+this.get(3)+", Dx="+this.get(4)+", Dy="+this.get(5)+", sizingmethod='auto expand')"},a.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},a.split=function(){var d={};d.dx=this.e,d.dy=this.f;var j=[[this.a,this.c],[this.b,this.d]];d.scalex=ap.sqrt(f(j[0])),e(j[0]),d.shear=j[0][0]*j[1][0]+j[0][1]*j[1][1],j[1]=[j[1][0]-j[0][0]*d.shear,j[1][1]-j[0][1]*d.shear],d.scaley=ap.sqrt(f(j[1])),e(j[1]),d.shear/=d.scaley;var i=-j[0][1],h=j[1][1];h<0?(d.rotate=a2.deg(ap.acos(h)),i<0&&(d.rotate=360-d.rotate)):d.rotate=a2.deg(ap.asin(i)),d.isSimple=!+d.shear.toFixed(9)&&(d.scalex.toFixed(9)==d.scaley.toFixed(9)||!d.rotate),d.isSuperSimple=!+d.shear.toFixed(9)&&d.scalex.toFixed(9)==d.scaley.toFixed(9)&&!d.rotate,d.noRotation=!+d.shear.toFixed(9)&&!d.rotate;return d},a.toTransformString=function(g){var d=g||this[ay]();if(d.isSimple){d.scalex=+d.scalex.toFixed(4),d.scaley=+d.scaley.toFixed(4),d.rotate=+d.rotate.toFixed(4);return(d.dx&&d.dy?"t"+[d.dx,d.dy]:aD)+(d.scalex!=1||d.scaley!=1?"s"+[d.scalex,d.scaley,0,0]:aD)+(d.rotate?"r"+[d.rotate,0,0]:aD)}return"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]}}(c8.prototype);var c7=navigator.userAgent.match(/Version\/(.*?)\s/)||navigator.userAgent.match(/Chrome\/(\d+)/);navigator.vendor=="Apple Computer, Inc."&&(c7&&c7[1]<4||navigator.platform.slice(0,2)=="iP")||navigator.vendor=="Google Inc."&&c7&&c7[1]<8?aL.safari=function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});setTimeout(function(){b.remove()})}:aL.safari=cC;var c5=function(){this.returnValue=!1},c3=function(){return this.originalEvent.preventDefault()},c1=function(){this.cancelBubble=!0},cZ=function(){return this.originalEvent.stopPropagation()},cX=function(){if(aP.doc.addEventListener){return function(h,g,l,k){var j=aG&&au[g]?au[g]:g,i=function(r){var q=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,p=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,o=r.clientX+p,d=r.clientY+q;if(aG&&au[aR](g)){for(var b=0,a=r.targetTouches&&r.targetTouches.length;b<a;b++){if(r.targetTouches[b].target==h){var s=r;r=r.targetTouches[b],r.originalEvent=s,r.preventDefault=c3,r.stopPropagation=cZ;break}}}return l.call(k,r,o,d)};h.addEventListener(j,i,!1);return function(){h.removeEventListener(j,i,!1);return !0}}}if(aP.doc.attachEvent){return function(h,g,l,k){var j=function(m){m=m||aP.win.event;var d=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,p=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,o=m.clientX+p,n=m.clientY+d;m.preventDefault=m.preventDefault||c5,m.stopPropagation=m.stopPropagation||c1;return l.call(k,m,o,n)};h.attachEvent("on"+g,j);var i=function(){h.detachEvent("on"+g,j);return !0};return i}}}(),cV=[],cT=function(B){var A=B.clientX,z=B.clientY,y=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,x=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft,w,v=cV.length;while(v--){w=cV[v];if(aG){var u=B.touches.length,t;while(u--){t=B.touches[u];if(t.identifier==w.el._drag.id){A=t.clientX,z=t.clientY,(B.originalEvent?B.originalEvent:B).preventDefault();break}}}else{B.preventDefault()}var s=w.el.node,r,q=s.nextSibling,o=s.parentNode,h=s.style.display;aP.win.opera&&o.removeChild(s),s.style.display="none",r=w.el.paper.getElementByPoint(A,z),s.style.display=h,aP.win.opera&&(q?o.insertBefore(s,q):o.appendChild(s)),r&&eve("drag.over."+w.el.id,w.el,r),A+=x,z+=y,eve("drag.move."+w.el.id,w.move_scope||w.el,A-w.el._drag.x,z-w.el._drag.y,A,z,B)}},cR=function(a){a2.unmousemove(cT).unmouseup(cR);var f=cV.length,e;while(f--){e=cV[f],e.el._drag={},eve("drag.end."+e.el.id,e.end_scope||e.start_scope||e.move_scope||e.el,a)}cV=[]},dr=a2.el={};for(var cL=aw.length;cL--;){(function(a){a2[a]=dr[a]=function(e,b){a2.is(e,"function")&&(this.events=this.events||[],this.events.push({name:a,f:e,unbind:cX(this.shape||this.node||aP.doc,a,e,b||this)}));return this},a2["un"+a]=dr["un"+a]=function(b){var f=this.events,e=f.length;while(e--){if(f[e].name==a&&f[e].f==b){f[e].unbind(),f.splice(e,1),!f.length&&delete this.events;return this}}return this}})(aw[cL])}dr.data=function(a,h){var g=cI[this.id]=cI[this.id]||{};if(arguments.length==1){if(a2.is(a,"object")){for(var f in a){a[aR](f)&&this.data(f,a[f])}return this}eve("data.get."+this.id,this,g[a],a);return g[a]}g[a]=h,eve("data.set."+this.id,this,h,a);return this},dr.removeData=function(b){b==null?cI[this.id]={}:cI[this.id]&&delete cI[this.id][b];return this},dr.hover=function(f,e,h,g){return this.mouseover(f,h).mouseout(e,g||h)},dr.unhover=function(e,d){return this.unmouseover(e).unmouseout(d)};var aH=[];dr.drag=function(a,n,m,l,k,j){function h(e){(e.originalEvent||e).preventDefault();var d=aP.doc.documentElement.scrollTop||aP.doc.body.scrollTop,b=aP.doc.documentElement.scrollLeft||aP.doc.body.scrollLeft;this._drag.x=e.clientX+b,this._drag.y=e.clientY+d,this._drag.id=e.identifier,!cV.length&&a2.mousemove(cT).mouseup(cR),cV.push({el:this,move_scope:l,start_scope:k,end_scope:j}),n&&eve.on("drag.start."+this.id,n),a&&eve.on("drag.move."+this.id,a),m&&eve.on("drag.end."+this.id,m),eve("drag.start."+this.id,k||l||this,e.clientX+b,e.clientY+d,e)}this._drag={},aH.push({el:this,start:h}),this.mousedown(h);return this},dr.onDragOver=function(b){b?eve.on("drag.over."+this.id,b):eve.unbind("drag.over."+this.id)},dr.undrag=function(){var a=aH.length;while(a--){aH[a].el==this&&(this.unmousedown(aH[a].start),aH.splice(a,1),eve.unbind("drag.*."+this.id))}!aH.length&&a2.unmousemove(cT).unmouseup(cR)},aL.circle=function(a,h,g){var f=a2._engine.circle(this,a||0,h||0,g||0);this.__set__&&this.__set__.push(f);return f},aL.rect=function(a,l,k,j,i){var h=a2._engine.rect(this,a||0,l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aL.ellipse=function(a,j,i,h){var g=a2._engine.ellipse(this,a||0,j||0,i||0,h||0);this.__set__&&this.__set__.push(g);return g},aL.path=function(a){a&&!a2.is(a,c0)&&!a2.is(a[0],cY)&&(a+=aD);var d=a2._engine.path(a2.format[aJ](a2,arguments),this);this.__set__&&this.__set__.push(d);return d},aL.image=function(a,l,k,j,i){var h=a2._engine.image(this,a||"about:blank",l||0,k||0,j||0,i||0);this.__set__&&this.__set__.push(h);return h},aL.text=function(a,h,g){var f=a2._engine.text(this,a||0,h||0,aA(g));this.__set__&&this.__set__.push(f);return f},aL.set=function(a){!a2.is(a,"array")&&(a=Array.prototype.splice.call(arguments,0,arguments.length));var d=new ac(a);this.__set__&&this.__set__.push(d);return d},aL.setStart=function(b){this.__set__=b||this.set()},aL.setFinish=function(e){var d=this.__set__;delete this.__set__;return d},aL.setSize=function(a,d){return a2._engine.setSize.call(this,a,d)},aL.setViewBox=function(a,j,i,h,g){return a2._engine.setViewBox.call(this,a,j,i,h,g)},aL.top=aL.bottom=null,aL.raphael=a2;var aF=function(r){var q=r.getBoundingClientRect(),p=r.ownerDocument,o=p.body,n=p.documentElement,m=n.clientTop||o.clientTop||0,l=n.clientLeft||o.clientLeft||0,k=q.top+(aP.win.pageYOffset||n.scrollTop||o.scrollTop)-m,h=q.left+(aP.win.pageXOffset||n.scrollLeft||o.scrollLeft)-l;return{y:k,x:h}};aL.getElementByPoint=function(j,h){var p=this,o=p.canvas,n=aP.doc.elementFromPoint(j,h);if(aP.win.opera&&n.tagName=="svg"){var m=aF(o),l=o.createSVGRect();l.x=j-m.x,l.y=h-m.y,l.width=l.height=1;var k=o.getIntersectionList(l,null);k.length&&(n=k[k.length-1])}if(!n){return null}while(n.parentNode&&n!=o.parentNode&&!n.raphael){n=n.parentNode}n==p.canvas.parentNode&&(n=o),n=n&&n.raphael?p.getById(n.raphaelid):null;return n},aL.getById=function(e){var d=this.bottom;while(d){if(d.id==e){return d}d=d.next}return null},aL.forEach=function(e,d){var f=this.bottom;while(f){if(e.call(d,f)===!1){return this}f=f.next}return this},dr.getBBox=function(e){if(this.removed){return{}}var d=this._;if(e){if(d.dirty||!d.bboxwt){this.realPath=b9[this.type](this),d.bboxwt=aS(this.realPath),d.bboxwt.toString=aC,d.dirty=0}return d.bboxwt}if(d.dirty||d.dirtyT||!d.bbox){if(d.dirty||!this.realPath){d.bboxwt=0,this.realPath=b9[this.type](this)}d.bbox=aS(b7(this.realPath,this.matrix)),d.bbox.toString=aC,d.dirty=d.dirtyT=0}return d.bbox},dr.clone=function(){if(this.removed){return null}var b=this.paper[this.type]().attr(this.attr());this.__set__&&this.__set__.push(b);return b},dr.glow=function(i){if(this.type=="text"){return null}i=i||{};var h={width:(i.width||10)+(+this.attr("stroke-width")||1),fill:i.fill||!1,opacity:i.opacity||0.5,offsetx:i.offsetx||0,offsety:i.offsety||0,color:i.color||"#000"},n=h.width/2,m=this.paper,l=m.set(),k=this.realPath||b9[this.type](this);k=this.matrix?b7(k,this.matrix):k;for(var j=1;j<n+1;j++){l.push(m.path(k).attr({stroke:h.color,fill:h.fill?h.color:"none","stroke-linejoin":"round","stroke-linecap":"round","stroke-width":+(h.width/n*j).toFixed(3),opacity:+(h.opacity/n).toFixed(3)}))}return l.insertBefore(this).translate(h.offsetx,h.offsety)};var az={},ax=function(H,G,F,E,D,C,B,A,z){var y=0,x=100,w=[H,G,F,E,D,C,B,A].join(),v=az[w],u,t;!v&&(az[w]=v={data:[]}),v.timer&&clearTimeout(v.timer),v.timer=setTimeout(function(){delete az[w]},2000);if(z!=null&&!v.precision){var s=ax(H,G,F,E,D,C,B,A);v.precision=~~s*10,v.data=[]}x=v.precision||x;for(var a=0;a<x+1;a++){v.data[a*x]?t=v.data[a*x]:(t=a2.findDotsAtSegment(H,G,F,E,D,C,B,A,a/x),v.data[a*x]=t),a&&(y+=c6(c6(u.x-t.x,2)+c6(u.y-t.y,2),0.5));if(z!=null&&y>=z){return t}u=t}if(z==null){return y}},av=function(a,d){return function(B,A,z){B=di(B);var y,x,w,v,u="",t={},s,r=0;for(var q=0,b=B.length;q<b;q++){w=B[q];if(w[0]=="M"){y=+w[1],x=+w[2]}else{v=ax(y,x,w[1],w[2],w[3],w[4],w[5],w[6]);if(r+v>A){if(d&&!t.start){s=ax(y,x,w[1],w[2],w[3],w[4],w[5],w[6],A-r),u+=["C"+s.start.x,s.start.y,s.m.x,s.m.y,s.x,s.y];if(z){return u}t.start=u,u=["M"+s.x,s.y+"C"+s.n.x,s.n.y,s.end.x,s.end.y,w[5],w[6]].join(),r+=v,y=+w[5],x=+w[6];continue}if(!a&&!d){s=ax(y,x,w[1],w[2],w[3],w[4],w[5],w[6],A-r);return{x:s.x,y:s.y,alpha:s.alpha}}}r+=v,y=+w[5],x=+w[6]}u+=w.shift()+w}t.end=u,s=a?r:d?t:a2.findDotsAtSegment(y,x,w[0],w[1],w[2],w[3],w[4],w[5],1),s.alpha&&(s={x:s.x,y:s.y,alpha:s.alpha});return s}},at=av(1),aq=av(),ao=av(0,1);a2.getTotalLength=at,a2.getPointAtLength=aq,a2.getSubpath=function(f,e,h){if(this.getTotalLength(f)-h<0.000001){return ao(f,e).end}var g=ao(f,h,1);return e?ao(g,e).end:g},dr.getTotalLength=function(){if(this.type=="path"){if(this.node.getTotalLength){return this.node.getTotalLength()}return at(this.attrs.path)}},dr.getPointAtLength=function(b){if(this.type=="path"){return aq(this.attrs.path,b)}},dr.getSubpath=function(a,d){if(this.type=="path"){return a2.getSubpath(this.attrs.path,a,d)}};var am=a2.easing_formulas={linear:function(b){return b},"<":function(b){return c6(b,1.7)},">":function(b){return c6(b,0.48)},"<>":function(j){var i=0.48-j/1.04,p=ap.sqrt(0.1734+i*i),o=p-i,n=c6(aj(o),1/3)*(o<0?-1:1),m=-p-i,l=c6(aj(m),1/3)*(m<0?-1:1),k=n+l+0.5;return(1-k)*3*k*k+k*k*k},backIn:function(e){var d=1.70158;return e*e*((d+1)*e-d)},backOut:function(e){e=e-1;var d=1.70158;return e*e*((d+1)*e+d)+1},elastic:function(b){if(b==!!b){return b}return c6(2,-10*b)*ap.sin((b-0.075)*2*c4/0.3)+1},bounce:function(f){var e=7.5625,h=2.75,g;f<1/h?g=e*f*f:f<2/h?(f-=1.5/h,g=e*f*f+0.75):f<2.5/h?(f-=2.25/h,g=e*f*f+0.9375):(f-=2.625/h,g=e*f*f+0.984375);return g}};am.easeIn=am["ease-in"]=am["<"],am.easeOut=am["ease-out"]=am[">"],am.easeInOut=am["ease-in-out"]=am["<>"],am["back-in"]=am.backIn,am["back-out"]=am.backOut;var ak=[],ai=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,16)},ah=function(){var T=+(new Date),S=0;for(;S<ak.length;S++){var R=ak[S];if(R.el.removed||R.paused){continue}var Q=T-R.start,P=R.ms,O=R.easing,N=R.from,M=R.diff,L=R.to,K=R.t,J=R.el,I={},H,F={},E;R.initstatus?(Q=(R.initstatus*R.anim.top-R.prev)/(R.percent-R.prev)*P,R.status=R.initstatus,delete R.initstatus,R.stop&&ak.splice(S--,1)):R.status=(R.prev+(R.percent-R.prev)*(Q/P))/R.anim.top;if(Q<0){continue}if(Q<P){var D=O(Q/P);for(var C in N){if(N[aR](C)){switch(cx[C]){case c2:H=+N[C]+D*P*M[C];break;case"colour":H="rgb("+[ag(cJ(N[C].r+D*P*M[C].r)),ag(cJ(N[C].g+D*P*M[C].g)),ag(cJ(N[C].b+D*P*M[C].b))].join(",")+")";break;case"path":H=[];for(var B=0,q=N[C].length;B<q;B++){H[B]=[N[C][B][0]];for(var n=1,g=N[C][B].length;n<g;n++){H[B][n]=+N[C][B][n]+D*P*M[C][B][n]}H[B]=H[B].join(aB)}H=H.join(aB);break;case"transform":if(M[C].real){H=[];for(B=0,q=N[C].length;B<q;B++){H[B]=[N[C][B][0]];for(n=1,g=N[C][B].length;n<g;n++){H[B][n]=N[C][B][n]+D*P*M[C][B][n]}}}else{var a=function(b){return +N[C][b]+D*P*M[C][b]};H=[["m",a(0),a(1),a(2),a(3),a(4),a(5)]]}break;case"csv":if(C=="clip-rect"){H=[],B=4;while(B--){H[B]=+N[C][B]+D*P*M[C][B]}}break;default:var G=[][aI](N[C]);H=[],B=J.paper.customAttributes[C].length;while(B--){H[B]=+G[B]+D*P*M[C][B]}}I[C]=H}}J.attr(I),function(e,d,f){setTimeout(function(){eve("anim.frame."+e,d,f)})}(J.id,J,R.anim)}else{(function(e,h,f){setTimeout(function(){eve("anim.frame."+h.id,h,f),eve("anim.finish."+h.id,h,f),a2.is(e,"function")&&e.call(h)})})(R.callback,J,R.anim),J.attr(L),ak.splice(S--,1);if(R.repeat>1&&!R.next){for(E in L){L[aR](E)&&(F[E]=R.totalOrigin[E])}R.el.attr(F),ad(R.anim,R.el,R.anim.percents[0],null,R.totalOrigin,R.repeat-1)}R.next&&!R.stop&&ad(R.anim,R.el,R.next,null,R.totalOrigin,R.repeat)}}a2.svg&&J&&J.paper&&J.paper.safari(),ak.length&&ai(ah)},ag=function(b){return b>255?255:b<0?0:b};dr.animateWith=function(a,p,o,n,m,l){var k=o?a2.animation(o,n,m,l):p,j=a.status(p);return this.animate(k).status(k,j*p.ms/k.ms)},dr.onAnimation=function(b){b?eve.on("anim.frame."+this.id,b):eve.unbind("anim.frame."+this.id);return this},ae.prototype.delay=function(e){var d=new ae(this.anim,this.ms);d.times=this.times,d.del=+e||0;return d},ae.prototype.repeat=function(e){var d=new ae(this.anim,this.ms);d.del=this.del,d.times=ap.floor(an(e,0))||1;return d},a2.animation=function(a,n,m,l){if(a instanceof ae){return a}if(a2.is(m,"function")||!m){l=l||m||null,m=null}a=Object(a),n=+n||0;var k={},j,g;for(g in a){a[aR](g)&&cF(g)!=g&&cF(g)+"%"!=g&&(j=!0,k[g]=a[g])}if(!j){return new ae(a,n)}m&&(k.easing=m),l&&(k.callback=l);return new ae({100:k},n)},dr.animate=function(a,l,k,j){var i=this;if(i.removed){j&&j.call(i);return i}var h=a instanceof ae?a:a2.animation(a,l,k,j);ad(h,i,h.percents[0],null,i.attr());return i},dr.setTime=function(e,d){e&&d!=null&&this.status(e,al(d,e.ms)/e.ms);return this},dr.status=function(h,g){var l=[],k=0,j,i;if(g!=null){ad(h,this,-1,al(g,1));return this}j=ak.length;for(;k<j;k++){i=ak[k];if(i.el.id==this.id&&(!h||i.anim==h)){if(h){return i.status}l.push({anim:i.anim,status:i.status})}}if(h){return 0}return l},dr.pause=function(e){for(var d=0;d<ak.length;d++){ak[d].el.id==this.id&&(!e||ak[d].anim==e)&&eve("anim.pause."+this.id,this,ak[d].anim)!==!1&&(ak[d].paused=!0)}return this},dr.resume=function(e){for(var d=0;d<ak.length;d++){if(ak[d].el.id==this.id&&(!e||ak[d].anim==e)){var f=ak[d];eve("anim.resume."+this.id,this,f.anim)!==!1&&(delete f.paused,this.status(f.anim,f.status))}}return this},dr.stop=function(e){for(var d=0;d<ak.length;d++){ak[d].el.id==this.id&&(!e||ak[d].anim==e)&&eve("anim.stop."+this.id,this,ak[d].anim)!==!1&&ak.splice(d--,1)}return this},dr.toString=function(){return"Raphaël’s object"};var ac=function(e){this.items=[],this.length=0,this.type="set";if(e){for(var d=0,f=e.length;d<f;d++){e[d]&&(e[d].constructor==dr.constructor||e[d].constructor==ac)&&(this[this.items.length]=this.items[this.items.length]=e[d],this.length++)}}},ab=ac.prototype;ab.push=function(){var f,e;for(var h=0,g=arguments.length;h<g;h++){f=arguments[h],f&&(f.constructor==dr.constructor||f.constructor==ac)&&(e=this.items.length,this[e]=this.items[e]=f,this.length++)}return this},ab.pop=function(){this.length&&delete this[this.length--];return this.items.pop()},ab.forEach=function(f,e){for(var h=0,g=this.items.length;h<g;h++){if(f.call(e,this.items[h],h)===!1){return this}}return this};for(var aa in dr){dr[aR](aa)&&(ab[aa]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b][aJ](d,a)})}}(aa))}ab.attr=function(a,l){if(a&&a2.is(a,cY)&&a2.is(a[0],"object")){for(var k=0,j=a.length;k<j;k++){this.items[k].attr(a[k])}}else{for(var i=0,h=this.items.length;i<h;i++){this.items[i].attr(a,l)}}return this},ab.clear=function(){while(this.length){this.pop()}},ab.splice=function(j,i,p){j=j<0?an(this.length+j,0):j,i=an(0,al(this.length-j,i));var o=[],n=[],m=[],l;for(l=2;l<arguments.length;l++){m.push(arguments[l])}for(l=0;l<i;l++){n.push(this[j+l])}for(;l<this.length-j;l++){o.push(this[j+l])}var k=m.length;for(l=0;l<k+o.length;l++){this.items[j+l]=this[j+l]=l<k?m[l]:o[l-k]}l=this.items.length=this.length-=i-k;while(this[l]){delete this[l++]}return new ac(n)},ab.exclude=function(e){for(var d=0,f=this.length;d<f;d++){if(this[d]==e){this.splice(d,1);return !0}}},ab.animate=function(t,s,r,q){(a2.is(r,"function")||!r)&&(q=r||null);var p=this.items.length,o=p,n,m=this,l;if(!p){return this}q&&(l=function(){!--p&&q.call(m)}),r=a2.is(r,c0)?r:l;var a=a2.animation(t,s,r,l);n=this.items[--o].animate(a);while(o--){this.items[o]&&!this.items[o].removed&&this.items[o].animateWith(n,a)}return this},ab.insertAfter=function(e){var d=this.items.length;while(d--){this.items[d].insertAfter(e)}return this},ab.getBBox=function(){var h=[],g=[],l=[],k=[];for(var j=this.items.length;j--;){if(!this.items[j].removed){var i=this.items[j].getBBox();h.push(i.x),g.push(i.y),l.push(i.x+i.width),k.push(i.y+i.height)}}h=al[aJ](0,h),g=al[aJ](0,g);return{x:h,y:g,width:an[aJ](0,l)-h,height:an[aJ](0,k)-g}},ab.clone=function(e){e=new ac;for(var d=0,f=this.items.length;d<f;d++){e.push(this.items[d].clone())}return e},ab.toString=function(){return"Raphaël‘s set"},a2.registerFont=function(i){if(!i.face){return i}this.fonts=this.fonts||{};var g={w:i.w,face:{},glyphs:{}},n=i.face["font-family"];for(var m in i.face){i.face[aR](m)&&(g.face[m]=i.face[m])}this.fonts[n]?this.fonts[n].push(g):this.fonts[n]=[g];if(!i.svg){g.face["units-per-em"]=cD(i.face["units-per-em"],10);for(var l in i.glyphs){if(i.glyphs[aR](l)){var k=i.glyphs[l];g.glyphs[l]={w:k.w,k:{},d:k.d&&"M"+k.d.replace(/[mlcxtrv]/g,function(b){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[b]||"M"})+"z"};if(k.k){for(var j in k.k){k[aR](j)&&(g.glyphs[l].k[j]=k.k[j])}}}}}return i},aL.getFont=function(t,s,r,q){q=q||"normal",r=r||"normal",s=+s||{normal:400,bold:700,lighter:300,bolder:800}[s]||400;if(!!a2.fonts){var p=a2.fonts[t];if(!p){var o=new RegExp("(^|\\s)"+t.replace(/[^\w\d\s+!~.:_-]/g,aD)+"(\\s|$)","i");for(var n in a2.fonts){if(a2.fonts[aR](n)&&o.test(n)){p=a2.fonts[n];break}}}var m;if(p){for(var g=0,a=p.length;g<a;g++){m=p[g];if(m.face["font-weight"]==s&&(m.face["font-style"]==r||!m.face["font-style"])&&m.face["font-stretch"]==q){break}}}return m}},aL.print=function(M,L,K,J,I,H,G){H=H||"middle",G=an(al(G||0,1),-1);var F=this.set(),E=aA(K)[ay](aD),D=0,C=aD,B;a2.is(J,K)&&(J=this.getFont(J));if(J){B=(I||16)/J.face["units-per-em"];var A=J.face.bbox[ay](aZ),y=+A[0],x=+A[1]+(H=="baseline"?A[3]-A[1]+ +J.face.descent:(A[3]-A[1])/2);for(var s=0,r=E.length;s<r;s++){var p=s&&J.glyphs[E[s-1]]||{},a=J.glyphs[E[s]];D+=s?(p.w||J.w)+(p.k&&p.k[E[s]]||0)+J.w*G:0,a&&a.d&&F.push(this.path(a.d).attr({fill:"#000",stroke:"none",transform:[["t",D*B,0]]}))}F.transform(["...s",B,B,y,x,"t",(M-y)/B,(L-x)/B])}return F},aL.add=function(a){if(a2.is(a,"array")){var j=this.set(),i=0,g=a.length,d;for(;i<g;i++){d=a[i]||{},aW[aR](d.type)&&j.push(this[d.type]().attr(d))}}return j},a2.format=function(a,f){var e=a2.is(f,cY)?[0][aI](f):arguments;a&&a2.is(a,c0)&&e.length-1&&(a=a.replace(aU,function(g,d){return e[++d]==null?aD:e[d]}));return a||aD},a2.fullfill=function(){var e=/\{([^\}]+)\}/g,d=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,f=function(b,i,h){var g=h;i.replace(d,function(k,j,n,m,l){j=j||m,g&&(j in g&&(g=g[j]),typeof g=="function"&&l&&(g=g()))}),g=(g==null||g==h?b:g)+"";return g};return function(a,g){return String(a).replace(e,function(i,h){return f(i,h,g)})}}(),a2.ninja=function(){aN.was?aP.win.Raphael=aN.is:delete Raphael;return a2},a2.st=ab,function(a,h,g){function f(){/in/.test(a.readyState)?setTimeout(f,9):a2.eve("DOMload")}a.readyState==null&&a.addEventListener&&(a.addEventListener(h,g=function(){a.removeEventListener(h,g,!1),a.readyState="complete"},!1),a.readyState="loading"),f()}(document,"DOMContentLoaded"),aN.was?aP.win.Raphael=a2:Raphael=a2,eve.on("DOMload",function(){a0=!0})}(),window.Raphael.svg&&function(af){var ae="hasOwnProperty",ad=String,ac=parseFloat,ab=parseInt,aa=Math,Z=aa.max,Y=aa.abs,X=aa.pow,W=/[, ]+/,V=af.eve,U="",T=" ",S="http://www.w3.org/1999/xlink",R={block:"M5,0 0,2.5 5,5z",classic:"M5,0 0,2.5 5,5 3.5,3 3.5,2z",diamond:"M2.5,0 5,2.5 2.5,5 0,2.5z",open:"M6,1 1,3.5 6,6",oval:"M2.5,0A2.5,2.5,0,0,1,2.5,5 2.5,2.5,0,0,1,2.5,0z"},Q={};af.toString=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var O=function(g,b){if(b){typeof g=="string"&&(g=O(g));for(var a in b){b[ae](a)&&(a.substring(0,6)=="xlink:"?g.setAttributeNS(S,a.substring(6),ad(b[a])):g.setAttribute(a,ad(b[a])))}}else{g=af._g.doc.createElementNS("http://www.w3.org/2000/svg",g),g.style&&(g.style.webkitTapHighlightColor="rgba(0,0,0,0)")}return g},M=function(A,q){var l="linear",i=A.id+q,h=0.5,g=0.5,f=A.node,d=A.paper,a=f.style,aj=af._g.doc.getElementById(i);if(!aj){q=ad(q).replace(af._radial_gradient,function(k,j,n){l="radial";if(j&&n){h=ac(j),g=ac(n);var m=(g>0.5)*2-1;X(h-0.5,2)+X(g-0.5,2)>0.25&&(g=aa.sqrt(0.25-X(h-0.5,2))*m+0.5)&&g!=0.5&&(g=g.toFixed(5)-0.00001*m)}return U}),q=q.split(/\s*\-\s*/);if(l=="linear"){var ai=q.shift();ai=-ac(ai);if(isNaN(ai)){return null}var ah=[0,0,aa.cos(af.rad(ai)),aa.sin(af.rad(ai))],ag=1/(Z(Y(ah[2]),Y(ah[3]))||1);ah[2]*=ag,ah[3]*=ag,ah[2]<0&&(ah[0]=-ah[2],ah[2]=0),ah[3]<0&&(ah[1]=-ah[3],ah[3]=0)}var C=af._parseDots(q);if(!C){return null}i=i.replace(/[\(\)\s,\xb0#]/g,"_"),A.gradient&&i!=A.gradient.id&&(d.defs.removeChild(A.gradient),delete A.gradient);if(!A.gradient){aj=O(l+"Gradient",{id:i}),A.gradient=aj,O(aj,l=="radial"?{fx:h,fy:g}:{x1:ah[0],y1:ah[1],x2:ah[2],y2:ah[3],gradientTransform:A.matrix.invert()}),d.defs.appendChild(aj);for(var B=0,z=C.length;B<z;B++){aj.appendChild(O("stop",{offset:C[B].offset?C[B].offset:B?"100%":"0%","stop-color":C[B].color||"#fff"}))}}}O(f,{fill:"url(#"+i+")",opacity:1,"fill-opacity":1}),a.fill=U,a.opacity=1,a.fillOpacity=1;return 1},K=function(e){var d=e.getBBox(1);O(e.pattern,{patternTransform:e.matrix.invert()+" translate("+d.x+","+d.y+")"})},J=function(az,ay,ax){if(az.type=="path"){var aw=ad(ay).toLowerCase().split("-"),av=az.paper,au=ax?"end":"start",at=az.node,ar=az.attrs,aq=ar["stroke-width"],ap=aw.length,am="classic",ak,ai,ag,p,o,m=3,b=3,a=5;while(ap--){switch(aw[ap]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":am=aw[ap];break;case"wide":b=5;break;case"narrow":b=2;break;case"long":m=5;break;case"short":m=2}}am=="open"?(m+=2,b+=2,a+=2,ag=1,p=ax?4:1,o={fill:"none",stroke:ar.stroke}):(p=ag=m/2,o={fill:ar.stroke,stroke:"none"}),az._.arrows?ax?(az._.arrows.endPath&&Q[az._.arrows.endPath]--,az._.arrows.endMarker&&Q[az._.arrows.endMarker]--):(az._.arrows.startPath&&Q[az._.arrows.startPath]--,az._.arrows.startMarker&&Q[az._.arrows.startMarker]--):az._.arrows={};if(am!="none"){var ao="raphael-marker-"+am,an="raphael-marker-"+au+am+m+b;af._g.doc.getElementById(ao)?Q[ao]++:(av.defs.appendChild(O(O("path"),{"stroke-linecap":"round",d:R[am],id:ao})),Q[ao]=1);var al=af._g.doc.getElementById(an),aj;al?(Q[an]++,aj=al.getElementsByTagName("use")[0]):(al=O(O("marker"),{id:an,markerHeight:b,markerWidth:m,orient:"auto",refX:p,refY:b/2}),aj=O(O("use"),{"xlink:href":"#"+ao,transform:(ax?" rotate(180 "+m/2+" "+b/2+") ":T)+"scale("+m/a+","+b/a+")","stroke-width":1/((m/a+b/a)/2)}),al.appendChild(aj),av.defs.appendChild(al),Q[an]=1),O(aj,o);var ah=ag*(am!="diamond"&&am!="oval");ax?(ak=az._.arrows.startdx*aq||0,ai=af.getTotalLength(ar.path)-ah*aq):(ak=ah*aq,ai=af.getTotalLength(ar.path)-(az._.arrows.enddx*aq||0)),o={},o["marker-"+au]="url(#"+an+")";if(ai||ak){o.d=Raphael.getSubpath(ar.path,ak,ai)}O(at,o),az._.arrows[au+"Path"]=ao,az._.arrows[au+"Marker"]=an,az._.arrows[au+"dx"]=ah,az._.arrows[au+"Type"]=am,az._.arrows[au+"String"]=ay}else{ax?(ak=az._.arrows.startdx*aq||0,ai=af.getTotalLength(ar.path)-ak):(ak=0,ai=af.getTotalLength(ar.path)-(az._.arrows.enddx*aq||0)),az._.arrows[au+"Path"]&&O(at,{d:Raphael.getSubpath(ar.path,ak,ai)}),delete az._.arrows[au+"Path"],delete az._.arrows[au+"Marker"],delete az._.arrows[au+"dx"],delete az._.arrows[au+"Type"],delete az._.arrows[au+"String"]}for(o in Q){if(Q[ae](o)&&!Q[o]){var q=af._g.doc.getElementById(o);q&&q.parentNode.removeChild(q)}}}},I={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},H=function(j,i,o){i=I[ad(i).toLowerCase()];if(i){var n=j.attrs["stroke-width"]||"1",m={round:n,square:n,butt:0}[j.attrs["stroke-linecap"]||o["stroke-linecap"]]||0,l=[],k=i.length;while(k--){l[k]=i[k]*n+(k%2?1:-1)*m}O(j.node,{"stroke-dasharray":l.join(",")})}},G=function(al,ak){var aj=al.node,ai=al.attrs,ah=aj.style.visibility;aj.style.visibility="hidden";for(var ag in ak){if(ak[ae](ag)){if(!af._availableAttrs[ae](ag)){continue}var y=ak[ag];ai[ag]=y;switch(ag){case"blur":al.blur(y);break;case"href":case"title":case"target":var q=aj.parentNode;if(q.tagName.toLowerCase()!="a"){var j=O("a");q.insertBefore(j,aj),j.appendChild(aj),q=j}ag=="target"&&y=="blank"?q.setAttributeNS(S,"show","new"):q.setAttributeNS(S,ag,y);break;case"cursor":aj.style.cursor=y;break;case"transform":al.transform(y);break;case"arrow-start":J(al,y);break;case"arrow-end":J(al,y,1);break;case"clip-rect":var g=ad(y).split(W);if(g.length==4){al.clip&&al.clip.parentNode.parentNode.removeChild(al.clip.parentNode);var a=O("clipPath"),v=O("rect");a.id=af.createUUID(),O(v,{x:g[0],y:g[1],width:g[2],height:g[3]}),a.appendChild(v),al.paper.defs.appendChild(a),O(aj,{"clip-path":"url(#"+a.id+")"}),al.clip=v}if(!y){var t=aj.getAttribute("clip-path");if(t){var s=af._g.doc.getElementById(t.replace(/(^url\(#|\)$)/g,U));s&&s.parentNode.removeChild(s),O(aj,{"clip-path":U}),delete al.clip}}break;case"path":al.type=="path"&&(O(aj,{d:y?ai.path=af._pathToAbsolute(y):"M0,0"}),al._.dirty=1,al._.arrows&&("startString" in al._.arrows&&J(al,al._.arrows.startString),"endString" in al._.arrows&&J(al,al._.arrows.endString,1)));break;case"width":aj.setAttribute(ag,y),al._.dirty=1;if(ai.fx){ag="x",y=ai.x}else{break}case"x":ai.fx&&(y=-ai.x-(ai.width||0));case"rx":if(ag=="rx"&&al.type=="rect"){break}case"cx":aj.setAttribute(ag,y),al.pattern&&K(al),al._.dirty=1;break;case"height":aj.setAttribute(ag,y),al._.dirty=1;if(ai.fy){ag="y",y=ai.y}else{break}case"y":ai.fy&&(y=-ai.y-(ai.height||0));case"ry":if(ag=="ry"&&al.type=="rect"){break}case"cy":aj.setAttribute(ag,y),al.pattern&&K(al),al._.dirty=1;break;case"r":al.type=="rect"?O(aj,{rx:y,ry:y}):aj.setAttribute(ag,y),al._.dirty=1;break;case"src":al.type=="image"&&aj.setAttributeNS(S,"href",y);break;case"stroke-width":if(al._.sx!=1||al._.sy!=1){y/=Z(Y(al._.sx),Y(al._.sy))||1}al.paper._vbSize&&(y*=al.paper._vbSize),aj.setAttribute(ag,y),ai["stroke-dasharray"]&&H(al,ai["stroke-dasharray"],ak),al._.arrows&&("startString" in al._.arrows&&J(al,al._.arrows.startString),"endString" in al._.arrows&&J(al,al._.arrows.endString,1));break;case"stroke-dasharray":H(al,y,ak);break;case"fill":var r=ad(y).match(af._ISURL);if(r){a=O("pattern");var n=O("image");a.id=af.createUUID(),O(a,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),O(n,{x:0,y:0,"xlink:href":r[1]}),a.appendChild(n),function(d){af._preload(r[1],function(){var f=this.offsetWidth,i=this.offsetHeight;O(d,{width:f,height:i}),O(n,{width:f,height:i}),al.paper.safari()})}(a),al.paper.defs.appendChild(a),aj.style.fill="url(#"+a.id+")",O(aj,{fill:"url(#"+a.id+")"}),al.pattern=a,al.pattern&&K(al);break}var l=af.getRGB(y);if(!l.error){delete ak.gradient,delete ai.gradient,!af.is(ai.opacity,"undefined")&&af.is(ak.opacity,"undefined")&&O(aj,{opacity:ai.opacity}),!af.is(ai["fill-opacity"],"undefined")&&af.is(ak["fill-opacity"],"undefined")&&O(aj,{"fill-opacity":ai["fill-opacity"]})}else{if((al.type=="circle"||al.type=="ellipse"||ad(y).charAt()!="r")&&M(al,y)){if("opacity" in ai||"fill-opacity" in ai){var h=af._g.doc.getElementById(aj.getAttribute("fill").replace(/^url\(#|\)$/g,U));if(h){var e=h.getElementsByTagName("stop");O(e[e.length-1],{"stop-opacity":("opacity" in ai?ai.opacity:1)*("fill-opacity" in ai?ai["fill-opacity"]:1)})}}ai.gradient=y,ai.fill="none";break}}l[ae]("opacity")&&O(aj,{"fill-opacity":l.opacity>1?l.opacity/100:l.opacity});case"stroke":l=af.getRGB(y),aj.setAttribute(ag,l.hex),ag=="stroke"&&l[ae]("opacity")&&O(aj,{"stroke-opacity":l.opacity>1?l.opacity/100:l.opacity}),ag=="stroke"&&al._.arrows&&("startString" in al._.arrows&&J(al,al._.arrows.startString),"endString" in al._.arrows&&J(al,al._.arrows.endString,1));break;case"gradient":(al.type=="circle"||al.type=="ellipse"||ad(y).charAt()!="r")&&M(al,y);break;case"opacity":ai.gradient&&!ai[ae]("stroke-opacity")&&O(aj,{"stroke-opacity":y>1?y/100:y});case"fill-opacity":if(ai.gradient){h=af._g.doc.getElementById(aj.getAttribute("fill").replace(/^url\(#|\)$/g,U)),h&&(e=h.getElementsByTagName("stop"),O(e[e.length-1],{"stop-opacity":y}));break}default:ag=="font-size"&&(y=ab(y,10)+"px");var b=ag.replace(/(\-.)/g,function(d){return d.substring(1).toUpperCase()});aj.style[b]=y,al._.dirty=1,aj.setAttribute(ag,y)}}}E(al,ak),aj.style.visibility=ah},F=1.2,E=function(y,x){if(y.type=="text"&&!!(x[ae]("text")||x[ae]("font")||x[ae]("font-size")||x[ae]("x")||x[ae]("y"))){var w=y.attrs,v=y.node,u=v.firstChild?ab(af._g.doc.defaultView.getComputedStyle(v.firstChild,U).getPropertyValue("font-size"),10):10;if(x[ae]("text")){w.text=x.text;while(v.firstChild){v.removeChild(v.firstChild)}var t=ad(x.text).split("\n"),s=[],q;for(var l=0,e=t.length;l<e;l++){q=O("tspan"),l&&O(q,{dy:u*F,x:w.x}),q.appendChild(af._g.doc.createTextNode(t[l])),v.appendChild(q),s[l]=q}}else{s=v.getElementsByTagName("tspan");for(l=0,e=s.length;l<e;l++){l?O(s[l],{dy:u*F,x:w.x}):O(s[0],{dy:0})}}O(v,{x:w.x,y:w.y}),y._.dirty=1;var b=y._getBBox(),a=w.y-(b.y+b.height/2);a&&af.is(a,"finite")&&O(s[0],{dy:a})}},D=function(a,h){var g=0,f=0;this[0]=this.node=a,a.raphael=!0,this.id=af._oid++,a.raphaelid=this.id,this.matrix=af.matrix(),this.realPath=null,this.paper=h,this.attrs=this.attrs||{},this._={transform:[],sx:1,sy:1,deg:0,dx:0,dy:0,dirty:1},!h.bottom&&(h.bottom=this),this.prev=h.top,h.top&&(h.top.next=this),h.top=this,this.next=null},P=af.el;D.prototype=P,P.constructor=D,af._engine.path=function(f,e){var h=O("path");e.canvas&&e.canvas.appendChild(h);var g=new D(h,e);g.type="path",G(g,{fill:"none",stroke:"#000",path:f});return g},P.rotate=function(g,d,i){if(this.removed){return this}g=ad(g).split(W),g.length-1&&(d=ac(g[1]),i=ac(g[2])),g=ac(g[0]),i==null&&(d=i);if(d==null||i==null){var h=this.getBBox(1);d=h.x+h.width/2,i=h.y+h.height/2}this.transform(this._.transform.concat([["r",g,d,i]]));return this},P.scale=function(h,d,k,j){if(this.removed){return this}h=ad(h).split(W),h.length-1&&(d=ac(h[1]),k=ac(h[2]),j=ac(h[3])),h=ac(h[0]),d==null&&(d=h),j==null&&(k=j);if(k==null||j==null){var i=this.getBBox(1)}k=k==null?i.x+i.width/2:k,j=j==null?i.y+i.height/2:j,this.transform(this._.transform.concat([["s",h,d,k,j]]));return this},P.translate=function(e,d){if(this.removed){return this}e=ad(e).split(W),e.length-1&&(d=ac(e[1])),e=ac(e[0])||0,d=+d||0,this.transform(this._.transform.concat([["t",e,d]]));return this},P.transform=function(f){var b=this._;if(f==null){return b.transform}af._extractTransform(this,f),this.clip&&O(this.clip,{transform:this.matrix.invert()}),this.pattern&&K(this),this.node&&O(this.node,{transform:this.matrix});if(b.sx!=1||b.sy!=1){var a=this.attrs[ae]("stroke-width")?this.attrs["stroke-width"]:1;this.attr({"stroke-width":a})}return this},P.hide=function(){!this.removed&&this.paper.safari(this.node.style.display="none");return this},P.show=function(){!this.removed&&this.paper.safari(this.node.style.display="");return this},P.remove=function(){if(!this.removed){var a=this.paper;a.__set__&&a.__set__.exclude(this),V.unbind("*.*."+this.id),this.gradient&&a.defs.removeChild(this.gradient),af._tear(this,a),this.node.parentNode.removeChild(this.node);for(var d in this){this[d]=typeof this[d]=="function"?af._removedFactory(d):null}this.removed=!0}},P._getBBox=function(){if(this.node.style.display=="none"){this.show();var e=!0}var d={};try{d=this.node.getBBox()}catch(f){}finally{d=d||{}}e&&this.hide();return d},P.attr=function(x,w){if(this.removed){return this}if(x==null){var v={};for(var u in this.attrs){this.attrs[ae](u)&&(v[u]=this.attrs[u])}v.gradient&&v.fill=="none"&&(v.fill=v.gradient)&&delete v.gradient,v.transform=this._.transform;return v}if(w==null&&af.is(x,"string")){if(x=="fill"&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}if(x=="transform"){return this._.transform}var t=x.split(W),s={};for(var r=0,q=t.length;r<q;r++){x=t[r],x in this.attrs?s[x]=this.attrs[x]:af.is(this.paper.customAttributes[x],"function")?s[x]=this.paper.customAttributes[x].def:s[x]=af._availableAttrs[x]}return q-1?s:s[t[0]]}if(w==null&&af.is(x,"array")){s={};for(r=0,q=x.length;r<q;r++){s[x[r]]=this.attr(x[r])}return s}if(w!=null){var k={};k[x]=w}else{x!=null&&af.is(x,"object")&&(k=x)}for(var j in k){V("attr."+j+"."+this.id,this,k[j])}for(j in this.paper.customAttributes){if(this.paper.customAttributes[ae](j)&&k[ae](j)&&af.is(this.paper.customAttributes[j],"function")){var b=this.paper.customAttributes[j].apply(this,[].concat(k[j]));this.attrs[j]=k[j];for(var a in b){b[ae](a)&&(k[a]=b[a])}}}G(this,k);return this},P.toFront=function(){if(this.removed){return this}this.node.parentNode.tagName.toLowerCase()=="a"?this.node.parentNode.parentNode.appendChild(this.node.parentNode):this.node.parentNode.appendChild(this.node);var a=this.paper;a.top!=this&&af._tofront(this,a);return this},P.toBack=function(){if(this.removed){return this}var a=this.node.parentNode;a.tagName.toLowerCase()=="a"?a.parentNode.insertBefore(this.node.parentNode,this.node.parentNode.parentNode.firstChild):a.firstChild!=this.node&&a.insertBefore(this.node,this.node.parentNode.firstChild),af._toback(this,this.paper);var d=this.paper;return this},P.insertAfter=function(a){if(this.removed){return this}var d=a.node||a[a.length-1].node;d.nextSibling?d.parentNode.insertBefore(this.node,d.nextSibling):d.parentNode.appendChild(this.node),af._insertafter(this,a,this.paper);return this},P.insertBefore=function(a){if(this.removed){return this}var d=a.node||a[0].node;d.parentNode.insertBefore(this.node,d),af._insertbefore(this,a,this.paper);return this},P.blur=function(a){var h=this;if(+a!==0){var g=O("filter"),f=O("feGaussianBlur");h.attrs.blur=a,g.id=af.createUUID(),O(f,{stdDeviation:+a||1.5}),g.appendChild(f),h.paper.defs.appendChild(g),h._blur=g,O(h.node,{filter:"url(#"+g.id+")"})}else{h._blur&&(h._blur.parentNode.removeChild(h._blur),delete h._blur,delete h.attrs.blur),h.node.removeAttribute("filter")}},af._engine.circle=function(h,g,l,k){var j=O("circle");h.canvas&&h.canvas.appendChild(j);var i=new D(j,h);i.attrs={cx:g,cy:l,r:k,fill:"none",stroke:"#000"},i.type="circle",O(j,i.attrs);return i},af._engine.rect=function(j,i,p,o,n,m){var l=O("rect");j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:i,y:p,width:o,height:n,r:m||0,rx:m||0,ry:m||0,fill:"none",stroke:"#000"},k.type="rect",O(l,k.attrs);return k},af._engine.ellipse=function(i,h,n,m,l){var k=O("ellipse");i.canvas&&i.canvas.appendChild(k);var j=new D(k,i);j.attrs={cx:h,cy:n,rx:m,ry:l,fill:"none",stroke:"#000"},j.type="ellipse",O(k,j.attrs);return j},af._engine.image=function(j,i,p,o,n,m){var l=O("image");O(l,{x:p,y:o,width:n,height:m,preserveAspectRatio:"none"}),l.setAttributeNS(S,"href",i),j.canvas&&j.canvas.appendChild(l);var k=new D(l,j);k.attrs={x:p,y:o,width:n,height:m,src:i},k.type="image";return k},af._engine.text=function(a,l,k,j){var i=O("text");a.canvas&&a.canvas.appendChild(i);var h=new D(i,a);h.attrs={x:l,y:k,"text-anchor":"middle",text:j,font:af._availableAttrs.font,stroke:"none",fill:"#000"},h.type="text",G(h,h.attrs);return h},af._engine.setSize=function(e,d){this.width=e||this.width,this.height=d||this.height,this.canvas.setAttribute("width",this.width),this.canvas.setAttribute("height",this.height),this._viewBox&&this.setViewBox.apply(this,this._viewBox);return this},af._engine.create=function(){var r=af._getContainer.apply(0,arguments),q=r&&r.container,p=r.x,o=r.y,n=r.width,m=r.height;if(!q){throw new Error("SVG container not found.")}var l=O("svg"),k="overflow:hidden;",a;p=p||0,o=o||0,n=n||512,m=m||342,O(l,{height:m,version:1.1,width:n,xmlns:"http://www.w3.org/2000/svg"}),q==1?(l.style.cssText=k+"position:absolute;left:"+p+"px;top:"+o+"px",af._g.doc.body.appendChild(l),a=1):(l.style.cssText=k+"position:relative",q.firstChild?q.insertBefore(l,q.firstChild):q.appendChild(l)),q=new af._Paper,q.width=n,q.height=m,q.canvas=l,q.clear(),q._left=q._top=0,a&&(q.renderfix=function(){}),q.renderfix();return q},af._engine.setViewBox=function(t,s,r,q,p){V("setViewBox",this,this._viewBox,[t,s,r,q,p]);var o=Z(r/this.width,q/this.height),n=this.top,m=p?"meet":"xMinYMin",k,g;t==null?(this._vbSize&&(o=1),delete this._vbSize,k="0 0 "+this.width+T+this.height):(this._vbSize=o,k=t+T+s+T+r+T+q),O(this.canvas,{viewBox:k,preserveAspectRatio:m});while(o&&n){g="stroke-width" in n.attrs?n.attrs["stroke-width"]:1,n.attr({"stroke-width":g}),n._.dirty=1,n._.dirtyT=1,n=n.prev}this._viewBox=[t,s,r,q,!!p];return this},af.prototype.renderfix=function(){var g=this.canvas,f=g.style,j=g.getScreenCTM()||g.createSVGMatrix(),i=-j.e%1,h=-j.f%1;if(i||h){i&&(this._left=(this._left+i)%1,f.left=this._left+"px"),h&&(this._top=(this._top+h)%1,f.top=this._top+"px")}},af.prototype.clear=function(){af.eve("clear",this);var a=this.canvas;while(a.firstChild){a.removeChild(a.firstChild)}this.bottom=this.top=null,(this.desc=O("desc")).appendChild(af._g.doc.createTextNode("Created with Raphaël "+af.version)),a.appendChild(this.desc),a.appendChild(this.defs=O("defs"))},af.prototype.remove=function(){V("remove",this),this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?af._removedFactory(a):null}};var N=af.st;for(var L in P){P[ae](L)&&!N[ae](L)&&(N[L]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b].apply(d,a)})}}(L))}}(window.Raphael),window.Raphael.vml&&function(ap){var ao="hasOwnProperty",an=String,am=parseFloat,al=Math,ak=al.round,aj=al.max,ai=al.min,ah=al.abs,ag="fill",af=/[, ]+/,ae=ap.eve,ad=" progid:DXImageTransform.Microsoft",ac=" ",ab="",aa={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Y=/([clmz]),?([^clmz]*)/gi,W=/ progid:\S+Blur\([^\)]+\)/g,U=/-?[^,\s-]+/g,S="position:absolute;left:0;top:0;width:1px;height:1px",Q=21600,O={path:1,rect:1,image:1},M={circle:1,ellipse:1},K=function(w){var v=/[ahqstv]/ig,u=ap._pathToAbsolute;an(w).match(v)&&(u=ap._path2curve),v=/[clmz]/g;if(u==ap._pathToAbsolute&&!an(w).match(v)){var t=an(w).replace(Y,function(i,h,m){var l=[],k=h.toLowerCase()=="m",j=aa[h];m.replace(U,function(b){k&&l.length==2&&(j+=l+aa[h=="m"?"l":"L"],l=[]),l.push(ak(b*Q))});return j+l});return t}var s=u(w),q,p;t=[];for(var o=0,n=s.length;o<n;o++){q=s[o],p=s[o][0].toLowerCase(),p=="z"&&(p="x");for(var f=1,a=q.length;f<a;f++){p+=ak(q[f]*Q)+(f!=a-1?",":ab)}t.push(p)}return t.join(ac)},J=function(a,h,g){var f=ap.matrix();f.rotate(-a,0.5,0.5);return{dx:f.x(h,g),dy:f.y(h,g)}},I=function(ar,aq,H,G,F,E){var D=ar._,C=ar.matrix,B=D.fillpos,A=ar.node,z=A.style,y=1,x="",w,u=Q/aq,n=Q/H;z.visibility="hidden";if(!!aq&&!!H){A.coordsize=ah(u)+ac+ah(n),z.rotation=E*(aq*H<0?-1:1);if(E){var j=J(E,G,F);G=j.dx,F=j.dy}aq<0&&(x+="x"),H<0&&(x+=" y")&&(y=-1),z.flip=x,A.coordorigin=G*-u+ac+F*-n;if(B||D.fillsize){var i=A.getElementsByTagName(ag);i=i&&i[0],A.removeChild(i),B&&(j=J(E,C.x(B[0],B[1]),C.y(B[0],B[1])),i.position=j.dx*y+ac+j.dy*y),D.fillsize&&(i.size=D.fillsize[0]*ah(aq)+ac+D.fillsize[1]*ah(H)),A.appendChild(i)}z.visibility="visible"}};ap.toString=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version};var Z=function(u,t,s){var r=an(t).toLowerCase().split("-"),q=s?"end":"start",p=r.length,o="classic",n="medium",m="medium";while(p--){switch(r[p]){case"block":case"classic":case"oval":case"diamond":case"open":case"none":o=r[p];break;case"wide":case"narrow":m=r[p];break;case"long":case"short":n=r[p]}}var l=u.node.getElementsByTagName("stroke")[0];l[q+"arrow"]=o,l[q+"arrowlength"]=n,l[q+"arrowwidth"]=m},X=function(aG,aF){aG.attrs=aG.attrs||{};var aE=aG.node,aD=aG.attrs,aC=aE.style,aB,az=O[aG.type]&&(aF.x!=aD.x||aF.y!=aD.y||aF.width!=aD.width||aF.height!=aD.height||aF.cx!=aD.cx||aF.cy!=aD.cy||aF.rx!=aD.rx||aF.ry!=aD.ry||aF.r!=aD.r),ax=M[aG.type]&&(aD.cx!=aF.cx||aD.cy!=aF.cy||aD.r!=aF.r||aD.rx!=aF.rx||aD.ry!=aF.ry),aw=aG;for(var aq in aF){aF[ao](aq)&&(aD[aq]=aF[aq])}az&&(aD.path=ap._getPath[aG.type](aG),aG._.dirty=1),aF.href&&(aE.href=aF.href),aF.title&&(aE.title=aF.title),aF.target&&(aE.target=aF.target),aF.cursor&&(aC.cursor=aF.cursor),"blur" in aF&&aG.blur(aF.blur);if(aF.path&&aG.type=="path"||az){aE.path=K(~an(aD.path).toLowerCase().indexOf("r")?ap._pathToAbsolute(aD.path):aD.path),aG.type=="image"&&(aG._.fillpos=[aD.x,aD.y],aG._.fillsize=[aD.width,aD.height],I(aG,1,1,0,0,0))}"transform" in aF&&aG.transform(aF.transform);if(ax){var aA=+aD.cx,ay=+aD.cy,av=+aD.rx||+aD.r||0,au=+aD.ry||+aD.r||0;aE.path=ap.format("ar{0},{1},{2},{3},{4},{1},{4},{1}x",ak((aA-av)*Q),ak((ay-au)*Q),ak((aA+av)*Q),ak((ay+au)*Q),ak(aA*Q))}if("clip-rect" in aF){var at=an(aF["clip-rect"]).split(af);if(at.length==4){at[2]=+at[2]+ +at[0],at[3]=+at[3]+ +at[1];var ar=aE.clipRect||ap._g.doc.createElement("div"),F=ar.style;F.clip=ap.format("rect({1}px {2}px {3}px {0}px)",at),aE.clipRect||(F.position="absolute",F.top=0,F.left=0,F.width=aG.paper.width+"px",F.height=aG.paper.height+"px",aE.parentNode.insertBefore(ar,aE),ar.appendChild(aE),aE.clipRect=ar)}aF["clip-rect"]||aE.clipRect&&(aE.clipRect.style.clip="auto")}if(aG.textpath){var C=aG.textpath.style;aF.font&&(C.font=aF.font),aF["font-family"]&&(C.fontFamily='"'+aF["font-family"].split(",")[0].replace(/^['"]+|['"]+$/g,ab)+'"'),aF["font-size"]&&(C.fontSize=aF["font-size"]),aF["font-weight"]&&(C.fontWeight=aF["font-weight"]),aF["font-style"]&&(C.fontStyle=aF["font-style"])}"arrow-start" in aF&&Z(aw,aF["arrow-start"]),"arrow-end" in aF&&Z(aw,aF["arrow-end"],1);if(aF.opacity!=null||aF["stroke-width"]!=null||aF.fill!=null||aF.src!=null||aF.stroke!=null||aF["stroke-width"]!=null||aF["stroke-opacity"]!=null||aF["fill-opacity"]!=null||aF["stroke-dasharray"]!=null||aF["stroke-miterlimit"]!=null||aF["stroke-linejoin"]!=null||aF["stroke-linecap"]!=null){var A=aE.getElementsByTagName(ag),z=!1;A=A&&A[0],!A&&(z=A=P(ag)),aG.type=="image"&&aF.src&&(A.src=aF.src),aF.fill&&(A.on=!0);if(A.on==null||aF.fill=="none"||aF.fill===null){A.on=!1}if(A.on&&aF.fill){var x=an(aF.fill).match(ap._ISURL);if(x){A.parentNode==aE&&aE.removeChild(A),A.rotate=!0,A.src=x[1],A.type="tile";var w=aG.getBBox(1);A.position=w.x+ac+w.y,aG._.fillpos=[w.x,w.y],ap._preload(x[1],function(){aG._.fillsize=[this.offsetWidth,this.offsetHeight]})}else{A.color=ap.getRGB(aF.fill).hex,A.src=ab,A.type="solid",ap.getRGB(aF.fill).error&&(aw.type in {circle:1,ellipse:1}||an(aF.fill).charAt()!="r")&&V(aw,aF.fill,A)&&(aD.fill="none",aD.gradient=aF.fill,A.rotate=!1)}}if("fill-opacity" in aF||"opacity" in aF){var v=((+aD["fill-opacity"]+1||2)-1)*((+aD.opacity+1||2)-1)*((+ap.getRGB(aF.fill).o+1||2)-1);v=ai(aj(v,0),1),A.opacity=v,A.src&&(A.color="none")}aE.appendChild(A);var o=aE.getElementsByTagName("stroke")&&aE.getElementsByTagName("stroke")[0],j=!1;!o&&(j=o=P("stroke"));if(aF.stroke&&aF.stroke!="none"||aF["stroke-width"]||aF["stroke-opacity"]!=null||aF["stroke-dasharray"]||aF["stroke-miterlimit"]||aF["stroke-linejoin"]||aF["stroke-linecap"]){o.on=!0}(aF.stroke=="none"||aF.stroke===null||o.on==null||aF.stroke==0||aF["stroke-width"]==0)&&(o.on=!1);var h=ap.getRGB(aF.stroke);o.on&&aF.stroke&&(o.color=h.hex),v=((+aD["stroke-opacity"]+1||2)-1)*((+aD.opacity+1||2)-1)*((+h.o+1||2)-1);var g=(am(aF["stroke-width"])||1)*0.75;v=ai(aj(v,0),1),aF["stroke-width"]==null&&(g=aD["stroke-width"]),aF["stroke-width"]&&(o.weight=g),g&&g<1&&(v*=g)&&(o.weight=1),o.opacity=v,aF["stroke-linejoin"]&&(o.joinstyle=aF["stroke-linejoin"]||"miter"),o.miterlimit=aF["stroke-miterlimit"]||8,aF["stroke-linecap"]&&(o.endcap=aF["stroke-linecap"]=="butt"?"flat":aF["stroke-linecap"]=="square"?"square":"round");if(aF["stroke-dasharray"]){var f={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};o.dashstyle=f[ao](aF["stroke-dasharray"])?f[aF["stroke-dasharray"]]:ab}j&&aE.appendChild(o)}if(aw.type=="text"){aw.paper.canvas.style.display=ab;var d=aw.paper.span,b=100,a=aD.font&&aD.font.match(/\d+(?:\.\d*)?(?=px)/);aC=d.style,aD.font&&(aC.font=aD.font),aD["font-family"]&&(aC.fontFamily=aD["font-family"]),aD["font-weight"]&&(aC.fontWeight=aD["font-weight"]),aD["font-style"]&&(aC.fontStyle=aD["font-style"]),a=am(aD["font-size"]||a&&a[0])||10,aC.fontSize=a*b+"px",aw.textpath.string&&(d.innerHTML=an(aw.textpath.string).replace(/</g,"&#60;").replace(/&/g,"&#38;").replace(/\n/g,"<br>"));var k=d.getBoundingClientRect();aw.W=aD.w=(k.right-k.left)/b,aw.H=aD.h=(k.bottom-k.top)/b,aw.X=aD.x,aw.Y=aD.y+aw.H/2,("x" in aF||"y" in aF)&&(aw.path.v=ap.format("m{0},{1}l{2},{1}",ak(aD.x*Q),ak(aD.y*Q),ak(aD.x*Q)+1));var aH=["x","y","text","font","font-family","font-weight","font-style","font-size"];for(var u=0,n=aH.length;u<n;u++){if(aH[u] in aF){aw._.dirty=1;break}}switch(aD["text-anchor"]){case"start":aw.textpath.style["v-text-align"]="left",aw.bbx=aw.W/2;break;case"end":aw.textpath.style["v-text-align"]="right",aw.bbx=-aw.W/2;break;default:aw.textpath.style["v-text-align"]="center",aw.bbx=0}aw.textpath.style["v-text-kern"]=!0}},V=function(A,z,y){A.attrs=A.attrs||{};var x=A.attrs,w=Math.pow,v,u,o="linear",n=".5 .5";A.attrs.gradient=z,z=an(z).replace(ap._radial_gradient,function(g,f,h){o="radial",f&&h&&(f=am(f),h=am(h),w(f-0.5,2)+w(h-0.5,2)>0.25&&(h=al.sqrt(0.25-w(f-0.5,2))*((h>0.5)*2-1)+0.5),n=f+ac+h);return ab}),z=z.split(/\s*\-\s*/);if(o=="linear"){var e=z.shift();e=-am(e);if(isNaN(e)){return null}}var d=ap._parseDots(z);if(!d){return null}A=A.shape||A.node;if(d.length){A.removeChild(y),y.on=!0,y.method="none",y.color=d[0].color,y.color2=d[d.length-1].color;var a=[];for(var C=0,B=d.length;C<B;C++){d[C].offset&&a.push(d[C].offset+ac+d[C].color)}y.colors=a.length?a.join():"0% "+y.color,o=="radial"?(y.type="gradientTitle",y.focus="100%",y.focussize="0 0",y.focusposition=n,y.angle=0):(y.type="gradient",y.angle=(270-e)%360),A.appendChild(y)}return 1},T=function(a,d){this[0]=this.node=a,a.raphael=!0,this.id=ap._oid++,a.raphaelid=this.id,this.X=0,this.Y=0,this.attrs={},this.paper=d,this.matrix=ap.matrix(),this._={transform:[],sx:1,sy:1,dx:0,dy:0,deg:0,dirty:1,dirtyT:1},!d.bottom&&(d.bottom=this),this.prev=d.top,d.top&&(d.top.next=this),d.top=this,this.next=null},R=ap.el;T.prototype=R,R.constructor=T,R.transform=function(C){if(C==null){return this._.transform}var B=this.paper._viewBoxShift,A=B?"s"+[B.scale,B.scale]+"-1-1t"+[B.dx,B.dy]:ab,z;B&&(z=C=an(C).replace(/\.{3}|\u2026/g,this._.transform||ab)),ap._extractTransform(this,A+C);var y=this.matrix.clone(),x=this.skew,w=this.node,v,u=~an(this.attrs.fill).indexOf("-"),t=!an(this.attrs.fill).indexOf("url(");y.translate(-0.5,-0.5);if(t||u||this.type=="image"){x.matrix="1 0 0 1",x.offset="0 0",v=y.split();if(u&&v.noRotation||!v.isSimple){w.style.filter=y.toFilter();var s=this.getBBox(),o=this.getBBox(1),n=s.x-o.x,a=s.y-o.y;w.coordorigin=n*-Q+ac+a*-Q,I(this,1,1,n,a,0)}else{w.style.filter=ab,I(this,v.scalex,v.scaley,v.dx,v.dy,v.rotate)}}else{w.style.filter=ab,x.matrix=an(y),x.offset=y.offset()}z&&(this._.transform=z);return this},R.rotate=function(g,d,i){if(this.removed){return this}if(g!=null){g=an(g).split(af),g.length-1&&(d=am(g[1]),i=am(g[2])),g=am(g[0]),i==null&&(d=i);if(d==null||i==null){var h=this.getBBox(1);d=h.x+h.width/2,i=h.y+h.height/2}this._.dirtyT=1,this.transform(this._.transform.concat([["r",g,d,i]]));return this}},R.translate=function(e,d){if(this.removed){return this}e=an(e).split(af),e.length-1&&(d=am(e[1])),e=am(e[0])||0,d=+d||0,this._.bbox&&(this._.bbox.x+=e,this._.bbox.y+=d),this.transform(this._.transform.concat([["t",e,d]]));return this},R.scale=function(h,d,k,j){if(this.removed){return this}h=an(h).split(af),h.length-1&&(d=am(h[1]),k=am(h[2]),j=am(h[3]),isNaN(k)&&(k=null),isNaN(j)&&(j=null)),h=am(h[0]),d==null&&(d=h),j==null&&(k=j);if(k==null||j==null){var i=this.getBBox(1)}k=k==null?i.x+i.width/2:k,j=j==null?i.y+i.height/2:j,this.transform(this._.transform.concat([["s",h,d,k,j]])),this._.dirtyT=1;return this},R.hide=function(){!this.removed&&(this.node.style.display="none");return this},R.show=function(){!this.removed&&(this.node.style.display=ab);return this},R._getBBox=function(){if(this.removed){return{}}return{x:this.X+(this.bbx||0)-this.W/2,y:this.Y-this.H,width:this.W,height:this.H}},R.remove=function(){if(!this.removed){this.paper.__set__&&this.paper.__set__.exclude(this),ap.eve.unbind("*.*."+this.id),ap._tear(this,this.paper),this.node.parentNode.removeChild(this.node),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var a in this){this[a]=typeof this[a]=="function"?ap._removedFactory(a):null}this.removed=!0}},R.attr=function(x,w){if(this.removed){return this}if(x==null){var v={};for(var u in this.attrs){this.attrs[ao](u)&&(v[u]=this.attrs[u])}v.gradient&&v.fill=="none"&&(v.fill=v.gradient)&&delete v.gradient,v.transform=this._.transform;return v}if(w==null&&ap.is(x,"string")){if(x==ag&&this.attrs.fill=="none"&&this.attrs.gradient){return this.attrs.gradient}var t=x.split(af),s={};for(var r=0,l=t.length;r<l;r++){x=t[r],x in this.attrs?s[x]=this.attrs[x]:ap.is(this.paper.customAttributes[x],"function")?s[x]=this.paper.customAttributes[x].def:s[x]=ap._availableAttrs[x]}return l-1?s:s[t[0]]}if(this.attrs&&w==null&&ap.is(x,"array")){s={};for(r=0,l=x.length;r<l;r++){s[x[r]]=this.attr(x[r])}return s}var k;w!=null&&(k={},k[x]=w),w==null&&ap.is(x,"object")&&(k=x);for(var j in k){ae("attr."+j+"."+this.id,this,k[j])}if(k){for(j in this.paper.customAttributes){if(this.paper.customAttributes[ao](j)&&k[ao](j)&&ap.is(this.paper.customAttributes[j],"function")){var b=this.paper.customAttributes[j].apply(this,[].concat(k[j]));this.attrs[j]=k[j];for(var a in b){b[ao](a)&&(k[a]=b[a])}}}k.text&&this.type=="text"&&(this.textpath.string=k.text),X(this,k)}return this},R.toFront=function(){!this.removed&&this.node.parentNode.appendChild(this.node),this.paper&&this.paper.top!=this&&ap._tofront(this,this.paper);return this},R.toBack=function(){if(this.removed){return this}this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),ap._toback(this,this.paper));return this},R.insertAfter=function(a){if(this.removed){return this}a.constructor==ap.st.constructor&&(a=a[a.length-1]),a.node.nextSibling?a.node.parentNode.insertBefore(this.node,a.node.nextSibling):a.node.parentNode.appendChild(this.node),ap._insertafter(this,a,this.paper);return this},R.insertBefore=function(a){if(this.removed){return this}a.constructor==ap.st.constructor&&(a=a[0]),a.node.parentNode.insertBefore(this.node,a.node),ap._insertbefore(this,a,this.paper);return this},R.blur=function(a){var f=this.node.runtimeStyle,e=f.filter;e=e.replace(W,ab),+a!==0?(this.attrs.blur=a,f.filter=e+ac+ad+".Blur(pixelradius="+(+a||1.5)+")",f.margin=ap.format("-{0}px 0 0 -{0}px",ak(+a||1.5))):(f.filter=e,f.margin=0,delete this.attrs.blur)},ap._engine.path=function(h,g){var l=P("shape");l.style.cssText=S,l.coordsize=Q+ac+Q,l.coordorigin=g.coordorigin;var k=new T(l,g),j={fill:"none",stroke:"#000"};h&&(j.path=h),k.type="path",k.path=[],k.Path=ab,X(k,j),g.canvas.appendChild(l);var i=P("skew");i.on=!0,l.appendChild(i),k.skew=i,k.transform(ab);return k},ap._engine.rect=function(r,q,p,o,n,m){var l=ap._rectPath(q,p,o,n,m),k=r.path(l),a=k.attrs;k.X=a.x=q,k.Y=a.y=p,k.W=a.width=o,k.H=a.height=n,a.r=m,a.path=l,k.type="rect";return k},ap._engine.ellipse=function(i,h,n,m,l){var k=i.path(),j=k.attrs;k.X=h-m,k.Y=n-l,k.W=m*2,k.H=l*2,k.type="ellipse",X(k,{cx:h,cy:n,rx:m,ry:l});return k},ap._engine.circle=function(h,g,l,k){var j=h.path(),i=j.attrs;j.X=g-k,j.Y=l-k,j.W=j.H=k*2,j.type="circle",X(j,{cx:g,cy:l,r:k});return j},ap._engine.image=function(v,u,t,s,r,q){var p=ap._rectPath(t,s,r,q),o=v.path(p).attr({stroke:"none"}),n=o.attrs,j=o.node,a=j.getElementsByTagName(ag)[0];n.src=u,o.X=n.x=t,o.Y=n.y=s,o.W=n.width=r,o.H=n.height=q,n.path=p,o.type="image",a.parentNode==j&&j.removeChild(a),a.rotate=!0,a.src=u,a.type="tile",o._.fillpos=[t,s],o._.fillsize=[r,q],j.appendChild(a),I(o,1,1,0,0,0);return o},ap._engine.text=function(u,t,s,r){var q=P("shape"),p=P("path"),o=P("textpath");t=t||0,s=s||0,r=r||"",p.v=ap.format("m{0},{1}l{2},{1}",ak(t*Q),ak(s*Q),ak(t*Q)+1),p.textpathok=!0,o.string=an(r),o.on=!0,q.style.cssText=S,q.coordsize=Q+ac+Q,q.coordorigin="0 0";var n=new T(q,u),f={fill:"#000",stroke:"none",font:ap._availableAttrs.font,text:r};n.shape=q,n.path=p,n.textpath=o,n.type="text",n.attrs.text=an(r),n.attrs.x=t,n.attrs.y=s,n.attrs.w=1,n.attrs.h=1,X(n,f),q.appendChild(o),q.appendChild(p),u.canvas.appendChild(q);var a=P("skew");a.on=!0,q.appendChild(a),n.skew=a,n.transform(ab);return n},ap._engine.setSize=function(a,f){var e=this.canvas.style;this.width=a,this.height=f,a==+a&&(a+="px"),f==+f&&(f+="px"),e.width=a,e.height=f,e.clip="rect(0 "+a+" "+f+" 0)",this._viewBox&&ap._engine.setViewBox.apply(this,this._viewBox);return this},ap._engine.setViewBox=function(t,s,r,q,p){ap.eve("setViewBox",this,this._viewBox,[t,s,r,q,p]);var o=this.width,n=this.height,m=1/aj(r/o,q/n),g,a;p&&(g=n/q,a=o/r,r*g<o&&(t-=(o-r*g)/2/g),q*a<n&&(s-=(n-q*a)/2/a)),this._viewBox=[t,s,r,q,!!p],this._viewBoxShift={dx:-t,dy:-s,scale:m},this.forEach(function(b){b.transform("...")});return this};var P;ap._engine.initWin=function(e){var d=e.document;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),P=function(b){return d.createElement("<rvml:"+b+' class="rvml">')}}catch(f){P=function(b){return d.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}},ap._engine.initWin(ap._g.win),ap._engine.create=function(){var t=ap._getContainer.apply(0,arguments),s=t.container,r=t.height,q,p=t.width,o=t.x,n=t.y;if(!s){throw new Error("VML container not found.")}var m=new ap._Paper,l=m.canvas=ap._g.doc.createElement("div"),a=l.style;o=o||0,n=n||0,p=p||512,r=r||342,m.width=p,m.height=r,p==+p&&(p+="px"),r==+r&&(r+="px"),m.coordsize=Q*1000+ac+Q*1000,m.coordorigin="0 0",m.span=ap._g.doc.createElement("span"),m.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;",l.appendChild(m.span),a.cssText=ap.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",p,r),s==1?(ap._g.doc.body.appendChild(l),a.left=o+"px",a.top=n+"px",a.position="absolute"):s.firstChild?s.insertBefore(l,s.firstChild):s.appendChild(l),m.renderfix=function(){};return m},ap.prototype.clear=function(){ap.eve("clear",this),this.canvas.innerHTML=ab,this.span=ap._g.doc.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas.appendChild(this.span),this.bottom=this.top=null},ap.prototype.remove=function(){ap.eve("remove",this),this.canvas.parentNode.removeChild(this.canvas);for(var a in this){this[a]=typeof this[a]=="function"?ap._removedFactory(a):null}return !0};var N=ap.st;for(var L in R){R[ao](L)&&!N[ao](L)&&(N[L]=function(b){return function(){var a=arguments;return this.forEach(function(d){d[b].apply(d,a)})}}(L))}}(window.Raphael);(function(){var v=this;var s=v._;var b={};var j=Array.prototype,C=Object.prototype,F=Function.prototype;var t=j.slice,x=j.unshift,w=C.toString,p=C.hasOwnProperty;var n=j.forEach,i=j.map,A=j.reduce,f=j.reduceRight,m=j.filter,a=j.every,z=j.some,u=j.indexOf,g=j.lastIndexOf,d=Array.isArray,B=Object.keys,k=F.bind;var E=function(G){return new h(G)};if(typeof module!=="undefined"&&module.exports){module.exports=E;E._=E}else{v._=E}E.VERSION="1.2.0";var e=E.each=E.forEach=function(L,K,J){if(L==null){return}if(n&&L.forEach===n){L.forEach(K,J)}else{if(L.length===+L.length){for(var I=0,G=L.length;I<G;I++){if(I in L&&K.call(J,L[I],I,L)===b){return}}}else{for(var H in L){if(p.call(L,H)){if(K.call(J,L[H],H,L)===b){return}}}}}};E.map=function(J,I,H){var G=[];if(J==null){return G}if(i&&J.map===i){return J.map(I,H)}e(J,function(M,K,L){G[G.length]=I.call(H,M,K,L)});return G};E.reduce=E.foldl=E.inject=function(K,J,G,I){var H=G!==void 0;if(K==null){K=[]}if(A&&K.reduce===A){if(I){J=E.bind(J,I)}return H?K.reduce(J,G):K.reduce(J)}e(K,function(N,L,M){if(!H){G=N;H=true}else{G=J.call(I,G,N,L,M)}});if(!H){throw new TypeError("Reduce of empty array with no initial value")}return G};E.reduceRight=E.foldr=function(J,I,G,H){if(J==null){J=[]}if(f&&J.reduceRight===f){if(H){I=E.bind(I,H)}return G!==void 0?J.reduceRight(I,G):J.reduceRight(I)}var K=(E.isArray(J)?J.slice():E.toArray(J)).reverse();return E.reduce(K,I,G,H)};E.find=E.detect=function(J,I,H){var G;q(J,function(M,K,L){if(I.call(H,M,K,L)){G=M;return true}});return G};E.filter=E.select=function(J,I,H){var G=[];if(J==null){return G}if(m&&J.filter===m){return J.filter(I,H)}e(J,function(M,K,L){if(I.call(H,M,K,L)){G[G.length]=M}});return G};E.reject=function(J,I,H){var G=[];if(J==null){return G}e(J,function(M,K,L){if(!I.call(H,M,K,L)){G[G.length]=M}});return G};E.every=E.all=function(J,I,H){var G=true;if(J==null){return G}if(a&&J.every===a){return J.every(I,H)}e(J,function(M,K,L){if(!(G=G&&I.call(H,M,K,L))){return b}});return G};var q=E.some=E.any=function(J,I,H){I=I||E.identity;var G=false;if(J==null){return G}if(z&&J.some===z){return J.some(I,H)}e(J,function(M,K,L){if(G|=I.call(H,M,K,L)){return b}});return !!G};E.include=E.contains=function(I,H){var G=false;if(I==null){return G}if(u&&I.indexOf===u){return I.indexOf(H)!=-1}q(I,function(J){if(G=J===H){return true}});return G};E.invoke=function(H,I){var G=t.call(arguments,2);return E.map(H,function(J){return(I.call?I||J:J[I]).apply(J,G)})};E.pluck=function(H,G){return E.map(H,function(I){return I[G]})};E.max=function(J,I,H){if(!I&&E.isArray(J)){return Math.max.apply(Math,J)}if(!I&&E.isEmpty(J)){return -Infinity}var G={computed:-Infinity};e(J,function(N,K,M){var L=I?I.call(H,N,K,M):N;L>=G.computed&&(G={value:N,computed:L})});return G.value};E.min=function(J,I,H){if(!I&&E.isArray(J)){return Math.min.apply(Math,J)}if(!I&&E.isEmpty(J)){return Infinity}var G={computed:Infinity};e(J,function(N,K,M){var L=I?I.call(H,N,K,M):N;L<G.computed&&(G={value:N,computed:L})});return G.value};E.shuffle=function(I){var G=[],H;e(I,function(L,J,K){if(J==0){G[0]=L}else{H=Math.floor(Math.random()*(J+1));G[J]=G[H];G[H]=L}});return G};E.sortBy=function(I,H,G){return E.pluck(E.map(I,function(L,J,K){return{value:L,criteria:H.call(G,L,J,K)}}).sort(function(M,L){var K=M.criteria,J=L.criteria;return K<J?-1:K>J?1:0}),"value")};E.groupBy=function(I,H){var G={};e(I,function(L,J){var K=H(L,J);(G[K]||(G[K]=[])).push(L)});return G};E.sortedIndex=function(L,K,I){I||(I=E.identity);var G=0,J=L.length;while(G<J){var H=(G+J)>>1;I(L[H])<I(K)?G=H+1:J=H}return G};E.toArray=function(G){if(!G){return[]}if(G.toArray){return G.toArray()}if(E.isArray(G)){return t.call(G)}if(E.isArguments(G)){return t.call(G)}return E.values(G)};E.size=function(G){return E.toArray(G).length};E.first=E.head=function(I,H,G){return(H!=null)&&!G?t.call(I,0,H):I[0]};E.initial=function(I,H,G){return t.call(I,0,I.length-((H==null)||G?1:H))};E.last=function(I,H,G){return(H!=null)&&!G?t.call(I,I.length-H):I[I.length-1]};E.rest=E.tail=function(I,G,H){return t.call(I,(G==null)||H?1:G)};E.compact=function(G){return E.filter(G,function(H){return !!H})};E.flatten=function(G){return E.reduce(G,function(H,I){if(E.isArray(I)){return H.concat(E.flatten(I))}H[H.length]=I;return H},[])};E.without=function(G){return E.difference(G,t.call(arguments,1))};E.uniq=E.unique=function(K,J,I){var H=I?E.map(K,I):K;var G=[];E.reduce(H,function(L,N,M){if(0==M||(J===true?E.last(L)!=N:!E.include(L,N))){L[L.length]=N;G[G.length]=K[M]}return L},[]);return G};E.union=function(){return E.uniq(E.flatten(arguments))};E.intersection=E.intersect=function(H){var G=t.call(arguments,1);return E.filter(E.uniq(H),function(I){return E.every(G,function(J){return E.indexOf(J,I)>=0})})};E.difference=function(H,G){return E.filter(H,function(I){return !E.include(G,I)})};E.zip=function(){var G=t.call(arguments);var J=E.max(E.pluck(G,"length"));var I=new Array(J);for(var H=0;H<J;H++){I[H]=E.pluck(G,""+H)}return I};E.indexOf=function(K,I,J){if(K==null){return -1}var H,G;if(J){H=E.sortedIndex(K,I);return K[H]===I?H:-1}if(u&&K.indexOf===u){return K.indexOf(I)}for(H=0,G=K.length;H<G;H++){if(K[H]===I){return H}}return -1};E.lastIndexOf=function(I,H){if(I==null){return -1}if(g&&I.lastIndexOf===g){return I.lastIndexOf(H)}var G=I.length;while(G--){if(I[G]===H){return G}}return -1};E.range=function(L,J,K){if(arguments.length<=1){J=L||0;L=0}K=arguments[2]||1;var H=Math.max(Math.ceil((J-L)/K),0);var G=0;var I=new Array(H);while(G<H){I[G++]=L;L+=K}return I};E.bind=function(H,I){if(H.bind===k&&k){return k.apply(H,t.call(arguments,1))}var G=t.call(arguments,2);return function(){return H.apply(I,G.concat(t.call(arguments)))}};E.bindAll=function(H){var G=t.call(arguments,1);if(G.length==0){G=E.functions(H)}e(G,function(I){H[I]=E.bind(H[I],H)});return H};E.memoize=function(I,H){var G={};H||(H=E.identity);return function(){var J=H.apply(this,arguments);return p.call(G,J)?G[J]:(G[J]=I.apply(this,arguments))}};E.delay=function(H,I){var G=t.call(arguments,2);return setTimeout(function(){return H.apply(H,G)},I)};E.defer=function(G){return E.delay.apply(E,[G,1].concat(t.call(arguments,1)))};var y=function(H,J,G){var I;return function(){var L=this,K=arguments;var M=function(){I=null;H.apply(L,K)};if(G){clearTimeout(I)}if(G||!I){I=setTimeout(M,J)}}};E.throttle=function(G,H){return y(G,H,false)};E.debounce=function(G,H){return y(G,H,true)};E.once=function(I){var G=false,H;return function(){if(G){return H}G=true;return H=I.apply(this,arguments)}};E.wrap=function(G,H){return function(){var I=[G].concat(t.call(arguments));return H.apply(this,I)}};E.compose=function(){var G=t.call(arguments);return function(){var H=t.call(arguments);for(var I=G.length-1;I>=0;I--){H=[G[I].apply(this,H)]}return H[0]}};E.after=function(H,G){return function(){if(--H<1){return G.apply(this,arguments)}}};E.keys=B||function(I){if(I!==Object(I)){throw new TypeError("Invalid object")}var H=[];for(var G in I){if(p.call(I,G)){H[H.length]=G}}return H};E.values=function(G){return E.map(G,E.identity)};E.functions=E.methods=function(I){var H=[];for(var G in I){if(E.isFunction(I[G])){H.push(G)}}return H.sort()};E.extend=function(G){e(t.call(arguments,1),function(H){for(var I in H){if(H[I]!==void 0){G[I]=H[I]}}});return G};E.defaults=function(G){e(t.call(arguments,1),function(H){for(var I in H){if(G[I]==null){G[I]=H[I]}}});return G};E.clone=function(G){return E.isArray(G)?G.slice():E.extend({},G)};E.tap=function(H,G){G(H);return H};function D(V,T,J){if(V===T){return V!==0||1/V==1/T}if(V==null){return V===T}var P=typeof V;if(P!=typeof T){return false}if(!V!=!T){return false}if(E.isNaN(V)){return E.isNaN(T)}var S=E.isString(V),R=E.isString(T);if(S||R){return S&&R&&String(V)==String(T)}var W=E.isNumber(V),U=E.isNumber(T);if(W||U){return W&&U&&+V==+T}var H=E.isBoolean(V),G=E.isBoolean(T);if(H||G){return H&&G&&+V==+T}var N=E.isDate(V),M=E.isDate(T);if(N||M){return N&&M&&V.getTime()==T.getTime()}var L=E.isRegExp(V),K=E.isRegExp(T);if(L||K){return L&&K&&V.source==T.source&&V.global==T.global&&V.multiline==T.multiline&&V.ignoreCase==T.ignoreCase}if(P!="object"){return false}if(V._chain){V=V._wrapped}if(T._chain){T=T._wrapped}if(E.isFunction(V.isEqual)){return V.isEqual(T)}var I=J.length;while(I--){if(J[I]==V){return true}}J.push(V);var Q=0,O=true;if(V.length===+V.length||T.length===+T.length){Q=V.length;O=Q==T.length;if(O){while(Q--){if(!(O=Q in V==Q in T&&D(V[Q],T[Q],J))){break}}}}else{for(var X in V){if(p.call(V,X)){Q++;if(!(O=p.call(T,X)&&D(V[X],T[X],J))){break}}}if(O){for(X in T){if(p.call(T,X)&&!Q--){break}}O=!Q}}J.pop();return O}E.isEqual=function(H,G){return D(H,G,[])};E.isEmpty=function(H){if(E.isArray(H)||E.isString(H)){return H.length===0}for(var G in H){if(p.call(H,G)){return false}}return true};E.isElement=function(G){return !!(G&&G.nodeType==1)};E.isArray=d||function(G){return w.call(G)==="[object Array]"};E.isObject=function(G){return G===Object(G)};E.isArguments=function(G){return !!(G&&p.call(G,"callee"))};E.isFunction=function(G){return !!(G&&G.constructor&&G.call&&G.apply)};E.isString=function(G){return !!(G===""||(G&&G.charCodeAt&&G.substr))};E.isNumber=function(G){return !!(G===0||(G&&G.toExponential&&G.toFixed))};E.isNaN=function(G){return G!==G};E.isBoolean=function(G){return G===true||G===false||w.call(G)=="[object Boolean]"};E.isDate=function(G){return !!(G&&G.getTimezoneOffset&&G.setUTCFullYear)};E.isRegExp=function(G){return !!(G&&G.test&&G.exec&&(G.ignoreCase||G.ignoreCase===false))};E.isNull=function(G){return G===null};E.isUndefined=function(G){return G===void 0};E.noConflict=function(){v._=s;return this};E.identity=function(G){return G};E.times=function(J,I,H){for(var G=0;G<J;G++){I.call(H,G)}};E.escape=function(G){return(""+G).replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")};E.mixin=function(G){e(E.functions(G),function(H){r(H,E[H]=G[H])})};var l=0;E.uniqueId=function(G){var H=l++;return G?G+H:H};E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};E.template=function(J,I){var K=E.templateSettings;var G="var __p=[],print=function(){__p.push.apply(__p,arguments);};with(obj||{}){__p.push('"+J.replace(/\\/g,"\\\\").replace(/'/g,"\\'").replace(K.escape,function(L,M){return"',_.escape("+M.replace(/\\'/g,"'")+"),'"}).replace(K.interpolate,function(L,M){return"',"+M.replace(/\\'/g,"'")+",'"}).replace(K.evaluate||null,function(L,M){return"');"+M.replace(/\\'/g,"'").replace(/[\r\n\t]/g," ")+"__p.push('"}).replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")+"');}return __p.join('');";var H=new Function("obj",G);return I?H(I):H};var h=function(G){this._wrapped=G};E.prototype=h.prototype;var o=function(H,G){return G?E(H).chain():H};var r=function(G,H){h.prototype[G]=function(){var I=t.call(arguments);x.call(I,this._wrapped);return o(H.apply(E,I),this._chain)}};E.mixin(E);e(["pop","push","reverse","shift","sort","splice","unshift"],function(G){var H=j[G];h.prototype[G]=function(){H.apply(this._wrapped,arguments);return o(this._wrapped,this._chain)}});e(["concat","join","slice"],function(G){var H=j[G];h.prototype[G]=function(){return o(H.apply(this._wrapped,arguments),this._chain)}});h.prototype.chain=function(){this._chain=true;return this};h.prototype.value=function(){return this._wrapped}})();
/*!
 * accounting.js v0.3.2
 * Copyright 2011, Joss Crowcroft
 *
 * Freely distributable under the MIT license.
 * Portions of accounting.js are inspired or borrowed from underscore.js
 *
 * Full details and documentation:
 * http://josscrowcroft.github.com/accounting.js/
 */
(function(p,h){var o={};o.version="0.3.2";o.settings={currency:{symbol:"$",format:"%s%v",decimal:".",thousand:",",precision:2,grouping:3},number:{precision:0,grouping:3,thousand:",",decimal:"."}};var q=Array.prototype.map,k=Array.isArray,g=Object.prototype.toString;function d(s){return !!(s===""||(s&&s.charCodeAt&&s.substr))}function l(s){return k?k(s):g.call(s)==="[object Array]"}function r(s){return g.call(s)==="[object Object]"}function i(t,s){var u;t=t||{};s=s||{};for(u in s){if(s.hasOwnProperty(u)){if(t[u]==null){t[u]=s[u]}}}return t}function a(x,w,v){var u=[],t,s;if(!x){return u}if(q&&x.map===q){return x.map(w,v)}for(t=0,s=x.length;t<s;t++){u[t]=w.call(v,x[t],t,x)}return u}function m(t,s){t=Math.round(Math.abs(t));return isNaN(t)?s:t}function f(t){var s=o.settings.currency.format;if(typeof t==="function"){t=t()}if(d(t)&&t.match("%v")){return{pos:t,neg:t.replace("-","").replace("%v","-%v"),zero:t}}else{if(!t||!t.pos||!t.pos.match("%v")){return(!d(s))?s:o.settings.currency.format={pos:s,neg:s.replace("%v","-%v"),zero:s}}}return t}var j=o.unformat=o.parse=function(v,s){if(l(v)){return a(v,function(w){return j(w,s)})}v=v||0;if(typeof v==="number"){return v}s=s||".";var u=new RegExp("[^0-9-"+s+"]",["g"]),t=parseFloat((""+v).replace(/\((.*)\)/,"-$1").replace(u,"").replace(s,"."));return !isNaN(t)?t:0};var b=o.toFixed=function(u,s){s=m(s,o.settings.number.precision);var t=Math.pow(10,s);return(Math.round(o.unformat(u)*t)/t).toFixed(s)};var e=o.formatNumber=function(u,x,A,w){if(l(u)){return a(u,function(B){return e(B,x,A,w)})}u=j(u);var s=i((r(x)?x:{precision:x,thousand:A,decimal:w}),o.settings.number),y=m(s.precision),v=u<0?"-":"",t=parseInt(b(Math.abs(u||0),y),10)+"",z=t.length>3?t.length%3:0;return v+(z?t.substr(0,z)+s.thousand:"")+t.substr(z).replace(/(\d{3})(?=\d)/g,"$1"+s.thousand)+(y?s.decimal+b(Math.abs(u),y).split(".")[1]:"")};var n=o.formatMoney=function(u,t,w,A,v,z){if(l(u)){return a(u,function(B){return n(B,t,w,A,v,z)})}u=j(u);var s=i((r(t)?t:{symbol:t,precision:w,thousand:A,decimal:v,format:z}),o.settings.currency),y=f(s.format),x=u>0?y.pos:u<0?y.neg:y.zero;return x.replace("%s",s.symbol).replace("%v",e(Math.abs(u),m(s.precision),s.thousand,s.decimal))};o.formatColumn=function(z,u,x,C,w,B){if(!z){return[]}var s=i((r(u)?u:{symbol:u,precision:x,thousand:C,decimal:w,format:B}),o.settings.currency),A=f(s.format),y=A.pos.indexOf("%s")<A.pos.indexOf("%v")?true:false,t=0,v=a(z,function(G,E){if(l(G)){return o.formatColumn(G,s)}else{G=j(G);var D=G>0?A.pos:G<0?A.neg:A.zero,F=D.replace("%s",s.symbol).replace("%v",e(Math.abs(G),m(s.precision),s.thousand,s.decimal));if(F.length>t){t=F.length}return F}});return a(v,function(E,D){if(d(E)&&E.length<t){return y?E.replace(s.symbol,s.symbol+(new Array(t-E.length+1).join(" "))):(new Array(t-E.length+1).join(" "))+E}return E})};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=o}exports.accounting=o}else{if(typeof define==="function"&&define.amd){define([],function(){return o})}else{o.noConflict=(function(s){return function(){p.accounting=s;o.noConflict=h;return o}})(p.accounting);p.accounting=o}}}(this));(function(){this.$jit=function(x){x=x||window;for(var y in $jit){if($jit[y].$extend){x[y]=$jit[y]}}};$jit.version="2.0.1";var d=function(x){return document.getElementById(x)};d.empty=function(){};d.extend=function(z,x){for(var y in (x||{})){z[y]=x[y]}return z};d.lambda=function(x){return(typeof x=="function")?x:function(){return x}};d.time=Date.now||function(){return +new Date};d.splat=function(y){var x=d.type(y);return x?((x!="array")?[y]:y):[]};d.type=function(y){var x=d.type.s.call(y).match(/^\[object\s(.*)\]$/)[1].toLowerCase();if(x!="object"){return x}if(y&&y.$$family){return y.$$family}if(y&&y.nodeType==9){return"htmldocument"}return(y&&y.nodeName&&y.nodeType==1)?"element":x};d.type.s=Object.prototype.toString;d.each=function(C,B){var A=d.type(C);if(A=="object"){for(var z in C){B(C[z],z)}}else{for(var y=0,x=C.length;y<x;y++){B(C[y],y)}}};d.indexOf=function(A,z){if(A.indexOf){return A.indexOf(z)}for(var y=0,x=A.length;y<x;y++){if(A[y]===z){return y}}return -1};d.map=function(z,y){var x=[];d.each(z,function(B,A){x.push(y(B,A))});return x};d.reduce=function(B,z,y){var x=B.length;if(x==0){return y}var A=arguments.length==3?y:B[--x];while(x--){A=z(A,B[x])}return A};d.merge=function(){var B={};for(var A=0,x=arguments.length;A<x;A++){var y=arguments[A];if(d.type(y)!="object"){continue}for(var z in y){var D=y[z],C=B[z];B[z]=(C&&d.type(D)=="object"&&d.type(C)=="object")?d.merge(C,D):d.unlink(D)}}return B};d.unlink=function(z){var y;switch(d.type(z)){case"object":y={};for(var B in z){y[B]=d.unlink(z[B])}break;case"array":y=[];for(var A=0,x=z.length;A<x;A++){y[A]=d.unlink(z[A])}break;default:return z}return y};d.zip=function(){if(arguments.length===0){return[]}for(var z=0,y=[],x=arguments.length,C=arguments[0].length;z<C;z++){for(var A=0,B=[];A<x;A++){B.push(arguments[A][z])}y.push(B)}return y};d.rgbToHex=function(B,A){if(B.length<3){return null}if(B.length==4&&B[3]==0&&!A){return"transparent"}var y=[];for(var x=0;x<3;x++){var z=(B[x]-0).toString(16);y.push(z.length==1?"0"+z:z)}return A?y:"#"+y.join("")};d.hexToRgb=function(z){if(z.length!=7){z=z.match(/^#?(\w{1,2})(\w{1,2})(\w{1,2})$/);z.shift();if(z.length!=3){return null}var x=[];for(var y=0;y<3;y++){var A=z[y];if(A.length==1){A+=A}x.push(parseInt(A,16))}return x}else{z=parseInt(z.slice(1),16);return[z>>16,z>>8&255,z&255]}};d.destroy=function(x){d.clean(x);if(x.parentNode){x.parentNode.removeChild(x)}if(x.clearAttributes){x.clearAttributes()}};d.clean=function(A){for(var z=A.childNodes,y=0,x=z.length;y<x;y++){d.destroy(z[y])}};d.addEvent=function(z,y,x){if(z.addEventListener){z.addEventListener(y,x,false)}else{z.attachEvent("on"+y,x)}};d.addEvents=function(y,z){for(var x in z){d.addEvent(y,x,z[x])}};d.hasClass=function(y,x){return(" "+y.className+" ").indexOf(" "+x+" ")>-1};d.addClass=function(y,x){if(!d.hasClass(y,x)){y.className=(y.className+" "+x)}};d.removeClass=function(y,x){y.className=y.className.replace(new RegExp("(^|\\s)"+x+"(?:\\s|$)"),"$1")};d.getPos=function(z){var C=B(z);var x=A(z);return{x:C.x-x.x,y:C.y-x.y};function B(E){var D={x:0,y:0};while(E&&!y(E)){D.x+=E.offsetLeft;D.y+=E.offsetTop;E=E.offsetParent}return D}function A(E){var D={x:0,y:0};while(E&&!y(E)){D.x+=E.scrollLeft;D.y+=E.scrollTop;E=E.parentNode}return D}function y(D){return(/^(?:body|html)$/i).test(D.tagName)}};d.getDir=function(z){var y=document.getElementById(z)||document.body;if(y.currentStyle){var x=y.currentStyle.direction}else{if(window.getComputedStyle){var x=document.defaultView.getComputedStyle(y,null).getPropertyValue("direction")}}return x};d.event={get:function(y,x){x=x||window;return y||x.event},getWheel:function(x){return x.wheelDelta?x.wheelDelta/120:-(x.detail||0)/3},isRightClick:function(x){return(x.which==3||x.button==2)},getPos:function(A,z){z=z||window;A=A||z.event;var y=z.document;y=y.documentElement||y.body;if(A.touches&&A.touches.length){A=A.touches[0]}var x={x:A.pageX||(A.clientX+y.scrollLeft),y:A.pageY||(A.clientY+y.scrollTop)};return x},stop:function(x){if(x.stopPropagation){x.stopPropagation()}x.cancelBubble=true;if(x.preventDefault){x.preventDefault()}else{x.returnValue=false}}};$jit.util=$jit.id=d;var r=function(y){y=y||{};var x=function(){for(var B in this){if(typeof this[B]!="function"){this[B]=d.unlink(this[B])}}this.constructor=x;if(r.prototyping){return this}var A=this.initialize?this.initialize.apply(this,arguments):this;this.$$family="class";return A};for(var z in r.Mutators){if(!y[z]){continue}y=r.Mutators[z](y,y[z]);delete y[z]}d.extend(x,this);x.constructor=r;x.prototype=y;return x};r.Mutators={Implements:function(x,y){d.each(d.splat(y),function(A){r.prototyping=A;var z=(typeof A=="function")?new A:A;for(var B in z){if(!(B in x)){x[B]=z[B]}}delete r.prototyping});return x}};d.extend(r,{inherit:function(x,A){for(var z in A){var y=A[z];var C=x[z];var B=d.type(y);if(C&&B=="function"){if(y!=C){r.override(x,z,y)}}else{if(B=="object"){x[z]=d.merge(C,y)}else{x[z]=y}}}return x},override:function(y,x,B){var A=r.prototyping;if(A&&y[x]!=A[x]){A=null}var z=function(){var C=this.parent;this.parent=A?A[x]:y[x];var D=B.apply(this,arguments);this.parent=C;return D};y[x]=z}});r.prototype.implement=function(){var x=this.prototype;d.each(Array.prototype.slice.call(arguments||[]),function(y){r.inherit(x,y)});return this};$jit.Class=r;$jit.json={prune:function(y,x){this.each(y,function(A,z){if(z==x&&A.children){delete A.children;A.children=[]}})},getParent:function(x,B){if(x.id==B){return false}var A=x.children;if(A&&A.length>0){for(var z=0;z<A.length;z++){if(A[z].id==B){return x}else{var y=this.getParent(A[z],B);if(y){return y}}}}return false},getSubtree:function(x,B){if(x.id==B){return x}for(var z=0,A=x.children;A&&z<A.length;z++){var y=this.getSubtree(A[z],B);if(y!=null){return y}}return null},eachLevel:function(x,C,z,B){if(C<=z){B(x,C);if(!x.children){return}for(var y=0,A=x.children;y<A.length;y++){this.eachLevel(A[y],C+1,z,B)}}},each:function(x,y){this.eachLevel(x,0,Number.MAX_VALUE,y)}};$jit.Trans={$extend:true,linear:function(x){return x}};var j=$jit.Trans;(function(){var x=function(A,z){z=d.splat(z);return d.extend(A,{easeIn:function(B){return A(B,z)},easeOut:function(B){return 1-A(1-B,z)},easeInOut:function(B){return(B<=0.5)?A(2*B,z)/2:(2-A(2*(1-B),z))/2}})};var y={Pow:function(A,z){return Math.pow(A,z[0]||6)},Expo:function(z){return Math.pow(2,8*(z-1))},Circ:function(z){return 1-Math.sin(Math.acos(z))},Sine:function(z){return 1-Math.sin((1-z)*Math.PI/2)},Back:function(A,z){z=z[0]||1.618;return Math.pow(A,2)*((z+1)*A-z)},Bounce:function(C){var B;for(var A=0,z=1;1;A+=z,z/=2){if(C>=(7-4*A)/11){B=z*z-Math.pow((11-6*A-11*C)/4,2);break}}return B},Elastic:function(A,z){return Math.pow(2,10*--A)*Math.cos(20*A*Math.PI*(z[0]||1)/3)}};d.each(y,function(A,z){j[z]=x(A)});d.each(["Quad","Cubic","Quart","Quint"],function(A,z){j[A]=x(function(B){return Math.pow(B,[z+2])})})})();var v=new r({initialize:function(x){this.setOptions(x)},setOptions:function(x){var y={duration:2500,fps:40,transition:j.Quart.easeInOut,compute:d.empty,complete:d.empty,link:"ignore"};this.opt=d.merge(y,x||{});return this},step:function(){var y=d.time(),x=this.opt;if(y<this.time+x.duration){var z=x.transition((y-this.time)/x.duration);x.compute(z)}else{this.timer=clearInterval(this.timer);x.compute(1);x.complete()}},start:function(){if(!this.check()){return this}this.time=0;this.startTimer();return this},startTimer:function(){var x=this,y=this.opt.fps;if(this.timer){return false}this.time=d.time()-this.time;this.timer=setInterval((function(){x.step()}),Math.round(1000/y));return true},pause:function(){this.stopTimer();return this},resume:function(){this.startTimer();return this},stopTimer:function(){if(!this.timer){return false}this.time=d.time()-this.time;this.timer=clearInterval(this.timer);return true},check:function(){if(!this.timer){return true}if(this.opt.link=="cancel"){this.stopTimer();return true}return false}});var o=function(){var z=arguments;for(var B=0,x=z.length,y={};B<x;B++){var A=o[z[B]];if(A.$extend){d.extend(y,A)}else{y[z[B]]=A}}return y};o.AreaChart={$extend:true,animate:true,labelOffset:3,type:"stacked",Tips:{enable:false,onShow:d.empty,onHide:d.empty},Events:{enable:false,onClick:d.empty},selectOnHover:true,showAggregates:true,showLabels:true,filterOnClick:false,restoreOnRightClick:false};o.Margin={$extend:false,top:0,left:0,right:0,bottom:0};o.Canvas={$extend:true,injectInto:"id",type:"2D",width:false,height:false,useCanvas:false,withLabels:true,background:false,Scene:{Lighting:{enable:false,ambient:[1,1,1],directional:{direction:{x:-100,y:-100,z:-100},color:[0.5,0.3,0.1]}}}};o.Tree={$extend:true,orientation:"left",subtreeOffset:8,siblingOffset:5,indent:10,multitree:false,align:"center",levelSpacing:"even"};o.Node={$extend:false,overridable:false,type:"circle",color:"#ccb",alpha:1,dim:3,height:20,width:90,autoHeight:false,autoWidth:false,lineWidth:1,transform:true,align:"center",angularWidth:1,span:1,CanvasStyles:{}};o.Edge={$extend:false,overridable:false,type:"line",color:"#ccb",lineWidth:1,dim:15,alpha:1,epsilon:7,CanvasStyles:{}};o.Fx={$extend:true,fps:40,duration:2500,transition:$jit.Trans.Quart.easeInOut,clearCanvas:true};o.Label={$extend:false,overridable:false,type:"HTML",style:" ",size:10,family:"sans-serif",textAlign:"center",textBaseline:"alphabetic",color:"#fff"};o.Tips={$extend:false,enable:false,type:"auto",offsetX:20,offsetY:20,force:false,onShow:d.empty,onHide:d.empty};o.NodeStyles={$extend:false,enable:false,type:"auto",stylesHover:false,stylesClick:false};o.Events={$extend:false,enable:false,enableForEdges:false,type:"auto",onClick:d.empty,onRightClick:d.empty,onMouseMove:d.empty,onMouseEnter:d.empty,onMouseLeave:d.empty,onDragStart:d.empty,onDragMove:d.empty,onDragCancel:d.empty,onDragEnd:d.empty,onTouchStart:d.empty,onTouchMove:d.empty,onTouchEnd:d.empty,onTouchCancel:d.empty,onMouseWheel:d.empty};o.Navigation={$extend:false,enable:false,type:"auto",panning:false,zooming:false};o.Controller={$extend:true,onBeforeCompute:d.empty,onAfterCompute:d.empty,onCreateLabel:d.empty,onPlaceLabel:d.empty,onComplete:d.empty,onBeforePlotLine:d.empty,onAfterPlotLine:d.empty,onBeforePlotNode:d.empty,onAfterPlotNode:d.empty,onBeforeRemoveNode:d.empty,request:false};var u={initialize:function(z,x){this.viz=x;this.canvas=x.canvas;this.config=x.config[z];this.nodeTypes=x.fx.nodeTypes;var y=this.config.type;this.dom=y=="auto"?(x.config.Label.type!="Native"):(y!="Native");this.labelContainer=this.dom&&x.labels.getLabelContainer();this.isEnabled()&&this.initializePost()},initializePost:d.empty,setAsProperty:d.lambda(false),isEnabled:function(){return this.config.enable},isLabel:function(C,B,A){C=d.event.get(C,B);var x=this.labelContainer,z=C.target||C.srcElement,y=C.relatedTarget;if(A){return y&&y==this.viz.canvas.getCtx().canvas&&!!z&&this.isDescendantOf(z,x)}else{return this.isDescendantOf(z,x)}},isDescendantOf:function(y,x){while(y&&y.parentNode){if(y.parentNode==x){return y}y=y.parentNode}return false}};var i={onMouseUp:d.empty,onMouseDown:d.empty,onMouseMove:d.empty,onMouseOver:d.empty,onMouseOut:d.empty,onMouseWheel:d.empty,onTouchStart:d.empty,onTouchMove:d.empty,onTouchEnd:d.empty,onTouchCancel:d.empty};var t=new r({initialize:function(x){this.viz=x;this.canvas=x.canvas;this.node=false;this.edge=false;this.registeredObjects=[];this.attachEvents()},attachEvents:function(){var z=this.canvas.getElement(),y=this;z.oncontextmenu=d.lambda(false);d.addEvents(z,{mouseup:function(C,B){var A=d.event.get(C,B);y.handleEvent("MouseUp",C,B,y.makeEventObject(C,B),d.event.isRightClick(A))},mousedown:function(C,B){var A=d.event.get(C,B);y.handleEvent("MouseDown",C,B,y.makeEventObject(C,B),d.event.isRightClick(A))},mousemove:function(B,A){y.handleEvent("MouseMove",B,A,y.makeEventObject(B,A))},mouseover:function(B,A){y.handleEvent("MouseOver",B,A,y.makeEventObject(B,A))},mouseout:function(B,A){y.handleEvent("MouseOut",B,A,y.makeEventObject(B,A))},touchstart:function(B,A){y.handleEvent("TouchStart",B,A,y.makeEventObject(B,A))},touchmove:function(B,A){y.handleEvent("TouchMove",B,A,y.makeEventObject(B,A))},touchend:function(B,A){y.handleEvent("TouchEnd",B,A,y.makeEventObject(B,A))}});var x=function(D,C){var B=d.event.get(D,C);var A=d.event.getWheel(B);y.handleEvent("MouseWheel",D,C,A)};if(!document.getBoxObjectFor&&window.mozInnerScreenX==null){d.addEvent(z,"mousewheel",x)}else{z.addEventListener("DOMMouseScroll",x,false)}},register:function(x){this.registeredObjects.push(x)},handleEvent:function(){var y=Array.prototype.slice.call(arguments),B=y.shift();for(var A=0,z=this.registeredObjects,x=z.length;A<x;A++){z[A]["on"+B].apply(z[A],y)}},makeEventObject:function(D,C){var A=this,B=this.viz.graph,z=this.viz.fx,y=z.nodeTypes,x=z.edgeTypes;return{pos:false,node:false,edge:false,contains:false,getNodeCalled:false,getEdgeCalled:false,getPos:function(){var G=A.viz.canvas,H=G.getSize(),I=G.getPos(),F=G.translateOffsetX,E=G.translateOffsetY,L=G.scaleOffsetX,J=G.scaleOffsetY,K=d.event.getPos(D,C);this.pos={x:(K.x-I.x-H.width/2-F)*1/L,y:(K.y-I.y-H.height/2-E)*1/J};return this.pos},getNode:function(){if(this.getNodeCalled){return this.node}this.getNodeCalled=true;for(var H in B.nodes){var G=B.nodes[H],F=G&&y[G.getData("type")],E=F&&F.contains&&F.contains.call(z,G,this.getPos());if(E){this.contains=E;return A.node=this.node=G}}return A.node=this.node=false},getEdge:function(){if(this.getEdgeCalled){return this.edge}this.getEdgeCalled=true;var G={};for(var K in B.edges){var I=B.edges[K];G[K]=true;for(var J in I){if(J in G){continue}var H=I[J],F=H&&x[H.getData("type")],E=F&&F.contains&&F.contains.call(z,H,this.getPos());if(E){this.contains=E;return A.edge=this.edge=H}}}return A.edge=this.edge=false},getContains:function(){if(this.getNodeCalled){return this.contains}this.getNode();return this.contains}}}});var p={initializeExtras:function(){var y=new t(this),x=this;d.each(["NodeStyles","Tips","Navigation","Events"],function(z){var A=new p.Classes[z](z,x);if(A.isEnabled()){y.register(A)}if(A.setAsProperty()){x[z.toLowerCase()]=A}})}};p.Classes={};p.Classes.Events=new r({Implements:[u,i],initializePost:function(){this.fx=this.viz.fx;this.ntypes=this.viz.fx.nodeTypes;this.etypes=this.viz.fx.edgeTypes;this.hovered=false;this.pressed=false;this.touched=false;this.touchMoved=false;this.moved=false},setAsProperty:d.lambda(true),onMouseUp:function(B,A,y,z){var x=d.event.get(B,A);if(!this.moved){if(z){this.config.onRightClick(this.hovered,y,x)}else{this.config.onClick(this.pressed,y,x)}}if(this.pressed){if(this.moved){this.config.onDragEnd(this.pressed,y,x)}else{this.config.onDragCancel(this.pressed,y,x)}this.pressed=this.moved=false}},onMouseOut:function(C,B,A){var y=d.event.get(C,B),z;if(this.dom&&(z=this.isLabel(C,B,true))){this.config.onMouseLeave(this.viz.graph.getNode(z.id),A,y);this.hovered=false;return}var x=y.relatedTarget,D=this.canvas.getElement();while(x&&x.parentNode){if(D==x.parentNode){return}x=x.parentNode}if(this.hovered){this.config.onMouseLeave(this.hovered,A,y);this.hovered=false}},onMouseOver:function(B,A,z){var x=d.event.get(B,A),y;if(this.dom&&(y=this.isLabel(B,A,true))){this.hovered=this.viz.graph.getNode(y.id);this.config.onMouseEnter(this.hovered,z,x)}},onMouseMove:function(D,C,B){var y,x=d.event.get(D,C);if(this.pressed){this.moved=true;this.config.onDragMove(this.pressed,B,x);return}if(this.dom){this.config.onMouseMove(this.hovered,B,x)}else{if(this.hovered){var E=this.hovered;var A=E.nodeFrom?this.etypes[E.getData("type")]:this.ntypes[E.getData("type")];var z=A&&A.contains&&A.contains.call(this.fx,E,B.getPos());if(z){this.config.onMouseMove(E,B,x);return}else{this.config.onMouseLeave(E,B,x);this.hovered=false}}if(this.hovered=(B.getNode()||(this.config.enableForEdges&&B.getEdge()))){this.config.onMouseEnter(this.hovered,B,x)}else{this.config.onMouseMove(false,B,x)}}},onMouseWheel:function(y,x,z){this.config.onMouseWheel(z,d.event.get(y,x))},onMouseDown:function(B,A,z){var x=d.event.get(B,A),y;if(this.dom){if(y=this.isLabel(B,A)){this.pressed=this.viz.graph.getNode(y.id)}}else{this.pressed=z.getNode()||(this.config.enableForEdges&&z.getEdge())}this.pressed&&this.config.onDragStart(this.pressed,z,x)},onTouchStart:function(B,A,z){var x=d.event.get(B,A),y;if(this.dom&&(y=this.isLabel(B,A))){this.touched=this.viz.graph.getNode(y.id)}else{this.touched=z.getNode()||(this.config.enableForEdges&&z.getEdge())}this.touched&&this.config.onTouchStart(this.touched,z,x)},onTouchMove:function(A,z,y){var x=d.event.get(A,z);if(this.touched){this.touchMoved=true;this.config.onTouchMove(this.touched,y,x)}},onTouchEnd:function(A,z,y){var x=d.event.get(A,z);if(this.touched){if(this.touchMoved){this.config.onTouchEnd(this.touched,y,x)}else{this.config.onTouchCancel(this.touched,y,x)}this.touched=this.touchMoved=false}}});p.Classes.Tips=new r({Implements:[u,i],initializePost:function(){if(document.body){var x=d("_tooltip")||document.createElement("div");x.id="_tooltip";x.className="tip";d.extend(x.style,{position:"absolute",display:"none",zIndex:13000});document.body.appendChild(x);this.tip=x;this.node=false}},setAsProperty:d.lambda(true),onMouseOut:function(A,z){var y=d.event.get(A,z);if(this.dom&&this.isLabel(A,z,true)){this.hide(true);return}var x=A.relatedTarget,B=this.canvas.getElement();while(x&&x.parentNode){if(B==x.parentNode){return}x=x.parentNode}this.hide(false)},onMouseOver:function(z,y){var x;if(this.dom&&(x=this.isLabel(z,y,false))){this.node=this.viz.graph.getNode(x.id);this.config.onShow(this.tip,this.node,x)}},onMouseMove:function(A,z,x){if(this.dom&&this.isLabel(A,z)){this.setTooltipPosition(d.event.getPos(A,z))}if(!this.dom){var y=x.getNode();if(!y){this.hide(true);return}if(this.config.force||!this.node||this.node.id!=y.id){this.node=y;this.config.onShow(this.tip,y,x.getContains())}this.setTooltipPosition(d.event.getPos(A,z))}},setTooltipPosition:function(D){var G=this.tip,z=G.style,H=this.config;z.display="";var A=document.compatMode==="CSS1Compat"&&document.documentElement||document.body||document.documentElement;var E={width:A.clientWidth,height:A.clientHeight,x:window.pageXOffset||document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft||0,y:window.pageYOffset||document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0};var B={width:G.offsetWidth,height:G.offsetHeight};var F=H.offsetX,C=H.offsetY;z.top=((D.y+B.height+C>E.height+E.y)?(D.y-B.height-C):D.y+C)+"px";z.left=((D.x+B.width+F>E.width+E.x)?(D.x-B.width-F):D.x+F)+"px"},hide:function(x){this.tip.style.display="none";x&&this.config.onHide()}});p.Classes.NodeStyles=new r({Implements:[u,i],initializePost:function(){this.fx=this.viz.fx;this.types=this.viz.fx.nodeTypes;this.nStyles=this.config;this.nodeStylesOnHover=this.nStyles.stylesHover;this.nodeStylesOnClick=this.nStyles.stylesClick;this.hoveredNode=false;this.fx.nodeFxAnimation=new v();this.down=false;this.move=false},onMouseOut:function(z,y){this.down=this.move=false;if(!this.hoveredNode){return}if(this.dom&&this.isLabel(z,y,true)){this.toggleStylesOnHover(this.hoveredNode,false)}var x=z.relatedTarget,A=this.canvas.getElement();while(x&&x.parentNode){if(A==x.parentNode){return}x=x.parentNode}this.toggleStylesOnHover(this.hoveredNode,false);this.hoveredNode=false},onMouseOver:function(A,z){var x;if(this.dom&&(x=this.isLabel(A,z,true))){var y=this.viz.graph.getNode(x.id);if(y.selected){return}this.hoveredNode=y;this.toggleStylesOnHover(this.hoveredNode,true)}},onMouseDown:function(B,A,y,z){if(z){return}var x;if(this.dom&&(x=this.isLabel(B,A))){this.down=this.viz.graph.getNode(x.id)}else{if(!this.dom){this.down=y.getNode()}}this.move=false},onMouseUp:function(A,z,x,y){if(y){return}if(!this.move){this.onClick(x.getNode())}this.down=this.move=false},getRestoredStyles:function(y,x){var A={},z=this["nodeStylesOn"+x];for(var B in z){A[B]=y.styles["$"+B]}return A},toggleStylesOnHover:function(x,y){if(this.nodeStylesOnHover){this.toggleStylesOn("Hover",x,y)}},toggleStylesOnClick:function(x,y){if(this.nodeStylesOnClick){this.toggleStylesOn("Click",x,y)}},toggleStylesOn:function(B,x,D){var E=this.viz;var C=this.nStyles;if(D){var A=this;if(!x.styles){x.styles=d.merge(x.data,{})}for(var F in this["nodeStylesOn"+B]){var y="$"+F;if(!(y in x.styles)){x.styles[y]=x.getData(F)}}E.fx.nodeFx(d.extend({elements:{id:x.id,properties:A["nodeStylesOn"+B]},transition:j.Quart.easeOut,duration:300,fps:40},this.config))}else{var z=this.getRestoredStyles(x,B);E.fx.nodeFx(d.extend({elements:{id:x.id,properties:z},transition:j.Quart.easeOut,duration:300,fps:40},this.config))}},onClick:function(x){if(!x){return}var y=this.nodeStylesOnClick;if(!y){return}if(x.selected){this.toggleStylesOnClick(x,false);delete x.selected}else{this.viz.graph.eachNode(function(A){if(A.selected){for(var z in y){A.setData(z,A.styles["$"+z],"end")}delete A.selected}});this.toggleStylesOnClick(x,true);x.selected=true;delete x.hovered;this.hoveredNode=false}},onMouseMove:function(D,C,A){if(this.down){this.move=true}if(this.dom&&this.isLabel(D,C)){return}var B=this.nodeStylesOnHover;if(!B){return}if(!this.dom){if(this.hoveredNode){var y=this.types[this.hoveredNode.getData("type")];var x=y&&y.contains&&y.contains.call(this.fx,this.hoveredNode,A.getPos());if(x){return}}var z=A.getNode();if(!this.hoveredNode&&!z){return}if(z.hovered){return}if(z&&!z.selected){this.fx.nodeFxAnimation.stopTimer();this.viz.graph.eachNode(function(F){if(F.hovered&&!F.selected){for(var E in B){F.setData(E,F.styles["$"+E],"end")}delete F.hovered}});z.hovered=true;this.hoveredNode=z;this.toggleStylesOnHover(z,true)}else{if(this.hoveredNode&&!this.hoveredNode.selected){this.fx.nodeFxAnimation.stopTimer();this.toggleStylesOnHover(this.hoveredNode,false);delete this.hoveredNode.hovered;this.hoveredNode=false}}}}});p.Classes.Navigation=new r({Implements:[u,i],initializePost:function(){this.pos=false;this.pressed=false},onMouseWheel:function(A,z,x){if(!this.config.zooming){return}d.event.stop(d.event.get(A,z));var B=this.config.zooming/1000,y=1+x*B;this.canvas.scale(y,y)},onMouseDown:function(C,B,A){if(!this.config.panning){return}C.preventDefault?C.preventDefault():C.returnValue=false;d.addClass(this.canvas.getElement(),"grabbing");if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(C,B):(A.getNode()||A.getEdge()))){return}this.pressed=true;this.pos=A.getPos();var z=this.canvas,y=z.translateOffsetX,x=z.translateOffsetY,E=z.scaleOffsetX,D=z.scaleOffsetY;this.pos.x*=E;this.pos.x+=y;this.pos.y*=D;this.pos.y+=x},onMouseMove:function(E,D,G){if(!this.config.panning){return}if(!this.pressed){return}if(this.config.panning=="avoid nodes"&&(this.dom?this.isLabel(E,D):G.getNode())){return}var C=this.pos,F=G.getPos(),A=this.canvas,B=A.translateOffsetX,z=A.translateOffsetY,K=A.scaleOffsetX,I=A.scaleOffsetY;F.x*=K;F.y*=I;F.x+=B;F.y+=z;var J=F.x-C.x,H=F.y-C.y;this.pos=F;this.canvas.translate(J*1/K,H*1/I)},onMouseUp:function(A,z,y,x){if(!this.config.panning){return}d.removeClass(this.canvas.getElement(),"grabbing");this.pressed=false}});var m;(function(){var x=typeof HTMLCanvasElement,z=(x=="object"||x=="function");function y(A,B){var C=document.createElement(A);for(var D in B){if(typeof B[D]=="object"){d.extend(C[D],B[D])}else{C[D]=B[D]}}if(A=="canvas"&&!z&&G_vmlCanvasManager){C=G_vmlCanvasManager.initElement(document.body.appendChild(C))}return C}$jit.Canvas=m=new r({canvases:[],pos:false,element:false,labelContainer:false,translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(M,F){this.viz=M;this.opt=this.config=F;var C=d.type(F.injectInto)=="string"?F.injectInto:F.injectInto.id,L=F.type,D=C+"-label",A=d(C),E=F.width||A.offsetWidth,N=F.height||A.offsetHeight;this.id=C;var G={injectInto:C,width:E,height:N};this.element=y("div",{id:C+"-canvaswidget",style:{position:"relative",width:E+"px",height:N+"px"}});this.labelContainer=this.createLabelContainer(F.Label.type,D,G);this.canvases.push(new m.Base[L]({config:d.extend({idSuffix:"-canvas"},G),plot:function(O){M.fx.plot()},resize:function(){M.refresh()}}));var H=F.background;if(H){var K=new m.Background[H.type](M,d.extend(H,G));this.canvases.push(new m.Base[L](K))}var J=this.canvases.length;while(J--){this.element.appendChild(this.canvases[J].canvas);if(J>0){this.canvases[J].plot()}}this.element.appendChild(this.labelContainer);A.appendChild(this.element);var B=null,I=this;d.addEvent(window,"scroll",function(){clearTimeout(B);B=setTimeout(function(){I.getPos(true)},500)})},getCtx:function(A){return this.canvases[A||0].getCtx()},getConfig:function(){return this.opt},getElement:function(){return this.element},getSize:function(A){return this.canvases[A||0].getSize()},resize:function(E,A){this.getPos(true);this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;for(var C=0,B=this.canvases.length;C<B;C++){this.canvases[C].resize(E,A)}var D=this.element.style;D.width=E+"px";D.height=A+"px";if(this.labelContainer){this.labelContainer.style.width=E+"px"}},translate:function(A,E,D){this.translateOffsetX+=A*this.scaleOffsetX;this.translateOffsetY+=E*this.scaleOffsetY;for(var C=0,B=this.canvases.length;C<B;C++){this.canvases[C].translate(A,E,D)}},scale:function(F,C,D){var G=this.scaleOffsetX*F,E=this.scaleOffsetY*C;var I=this.translateOffsetX*(F-1)/G,H=this.translateOffsetY*(C-1)/E;this.scaleOffsetX=G;this.scaleOffsetY=E;for(var B=0,A=this.canvases.length;B<A;B++){this.canvases[B].scale(F,C,true)}this.translate(I,H,false)},getZoom:function(){return new q(this.scaleOffsetX,this.scaleOffsetY)},setZoom:function(A,F,D){var E=this.getZoom(),C=A/E.x,B=F/E.y;this.scale(C,B,D)},getPos:function(A){if(A||!this.pos){return this.pos=d.getPos(this.getElement())}return this.pos},clear:function(A){this.canvases[A||0].clear()},path:function(B,C){var A=this.canvases[0].getCtx();A.beginPath();C(A);A[B]();A.closePath()},createLabelContainer:function(C,G,F){var E="http://www.w3.org/2000/svg";if(C=="HTML"||C=="Native"){return y("div",{id:G,style:{overflow:"visible",position:"absolute",top:0,left:0,width:F.width+"px",height:0}})}else{if(C=="SVG"){var D=document.createElementNS(E,"svg:svg");D.setAttribute("width",F.width);D.setAttribute("height",F.height);var B=D.style;B.position="absolute";B.left=B.top="0px";var A=document.createElementNS(E,"svg:g");A.setAttribute("width",F.width);A.setAttribute("height",F.height);A.setAttribute("x",0);A.setAttribute("y",0);A.setAttribute("id",G);D.appendChild(A);return D}}}});m.Base={};m.Base["2D"]=new r({translateOffsetX:0,translateOffsetY:0,scaleOffsetX:1,scaleOffsetY:1,initialize:function(A){this.viz=A;this.opt=A.config;this.size=false;this.createCanvas();this.translateToCenter()},createCanvas:function(){var B=this.opt,C=B.width,A=B.height;this.canvas=y("canvas",{id:B.injectInto+B.idSuffix,width:C,height:A,style:{position:"absolute",top:0,left:0,width:C+"px",height:A+"px"}})},getCtx:function(){if(!this.ctx){return this.ctx=this.canvas.getContext("2d")}return this.ctx},getSize:function(){if(this.size){return this.size}var A=this.canvas;return this.size={width:A.width,height:A.height}},translateToCenter:function(D){var B=this.getSize(),C=D?(B.width-D.width-this.translateOffsetX*2):B.width;height=D?(B.height-D.height-this.translateOffsetY*2):B.height;var A=this.getCtx();D&&A.scale(1/this.scaleOffsetX,1/this.scaleOffsetY);A.translate(C/2,height/2)},resize:function(D,A){var C=this.getSize(),B=this.canvas,E=B.style;this.size=false;B.width=D;B.height=A;E.width=D+"px";E.height=A+"px";if(!z){this.translateToCenter(C)}else{this.translateToCenter()}this.translateOffsetX=this.translateOffsetY=0;this.scaleOffsetX=this.scaleOffsetY=1;this.clear();this.viz.resize(D,A,this)},translate:function(A,E,B){var D=this.scaleOffsetX,C=this.scaleOffsetY;this.translateOffsetX+=A*D;this.translateOffsetY+=E*C;this.getCtx().translate(A,E);!B&&this.plot()},scale:function(A,C,B){this.scaleOffsetX*=A;this.scaleOffsetY*=C;this.getCtx().scale(A,C);!B&&this.plot()},clear:function(){var C=this.getSize(),B=this.translateOffsetX,A=this.translateOffsetY,E=this.scaleOffsetX,D=this.scaleOffsetY;this.getCtx().clearRect((-C.width/2-B)*1/E,(-C.height/2-A)*1/D,C.width*1/E,C.height*1/D)},plot:function(){this.clear();this.viz.plot(this)}});m.Background={};m.Background.Circles=new r({initialize:function(A,B){this.viz=A;this.config=d.merge({idSuffix:"-bkcanvas",levelDistance:100,numberOfCircles:6,CanvasStyles:{},offset:0},B)},resize:function(B,A,C){this.plot(C)},plot:function(A){var B=A.canvas,H=A.getCtx(),E=this.config,G=E.CanvasStyles;for(var I in G){H[I]=G[I]}var C=E.numberOfCircles,F=E.levelDistance;for(var D=1;D<=C;D++){H.beginPath();H.arc(0,0,F*D,0,2*Math.PI,false);H.stroke();H.closePath()}}})})();var b=function(y,x){this.theta=y||0;this.rho=x||0};$jit.Polar=b;b.prototype={getc:function(x){return this.toComplex(x)},getp:function(){return this},set:function(x){x=x.getp();this.theta=x.theta;this.rho=x.rho},setc:function(z,A){this.rho=Math.sqrt(z*z+A*A);this.theta=Math.atan2(A,z);if(this.theta<0){this.theta+=Math.PI*2}},setp:function(y,x){this.theta=y;this.rho=x},clone:function(){return new b(this.theta,this.rho)},toComplex:function(B){var z=Math.cos(this.theta)*this.rho;var A=Math.sin(this.theta)*this.rho;if(B){return{x:z,y:A}}return new q(z,A)},add:function(x){return new b(this.theta+x.theta,this.rho+x.rho)},scale:function(x){return new b(this.theta,this.rho*x)},equals:function(x){return this.theta==x.theta&&this.rho==x.rho},$add:function(x){this.theta=this.theta+x.theta;this.rho+=x.rho;return this},$madd:function(x){this.theta=(this.theta+x.theta)%(Math.PI*2);this.rho+=x.rho;return this},$scale:function(x){this.rho*=x;return this},isZero:function(){var y=0.0001,x=Math.abs;return x(this.theta)<y&&x(this.rho)<y},interpolate:function(z,G){var A=Math.PI,D=A*2;var y=function(I){var H=(I<0)?(I%D)+D:I%D;return H};var C=this.theta,F=z.theta;var B,E=Math.abs(C-F);if(E==A){if(C>F){B=y((F+((C-D)-F)*G))}else{B=y((F-D+(C-(F))*G))}}else{if(E>=A){if(C>F){B=y((F+((C-D)-F)*G))}else{B=y((F-D+(C-(F-D))*G))}}else{B=y((F+(C-F)*G))}}var x=(this.rho-z.rho)*G+z.rho;return{theta:B,rho:x}}};var l=function(y,x){return new b(y,x)};b.KER=l(0,0);var q=function(z,A){this.x=z||0;this.y=A||0};$jit.Complex=q;q.prototype={getc:function(){return this},getp:function(x){return this.toPolar(x)},set:function(x){x=x.getc(true);this.x=x.x;this.y=x.y},setc:function(z,A){this.x=z;this.y=A},setp:function(y,x){this.x=Math.cos(y)*x;this.y=Math.sin(y)*x},clone:function(){return new q(this.x,this.y)},toPolar:function(z){var x=this.norm();var y=Math.atan2(this.y,this.x);if(y<0){y+=Math.PI*2}if(z){return{theta:y,rho:x}}return new b(y,x)},norm:function(){return Math.sqrt(this.squaredNorm())},squaredNorm:function(){return this.x*this.x+this.y*this.y},add:function(x){return new q(this.x+x.x,this.y+x.y)},prod:function(x){return new q(this.x*x.x-this.y*x.y,this.y*x.x+this.x*x.y)},conjugate:function(){return new q(this.x,-this.y)},scale:function(x){return new q(this.x*x,this.y*x)},equals:function(x){return this.x==x.x&&this.y==x.y},$add:function(x){this.x+=x.x;this.y+=x.y;return this},$prod:function(B){var z=this.x,A=this.y;this.x=z*B.x-A*B.y;this.y=A*B.x+z*B.y;return this},$conjugate:function(){this.y=-this.y;return this},$scale:function(x){this.x*=x;this.y*=x;return this},$div:function(C){var z=this.x,B=this.y;var A=C.squaredNorm();this.x=z*C.x+B*C.y;this.y=B*C.x-z*C.y;return this.$scale(1/A)},isZero:function(){var y=0.0001,x=Math.abs;return x(this.x)<y&&x(this.y)<y}};var s=function(y,x){return new q(y,x)};q.KER=s(0,0);q.IM=s(0,1);$jit.Graph=new r({initialize:function(z,y,x,D){var B={klass:q,Node:{}};this.Node=y;this.Edge=x;this.Label=D;this.opt=d.merge(B,z||{});this.nodes={};this.edges={};var A=this;this.nodeList={};for(var C in k){A.nodeList[C]=(function(E){return function(){var F=Array.prototype.slice.call(arguments);A.eachNode(function(G){G[E].apply(G,F)})}})(C)}},getNode:function(x){if(this.hasNode(x)){return this.nodes[x]}return false},get:function(x){return this.getNode(x)},getByName:function(x){for(var z in this.nodes){var y=this.nodes[z];if(y.name==x){return y}}return false},getAdjacence:function(y,x){if(y in this.edges){return this.edges[y][x]}return false},addNode:function(y){if(!this.nodes[y.id]){var x=this.edges[y.id]={};this.nodes[y.id]=new f.Node(d.extend({id:y.id,name:y.name,data:d.merge(y.data||{},{}),adjacencies:x},this.opt.Node),this.opt.klass,this.Node,this.Edge,this.Label)}return this.nodes[y.id]},addAdjacence:function(A,z,y){if(!this.hasNode(A.id)){this.addNode(A)}if(!this.hasNode(z.id)){this.addNode(z)}A=this.nodes[A.id];z=this.nodes[z.id];if(!A.adjacentTo(z)){var B=this.edges[A.id]=this.edges[A.id]||{};var x=this.edges[z.id]=this.edges[z.id]||{};B[z.id]=x[A.id]=new f.Adjacence(A,z,y,this.Edge,this.Label);return B[z.id]}return this.edges[A.id][z.id]},removeNode:function(z){if(this.hasNode(z)){delete this.nodes[z];var y=this.edges[z];for(var x in y){delete this.edges[x][z]}delete this.edges[z]}},removeAdjacence:function(y,x){delete this.edges[y][x];delete this.edges[x][y]},hasNode:function(x){return x in this.nodes},empty:function(){this.nodes={};this.edges={}}});var f=$jit.Graph;var k;(function(){var x=function(E,G,B,D,F){var C;B=B||"current";E="$"+(E?E+"-":"");if(B=="current"){C=this.data}else{if(B=="start"){C=this.startData}else{if(B=="end"){C=this.endData}}}var A=E+G;if(D){return C[A]}if(!this.Config.overridable){return F[G]||0}return(A in C)?C[A]:((A in this.data)?this.data[A]:(F[G]||0))};var z=function(D,E,C,A){A=A||"current";D="$"+(D?D+"-":"");var B;if(A=="current"){B=this.data}else{if(A=="start"){B=this.startData}else{if(A=="end"){B=this.endData}}}B[D+E]=C};var y=function(C,A){C="$"+(C?C+"-":"");var B=this;d.each(A,function(E){var D=C+E;delete B.data[D];delete B.endData[D];delete B.startData[D]})};k={getData:function(C,A,B){return x.call(this,"",C,A,B,this.Config)},setData:function(C,B,A){z.call(this,"",C,B,A)},setDataset:function(D,E){D=d.splat(D);for(var A in E){for(var C=0,F=d.splat(E[A]),B=D.length;C<B;C++){this.setData(A,F[C],D[C])}}},removeData:function(){y.call(this,"",Array.prototype.slice.call(arguments))},getCanvasStyle:function(C,A,B){return x.call(this,"canvas",C,A,B,this.Config.CanvasStyles)},setCanvasStyle:function(C,B,A){z.call(this,"canvas",C,B,A)},setCanvasStyles:function(D,E){D=d.splat(D);for(var A in E){for(var C=0,F=d.splat(E[A]),B=D.length;C<B;C++){this.setCanvasStyle(A,F[C],D[C])}}},removeCanvasStyle:function(){y.call(this,"canvas",Array.prototype.slice.call(arguments))},getLabelData:function(C,A,B){return x.call(this,"label",C,A,B,this.Label)},setLabelData:function(C,B,A){z.call(this,"label",C,B,A)},setLabelDataset:function(D,E){D=d.splat(D);for(var A in E){for(var C=0,F=d.splat(E[A]),B=D.length;C<B;C++){this.setLabelData(A,F[C],D[C])}}},removeLabelData:function(){y.call(this,"label",Array.prototype.slice.call(arguments))}}})();f.Node=new r({initialize:function(A,x,z,y,C){var B={id:"",name:"",data:{},startData:{},endData:{},adjacencies:{},selected:false,drawn:false,exist:false,angleSpan:{begin:0,end:0},pos:new x,startPos:new x,endPos:new x};d.extend(this,d.extend(B,A));this.Config=this.Node=z;this.Edge=y;this.Label=C},adjacentTo:function(x){return x.id in this.adjacencies},adjacentWithDirectionTo:function(x){var y=x.id in this.adjacencies;if(!y){return false}var z=this.adjacencies[x.id].data.$direction;return z[0]===this.id},getAdjacency:function(x){return this.adjacencies[x]},getPos:function(x){x=x||"current";if(x=="current"){return this.pos}else{if(x=="end"){return this.endPos}else{if(x=="start"){return this.startPos}}}},setPos:function(y,x){x=x||"current";var z;if(x=="current"){z=this.pos}else{if(x=="end"){z=this.endPos}else{if(x=="start"){z=this.startPos}}}z.set(y)}});f.Node.implement(k);f.Adjacence=new r({initialize:function(y,B,z,x,A){this.nodeFrom=y;this.nodeTo=B;this.data=z||{};this.startData={};this.endData={};this.Config=this.Edge=x;this.Label=A}});f.Adjacence.implement(k);f.Util={filter:function(y){if(!y||!(d.type(y)=="string")){return function(){return true}}var x=y.split(" ");return function(A){for(var z=0;z<x.length;z++){if(A[x[z]]){return false}}return true}},getNode:function(x,y){return x.nodes[y]},eachNode:function(B,A,x){var z=this.filter(x);for(var y in B.nodes){if(z(B.nodes[y])){A(B.nodes[y])}}},each:function(z,y,x){this.eachNode(z,y,x)},eachAdjacency:function(C,D,y){var z=C.adjacencies,B=this.filter(y);for(var E in z){var x=z[E];if(B(x)){if(x.nodeFrom!=C){var A=x.nodeFrom;x.nodeFrom=x.nodeTo;x.nodeTo=A}D(x,E)}}},computeLevels:function(D,E,A,z){A=A||0;var B=this.filter(z);this.eachNode(D,function(F){F._flag=false;F._depth=-1},z);var y=D.getNode(E);y._depth=A;var x=[y];while(x.length!=0){var C=x.pop();C._flag=true;this.eachAdjacency(C,function(F){var G=F.nodeTo;if(G._flag==false&&B(G)&&!F._hiding){if(G._depth<0){G._depth=C._depth+1+A}x.unshift(G)}},z)}},eachBFS:function(C,D,B,y){var z=this.filter(y);this.clean(C);var x=[C.getNode(D)];while(x.length!=0){var A=x.pop();if(!A){return}A._flag=true;B(A,A._depth);this.eachAdjacency(A,function(E){var F=E.nodeTo;if(F._flag==false&&z(F)&&!E._hiding){F._flag=true;x.unshift(F)}},y)}},eachLevel:function(B,G,y,C,A){var F=B._depth,x=this.filter(A),D=this,E=true;y=y===false?Number.MAX_VALUE-F:y;(function z(K,H,I){if(!E){return}var L=K._depth,J;if(L>=H&&L<=I&&x(K)){J=C(K,L)}if(typeof J!=="undefined"){E=J}if(E&&L<I){D.eachAdjacency(K,function(M){var N=M.nodeTo;if(N._depth>L){z(N,H,I)}})}})(B,G+F,y+F)},eachSubgraph:function(y,z,x){this.eachLevel(y,0,false,z,x)},eachSubnode:function(y,z,x){this.eachLevel(y,1,1,z,x)},anySubnode:function(A,z,y){var x=false;z=z||d.lambda(true);var B=d.type(z)=="string"?function(C){return C[z]}:z;this.eachSubnode(A,function(C){if(B(C)){x=true}},y);return x},getSubnodes:function(C,D,x){var z=[],B=this;D=D||0;var A,y;if(d.type(D)=="array"){A=D[0];y=D[1]}else{A=D;y=Number.MAX_VALUE-C._depth}this.eachLevel(C,A,y,function(E){z.push(E)},x);return z},getParents:function(y){var x=[];this.eachAdjacency(y,function(z){var A=z.nodeTo;if(A._depth<y._depth){x.push(A)}});return x},isDescendantOf:function(A,B){if(A.id==B){return true}var z=this.getParents(A),x=false;for(var y=0;!x&&y<z.length;y++){x=x||this.isDescendantOf(z[y],B)}return x},clean:function(x){this.eachNode(x,function(y){y._flag=false})},getClosestNodeToOrigin:function(y,z,x){return this.getClosestNodeToPos(y,b.KER,z,x)},getClosestNodeToPos:function(z,C,B,x){var y=null;B=B||"current";C=C&&C.getc(true)||q.KER;var A=function(E,D){var G=E.x-D.x,F=E.y-D.y;return G*G+F*F};this.eachNode(z,function(D){y=(y==null||A(D.getPos(B).getc(true),C)<A(y.getPos(B).getc(true),C))?D:y},x);return y}};d.each(["get","getNode","each","eachNode","computeLevels","eachBFS","clean","getClosestNodeToPos","getClosestNodeToOrigin"],function(x){f.prototype[x]=function(){return f.Util[x].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}});d.each(["eachAdjacency","eachLevel","eachSubgraph","eachSubnode","anySubnode","getSubnodes","getParents","isDescendantOf"],function(x){f.Node.prototype[x]=function(){return f.Util[x].apply(f.Util,[this].concat(Array.prototype.slice.call(arguments)))}});f.Op={options:{type:"nothing",duration:2000,hideLabels:true,fps:30},initialize:function(x){this.viz=x},removeNode:function(C,A){var x=this.viz;var y=d.merge(this.options,x.controller,A);var E=d.splat(C);var z,B,D;switch(y.type){case"nothing":for(z=0;z<E.length;z++){y.onBeforeRemoveNode(x.graph.getNode(E[z]));x.graph.removeNode(E[z])}break;case"replot":this.removeNode(E,{type:"nothing"});x.labels.clearLabels();x.refresh(true);break;case"fade:seq":case"fade":B=this;for(z=0;z<E.length;z++){D=x.graph.getNode(E[z]);D.setData("alpha",0,"end")}x.fx.animate(d.merge(y,{modes:["node-property:alpha"],onComplete:function(){B.removeNode(E,{type:"nothing"});x.labels.clearLabels();x.reposition();x.fx.animate(d.merge(y,{modes:["linear"]}))}}));break;case"fade:con":B=this;for(z=0;z<E.length;z++){D=x.graph.getNode(E[z]);D.setData("alpha",0,"end");D.ignore=true}x.reposition();x.fx.animate(d.merge(y,{modes:["node-property:alpha","linear"],onComplete:function(){B.removeNode(E,{type:"nothing"});y.onComplete&&y.onComplete()}}));break;case"iter":B=this;x.fx.sequence({condition:function(){return E.length!=0},step:function(){B.removeNode(E.shift(),{type:"nothing"});x.labels.clearLabels()},onComplete:function(){y.onComplete&&y.onComplete()},duration:Math.ceil(y.duration/E.length)});break;default:this.doError()}},removeEdge:function(E,C){var x=this.viz;var A=d.merge(this.options,x.controller,C);var z=(d.type(E[0])=="string")?[E]:E;var B,D,y;switch(A.type){case"nothing":for(B=0;B<z.length;B++){x.graph.removeAdjacence(z[B][0],z[B][1])}break;case"replot":this.removeEdge(z,{type:"nothing"});x.refresh(true);break;case"fade:seq":case"fade":D=this;for(B=0;B<z.length;B++){y=x.graph.getAdjacence(z[B][0],z[B][1]);if(y){y.setData("alpha",0,"end")}}x.fx.animate(d.merge(A,{modes:["edge-property:alpha"],onComplete:function(){D.removeEdge(z,{type:"nothing"});x.reposition();x.fx.animate(d.merge(A,{modes:["linear"]}))}}));break;case"fade:con":D=this;for(B=0;B<z.length;B++){y=x.graph.getAdjacence(z[B][0],z[B][1]);if(y){y.setData("alpha",0,"end");y.ignore=true}}x.reposition();x.fx.animate(d.merge(A,{modes:["edge-property:alpha","linear"],onComplete:function(){D.removeEdge(z,{type:"nothing"});A.onComplete&&A.onComplete()}}));break;case"iter":D=this;x.fx.sequence({condition:function(){return z.length!=0},step:function(){D.removeEdge(z.shift(),{type:"nothing"});x.labels.clearLabels()},onComplete:function(){A.onComplete()},duration:Math.ceil(A.duration/z.length)});break;default:this.doError()}},sum:function(B,A){var x=this.viz;var z=d.merge(this.options,x.controller,A),y=x.root;var D;x.root=A.id||x.root;switch(z.type){case"nothing":D=x.construct(B);D.eachNode(function(F){F.eachAdjacency(function(G){x.graph.addAdjacence(G.nodeFrom,G.nodeTo,G.data)})});break;case"replot":x.refresh(true);this.sum(B,{type:"nothing"});x.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;D=x.construct(B);var E=this.preprocessSum(D);var C=!E?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];x.reposition();if(z.type!="fade:con"){x.fx.animate(d.merge(z,{modes:["linear"],onComplete:function(){x.fx.animate(d.merge(z,{modes:C,onComplete:function(){z.onComplete()}}))}}))}else{x.graph.eachNode(function(F){if(F.id!=y&&F.pos.isZero()){F.pos.set(F.endPos);F.startPos.set(F.endPos)}});x.fx.animate(d.merge(z,{modes:["linear"].concat(C)}))}break;default:this.doError()}},morph:function(F,y,A){A=A||{};var C=this.viz;var G=d.merge(this.options,C.controller,y),B=C.root;var D;C.root=y.id||C.root;switch(G.type){case"nothing":D=C.construct(F);D.eachNode(function(J){var I=C.graph.hasNode(J.id);J.eachAdjacency(function(N){var M=!!C.graph.getAdjacence(N.nodeFrom.id,N.nodeTo.id);C.graph.addAdjacence(N.nodeFrom,N.nodeTo,N.data);if(M){var L=C.graph.getAdjacence(N.nodeFrom.id,N.nodeTo.id);for(var O in (N.data||{})){L.data[O]=N.data[O]}}});if(I){var H=C.graph.getNode(J.id);for(var K in (J.data||{})){H.data[K]=J.data[K]}}});C.graph.eachNode(function(H){H.eachAdjacency(function(I){if(!D.getAdjacence(I.nodeFrom.id,I.nodeTo.id)){C.graph.removeAdjacence(I.nodeFrom.id,I.nodeTo.id)}});if(!D.hasNode(H.id)){C.graph.removeNode(H.id)}});break;case"replot":C.labels.clearLabels(true);this.morph(F,{type:"nothing"});C.refresh(true);C.refresh(true);break;case"fade:seq":case"fade":case"fade:con":that=this;D=C.construct(F);var E=("node-property" in A)&&d.map(d.splat(A["node-property"]),function(H){return"$"+H});C.graph.eachNode(function(I){var J=D.getNode(I.id);if(!J){I.setData("alpha",1);I.setData("alpha",1,"start");I.setData("alpha",0,"end");I.ignore=true}else{var H=J.data;for(var K in H){if(E&&(d.indexOf(E,K)>-1)){I.endData[K]=H[K]}else{I.data[K]=H[K]}}}});C.graph.eachNode(function(H){if(H.ignore){return}H.eachAdjacency(function(I){if(I.nodeFrom.ignore||I.nodeTo.ignore){return}var J=D.getNode(I.nodeFrom.id);var K=D.getNode(I.nodeTo.id);if(!J.adjacentTo(K)){var I=C.graph.getAdjacence(J.id,K.id);x=true;I.setData("alpha",1);I.setData("alpha",1,"start");I.setData("alpha",0,"end");I._hiding=true}else{if(I.data.$direction&&I.data.$direction[0]===J.id){if(!J.adjacentWithDirectionTo(K)){I._reversing=true}}}})});var x=this.preprocessSum(D);var z=!x?["node-property:alpha"]:["node-property:alpha","edge-property:alpha"];z[0]=z[0]+(("node-property" in A)?(":"+d.splat(A["node-property"]).join(":")):"");z[1]=(z[1]||"edge-property:alpha")+(("edge-property" in A)?(":"+d.splat(A["edge-property"]).join(":")):"");if("label-property" in A){z.push("label-property:"+d.splat(A["label-property"]).join(":"))}if(C.reposition){C.reposition()}else{C.compute("end")}this._updateDirectedEdges();C.graph.eachNode(function(H){if(H.id!=B&&H.pos.getp().equals(b.KER)){H.pos.set(H.endPos);H.startPos.set(H.endPos)}});C.fx.animate(d.merge(G,{modes:[A.position||"polar"].concat(z),onComplete:function(){C.graph.eachNode(function(H){if(H.ignore){C.graph.removeNode(H.id)}});C.graph.eachNode(function(H){H.eachAdjacency(function(I){if(I.ignore){C.graph.removeAdjacence(I.nodeFrom.id,I.nodeTo.id)}})});G.onComplete()}}));break;default:}},_updateDirectedEdges:function(){var x=this.viz.graph;x.eachNode(function(y){y.eachAdjacency(function(B){var C=B.data.$direction;if(C&&B.nodeFrom.id!==B.data.$direction[0]){return}if(B._hiding){x.removeAdjacence(B.nodeFrom.id,B.nodeTo.id)}if(B._reversing){var E=B.nodeFrom.id;var D=B.nodeTo.id;var A=x.edges[E][D];var z=x.edges[D][E];A.data.$direction=[D,E];z.data.$direction=[D,E];B._reversing=undefined}})})},contract:function(z,y){var x=this.viz;if(z.collapsed||!z.anySubnode(d.lambda(true))){return}y=d.merge(this.options,x.config,y||{},{modes:["node-property:alpha:span","linear"]});z.collapsed=true;(function A(B){B.eachSubnode(function(C){C.ignore=true;C.setData("alpha",0,y.type=="animate"?"end":"current");A(C)})})(z);if(y.type=="animate"){x.compute("end");if(x.rotated){x.rotate(x.rotated,"none",{property:"end"})}(function A(B){B.eachSubnode(function(C){C.setPos(z.getPos("end"),"end");A(C)})})(z);x.fx.animate(y)}else{if(y.type=="replot"){x.refresh()}}},expand:function(z,y){if(!("collapsed" in z)){return}var x=this.viz;y=d.merge(this.options,x.config,y||{},{modes:["node-property:alpha:span","linear"]});delete z.collapsed;(function A(B){B.eachSubnode(function(C){delete C.ignore;C.setData("alpha",1,y.type=="animate"?"end":"current");A(C)})})(z);if(y.type=="animate"){x.compute("end");if(x.rotated){x.rotate(x.rotated,"none",{property:"end"})}x.fx.animate(y)}else{if(y.type=="replot"){x.refresh()}}},preprocessSum:function(y){var x=this.viz;y.eachNode(function(A){if(!x.graph.hasNode(A.id)){x.graph.addNode(A);var B=x.graph.getNode(A.id);B.setData("alpha",0);B.setData("alpha",0,"start");B.setData("alpha",1,"end")}});var z=false;y.eachNode(function(A){A.eachAdjacency(function(B){var C=x.graph.getNode(B.nodeFrom.id);var D=x.graph.getNode(B.nodeTo.id);if(!C.adjacentTo(D)){var B=x.graph.addAdjacence(C,D,B.data);if(C.startAlpha==C.endAlpha&&D.startAlpha==D.endAlpha){z=true;B.setData("alpha",0);B.setData("alpha",0,"start");B.setData("alpha",1,"end")}}})});return z}};var a={none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(A,B,x,z){var y=z.getCtx();y.beginPath();y.arc(B.x,B.y,x,0,Math.PI*2,true);y.closePath();y[A]()},contains:function(C,B,x){var z=C.x-B.x,y=C.y-B.y,A=z*z+y*y;return A<=x*x}},ellipse:{render:function(D,F,x,G,y){var H=y.getCtx(),A=1,z=1,E=1,C=1,B=0;if(x>G){B=x/2;z=G/x;C=x/G}else{B=G/2;A=x/G;E=G/x}H.save();H.scale(A,z);H.beginPath();H.arc(F.x*E,F.y*C,B,0,Math.PI*2,true);H.closePath();H[D]();H.restore()},contains:function(x,E,y,G){var D=0,C=1,B=1,A=0,z=0,F=0;if(y>G){D=y/2;B=G/y}else{D=G/2;C=y/G}A=(x.x-E.x)*(1/C);z=(x.y-E.y)*(1/B);F=A*A+z*z;return F<=D*D}},square:{render:function(y,A,z,x){x.getCtx()[y+"Rect"](A.x-z,A.y-z,2*z,2*z)},contains:function(z,y,x){return Math.abs(y.x-z.x)<=x&&Math.abs(y.y-z.y)<=x}},rectangle:{render:function(A,B,z,x,y){y.getCtx()[A+"Rect"](B.x-z/2,B.y-x/2,z,x)},contains:function(A,z,y,x){return Math.abs(z.x-A.x)<=y/2&&Math.abs(z.y-A.y)<=x/2}},triangle:{render:function(D,E,A,x){var H=x.getCtx(),z=E.x,y=E.y-A,G=z-A,F=E.y+A,C=z+A,B=F;H.beginPath();H.moveTo(z,y);H.lineTo(G,F);H.lineTo(C,B);H.closePath();H[D]()},contains:function(z,y,x){return a.circle.contains(z,y,x)}},star:{render:function(B,D,C,y){var x=y.getCtx(),A=Math.PI/5;x.save();x.translate(D.x,D.y);x.beginPath();x.moveTo(C,0);for(var z=0;z<9;z++){x.rotate(A);if(z%2==0){x.lineTo((C/0.525731)*0.200811,0)}else{x.lineTo(C,0)}}x.closePath();x[B]();x.restore()},contains:function(z,y,x){return a.circle.contains(z,y,x)}}};var n={line:{render:function(A,z,y){var x=y.getCtx();x.beginPath();x.moveTo(A.x,A.y);x.lineTo(z.x,z.y);x.stroke()},contains:function(H,z,C,F){var A=Math.min,D=Math.max,y=A(H.x,z.x)-F,G=D(H.x,z.x)+F,x=A(H.y,z.y)-F,E=D(H.y,z.y)+F;if(C.x>=y&&C.x<=G&&C.y>=x&&C.y<=E){if(Math.abs(z.x-H.x)<=F){return true}var B=(z.y-H.y)/(z.x-H.x)*(C.x-H.x)+H.y;return Math.abs(B-C.y)<=F}return false}},arrow:{render:function(J,K,B,y,x,z){var L=x.getCtx();if(y){var A=J;J=K;K=A}var E=new q(K.x-J.x,K.y-J.y);E.$scale(B/E.norm());var H;switch(z){case"end":H=E;break;case"center":H=new q((K.x-J.x)/2,(K.y-J.y)/2);break}var C=new q(K.x-H.x,K.y-H.y),D=new q(-E.y/2,E.x/2),F=C.add(E),I=C.add(D),G=C.$add(D.$scale(-1));L.beginPath();L.moveTo(J.x,J.y);L.lineTo(K.x,K.y);L.stroke();L.beginPath();L.moveTo(I.x,I.y);L.moveTo(I.x,I.y);L.lineTo(G.x,G.y);L.lineTo(F.x,F.y);L.closePath();L.fill()},contains:function(y,x,A,z){return n.line.contains(y,x,A,z)}},hyperline:{render:function(E,F,x,z){var G=z.getCtx();var A=B(E,F);if(A.a>1000||A.b>1000||A.ratio<0){G.beginPath();G.moveTo(E.x*x,E.y*x);G.lineTo(F.x*x,F.y*x);G.stroke()}else{var D=Math.atan2(F.y-A.y,F.x-A.x);var C=Math.atan2(E.y-A.y,E.x-A.x);var y=y(D,C);G.beginPath();G.arc(A.x*x,A.y*x,A.ratio*x,D,C,y);G.stroke()}function B(T,S){var L=(T.x*S.y-T.y*S.x),H=L;var K=T.squaredNorm(),J=S.squaredNorm();if(L==0){return{x:0,y:0,ratio:-1}}var R=(T.y*J-S.y*K+T.y-S.y)/L;var P=(S.x*K-T.x*J+S.x-T.x)/H;var Q=-R/2;var O=-P/2;var N=(R*R+P*P)/4-1;if(N<0){return{x:0,y:0,ratio:-1}}var M=Math.sqrt(N);var I={x:Q,y:O,ratio:M>1000?-1:M,a:R,b:P};return I}function y(H,I){return(H<I)?((H+Math.PI>I)?false:true):((I+Math.PI>H)?true:false)}},contains:d.lambda(false)}};f.Plot={initialize:function(y,x){this.viz=y;this.config=y.config;this.node=y.config.Node;this.edge=y.config.Edge;this.animation=new v;this.nodeTypes=new x.Plot.NodeTypes;this.edgeTypes=new x.Plot.EdgeTypes;this.labels=y.labels},nodeHelper:a,edgeHelper:n,Interpolator:{map:{border:"color",color:"color",width:"number",height:"number",dim:"number",alpha:"number",lineWidth:"number",angularWidth:"number",span:"number",valueArray:"array-number",dimArray:"array-number",vertices:"polygon"},canvas:{globalAlpha:"number",fillStyle:"color",strokeStyle:"color",lineWidth:"number",shadowBlur:"number",shadowColor:"color",shadowOffsetX:"number",shadowOffsetY:"number",miterLimit:"number"},label:{size:"number",color:"color"},compute:function(z,y,x){return z+(y-z)*x},moebius:function(E,D,G,A){var C=A.scale(-G);if(C.norm()<1){var z=C.x,F=C.y;var B=E.startPos.getc().moebiusTransformation(C);E.pos.setc(B.x,B.y);C.x=z;C.y=F}},linear:function(y,x,B){var A=y.startPos.getc(true);var z=y.endPos.getc(true);y.pos.setc(this.compute(A.x,z.x,B),this.compute(A.y,z.y,B))},polar:function(z,y,C){var B=z.startPos.getp(true);var A=z.endPos.getp();var x=A.interpolate(B,C);z.pos.setp(x.theta,x.rho)},number:function(y,D,C,x,B){var A=y[x](D,"start");var z=y[x](D,"end");y[B](D,this.compute(A,z,C))},color:function(z,x,F,C,A){var D=d.hexToRgb(z[C](x,"start"));var E=d.hexToRgb(z[C](x,"end"));var B=this.compute;var y=d.rgbToHex([parseInt(B(D[0],E[0],F)),parseInt(B(D[1],E[1],F)),parseInt(B(D[2],E[2],F))]);z[A](x,y)},"array-number":function(A,z,K,H,C){var I=A[H](z,"start"),J=A[H](z,"end"),L=[];for(var F=0,B=I.length;F<B;F++){var y=I[F],x=J[F];if(y.length){for(var E=0,G=y.length,D=[];E<G;E++){D.push(this.compute(y[E],x[E],K))}L.push(D)}else{L.push(this.compute(y,x,K))}}A[C](z,L)},node:function(y,D,F,x,E,z){x=this[x];if(D){var C=D.length;for(var A=0;A<C;A++){var B=D[A];this[x[B]](y,B,F,E,z)}}else{for(var B in x){this[x[B]](y,B,F,E,z)}}},edge:function(z,y,E,A,x,D){var C=z.adjacencies;for(var B in C){this["node"](C[B],y,E,A,x,D)}},"node-property":function(y,x,z){this["node"](y,x,z,"map","getData","setData")},"edge-property":function(y,x,z){this["edge"](y,x,z,"map","getData","setData")},"label-property":function(y,x,z){this["node"](y,x,z,"label","getLabelData","setLabelData")},"node-style":function(y,x,z){this["node"](y,x,z,"canvas","getCanvasStyle","setCanvasStyle")},"edge-style":function(y,x,z){this["edge"](y,x,z,"canvas","getCanvasStyle","setCanvasStyle")},polygon:function(A,z,K,G,C){var I=A[G](z,"start"),J=A[G](z,"end"),L=[];if(typeof I.offset=="undefined"){if(I===0){I=d.map(J,function(){return new $jit.Complex(0,0)});I.offset=0}else{if(I.length==0){I.push(new $jit.Complex(0,0))}while(I.length<J.length){I.push(I[0])}while(I.length>J.length){J.push(J[0]||new $jit.Complex(0,0))}if(I.length==0){return}var B=I.length;var H=1e+300;for(var D=0;D<B;D++){var F=0;for(var E=0;E<B;E++){F+=Geometry.dist2(I[(D+E)%B],J[E])}if(F<H){I.offset=D;H=F}}}}for(var E=0,B=I.length;E<B;E++){var y=I[(E+I.offset)%B],x=J[E];L.push(new $jit.Complex(this.compute(y.x,x.x,K),this.compute(y.y,x.y,K)))}A[C](z,L)}},sequence:function(y){var z=this;y=d.merge({condition:d.lambda(false),step:d.empty,onComplete:d.empty,duration:200},y||{});var x=setInterval(function(){if(y.condition()){y.step()}else{clearInterval(x);y.onComplete()}z.viz.refresh(true)},y.duration)},prepare:function(D){var C=this.viz.graph,A={"node-property":{getter:"getData",setter:"setData"},"edge-property":{getter:"getData",setter:"setData"},"node-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"},"edge-style":{getter:"getCanvasStyle",setter:"setCanvasStyle"}};var y={};if(d.type(D)=="array"){for(var B=0,x=D.length;B<x;B++){var z=D[B].split(":");y[z.shift()]=z}}else{for(var E in D){if(E=="position"){y[D.position]=[]}else{y[E]=d.splat(D[E])}}}C.eachNode(function(F){F.startPos.set(F.pos);d.each(["node-property","node-style"],function(I){if(I in y){var J=y[I];for(var H=0,G=J.length;H<G;H++){F[A[I].setter](J[H],F[A[I].getter](J[H]),"start")}}});d.each(["edge-property","edge-style"],function(G){if(G in y){var H=y[G];F.eachAdjacency(function(J){for(var K=0,I=H.length;K<I;K++){J[A[G].setter](H[K],J[A[G].getter](H[K]),"start")}})}})});return y},animate:function(A,z){A=d.merge(this.viz.config,A||{});var B=this,y=this.viz,D=y.graph,E=this.Interpolator,C=A.type==="nodefx"?this.nodeFxAnimation:this.animation;var x=this.prepare(A.modes);if(A.hideLabels){this.labels.hideLabels(true)}C.setOptions(d.extend(A,{$animating:false,compute:function(F){D.eachNode(function(G){for(var H in x){E[H](G,x[H],F,z)}});B.plot(A,this.$animating,F);this.$animating=true},complete:function(){if(A.hideLabels){B.labels.hideLabels(false)}B.plot(A);A.onComplete()}})).start()},nodeFx:function(z){if(this.nodeFxAnimation==undefined){this.nodeFxAnimation=new v()}var E=this.viz,F=E.graph,C=this.nodeFxAnimation,G=d.merge(this.viz.config,{elements:{id:false,properties:{}},reposition:false});z=d.merge(G,z||{},{onBeforeCompute:d.empty,onAfterCompute:d.empty});C.stopTimer();var D=z.elements.properties;if(!z.elements.id){F.eachNode(function(I){for(var H in D){I.setData(H,D[H],"end")}})}else{var x=d.splat(z.elements.id);d.each(x,function(J){var I=F.getNode(J);if(I){for(var H in D){I.setData(H,D[H],"end")}}})}var B=[];for(var y in D){B.push(y)}var A=["node-property:"+B.join(":")];if(z.reposition){A.push("linear");E.compute("end")}this.animate(d.merge(z,{modes:A,type:"nodefx"}))},plot:function(y,H){var F=this.viz,C=F.graph,z=F.canvas,x=F.root,D=this,G=z.getCtx(),B=Math.min,y=y||this.viz.controller;y.clearCanvas&&z.clear();var E=C.getNode(x);if(!E){return}var A=!!E.visited;C.eachNode(function(J){var I=J.getData("alpha");J.eachAdjacency(function(K){var L=K.nodeTo;if(!!L.visited===A&&J.drawn&&L.drawn){!H&&y.onBeforePlotLine(K);D.plotLine(K,z,H);!H&&y.onAfterPlotLine(K)}});if(J.drawn){!H&&y.onBeforePlotNode(J);D.plotNode(J,z,H);!H&&y.onAfterPlotNode(J)}if(!D.labelsHidden&&y.withLabels){if(J.drawn&&I>=0.95){D.labels.plotLabel(z,J,y)}else{D.labels.hideLabel(J,false)}}J.visited=!A})},plotTree:function(B,y,F){var C=this,D=this.viz,z=D.canvas,A=this.config,E=z.getCtx();var x=B.getData("alpha");B.eachSubnode(function(H){if(y.plotSubtree(B,H)&&H.exist&&H.drawn){var G=B.getAdjacency(H.id);!F&&y.onBeforePlotLine(G);C.plotLine(G,z,F);!F&&y.onAfterPlotLine(G);C.plotTree(H,y,F)}});if(B.drawn){!F&&y.onBeforePlotNode(B);this.plotNode(B,z,F);!F&&y.onAfterPlotNode(B);if(!y.hideLabels&&y.withLabels&&x>=0.95){this.labels.plotLabel(z,B,y)}else{this.labels.hideLabel(B,false)}}else{this.labels.hideLabel(B,true)}},plotNode:function(z,y,G){var D=z.getData("type"),C=this.node.CanvasStyles;if(D!="none"){var x=z.getData("lineWidth"),B=z.getData("color"),A=z.getData("alpha"),E=y.getCtx();E.save();E.lineWidth=x;E.fillStyle=E.strokeStyle=B;E.globalAlpha=A;for(var F in C){E[F]=z.getCanvasStyle(F)}this.nodeTypes[D].render.call(this,z,y,G);E.restore()}},plotLine:function(D,y,H){var C=D.getData("type"),A=this.edge.CanvasStyles;if(C!="none"){var x=D.getData("lineWidth"),z=D.getData("color"),F=y.getCtx(),B=D.nodeFrom,E=D.nodeTo;F.save();F.lineWidth=x;F.fillStyle=F.strokeStyle=z;F.globalAlpha=Math.min(B.getData("alpha"),E.getData("alpha"),D.getData("alpha"));for(var G in A){F[G]=D.getCanvasStyle(G)}this.edgeTypes[C].render.call(this,D,y,H);F.restore()}}};f.Plot3D=d.merge(f.Plot,{Interpolator:{linear:function(y,x,B){var A=y.startPos.getc(true);var z=y.endPos.getc(true);y.pos.setc(this.compute(A.x,z.x,B),this.compute(A.y,z.y,B),this.compute(A.z,z.z,B))}},plotNode:function(y,x){if(y.getData("type")=="none"){return}this.plotElement(y,x,{getAlpha:function(){return y.getData("alpha")}})},plotLine:function(x,y){if(x.getData("type")=="none"){return}this.plotElement(x,y,{getAlpha:function(){return Math.min(x.nodeFrom.getData("alpha"),x.nodeTo.getData("alpha"),x.getData("alpha"))}})},plotElement:function(Z,F,A){var W=F.getCtx(),G=new Matrix4,y=F.config.Scene.Lighting,aa=F.canvases[0],L=aa.program,Y=aa.camera;if(!Z.geometry){Z.geometry=new O3D[Z.getData("type")]}Z.geometry.update(Z);if(!Z.webGLVertexBuffer){var K=[],C=[],Q=[],O=0,T=Z.geometry;for(var X=0,V=T.vertices,I=T.faces,H=I.length;X<H;X++){var N=I[X],E=V[N.a],D=V[N.b],B=V[N.c],z=N.d?V[N.d]:false,S=N.normal;K.push(E.x,E.y,E.z);K.push(D.x,D.y,D.z);K.push(B.x,B.y,B.z);if(z){K.push(z.x,z.y,z.z)}Q.push(S.x,S.y,S.z);Q.push(S.x,S.y,S.z);Q.push(S.x,S.y,S.z);if(z){Q.push(S.x,S.y,S.z)}C.push(O,O+1,O+2);if(z){C.push(O,O+2,O+3);O+=4}else{O+=3}}Z.webGLVertexBuffer=W.createBuffer();W.bindBuffer(W.ARRAY_BUFFER,Z.webGLVertexBuffer);W.bufferData(W.ARRAY_BUFFER,new Float32Array(K),W.STATIC_DRAW);Z.webGLFaceBuffer=W.createBuffer();W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,Z.webGLFaceBuffer);W.bufferData(W.ELEMENT_ARRAY_BUFFER,new Uint16Array(C),W.STATIC_DRAW);Z.webGLFaceCount=C.length;Z.webGLNormalBuffer=W.createBuffer();W.bindBuffer(W.ARRAY_BUFFER,Z.webGLNormalBuffer);W.bufferData(W.ARRAY_BUFFER,new Float32Array(Q),W.STATIC_DRAW)}G.multiply(Y.matrix,Z.geometry.matrix);W.uniformMatrix4fv(L.viewMatrix,false,G.flatten());W.uniformMatrix4fv(L.projectionMatrix,false,Y.projectionMatrix.flatten());var M=Matrix4.makeInvert(G);M.$transpose();W.uniformMatrix4fv(L.normalMatrix,false,M.flatten());var U=d.hexToRgb(Z.getData("color"));U.push(A.getAlpha());W.uniform4f(L.color,U[0]/255,U[1]/255,U[2]/255,U[3]);W.uniform1i(L.enableLighting,y.enable);if(y.enable){if(y.ambient){var P=y.ambient;W.uniform3f(L.ambientColor,P[0],P[1],P[2])}if(y.directional){var R=y.directional,U=R.color,J=R.direction,x=new Vector3(J.x,J.y,J.z).normalize().$scale(-1);W.uniform3f(L.lightingDirection,x.x,x.y,x.z);W.uniform3f(L.directionalColor,U[0],U[1],U[2])}}W.bindBuffer(W.ARRAY_BUFFER,Z.webGLVertexBuffer);W.vertexAttribPointer(L.position,3,W.FLOAT,false,0,0);W.bindBuffer(W.ARRAY_BUFFER,Z.webGLNormalBuffer);W.vertexAttribPointer(L.normal,3,W.FLOAT,false,0,0);W.bindBuffer(W.ELEMENT_ARRAY_BUFFER,Z.webGLFaceBuffer);W.drawElements(W.TRIANGLES,Z.webGLFaceCount,W.UNSIGNED_SHORT,0)}});f.Label={};f.Label.Native=new r({initialize:function(x){this.viz=x},plotLabel:function(z,A,y){var x=z.getCtx();var B=A.pos.getc(true);x.font=A.getLabelData("style")+" "+A.getLabelData("size")+"px "+A.getLabelData("family");x.textAlign=A.getLabelData("textAlign");x.fillStyle=x.strokeStyle=A.getLabelData("color");x.textBaseline=A.getLabelData("textBaseline");this.renderLabel(z,A,y)},renderLabel:function(z,A,y){var x=z.getCtx();var B=A.pos.getc(true);x.fillText(A.name,B.x,B.y+A.getData("height")/2)},hideLabel:function(y,x){y=d.splat(y);var z=x?false:true;d.each(y,function(A){A._hideLabel=z})},hideLabels:d.empty});f.Label.DOM=new r({labelsHidden:false,labelContainer:false,labels:{},getLabelContainer:function(){return this.labelContainer?this.labelContainer:this.labelContainer=document.getElementById(this.viz.config.labelContainer)},getLabel:function(x){return(x in this.labels&&this.labels[x]!=null)?this.labels[x]:this.labels[x]=document.getElementById(x)},hideLabels:function(y){var x=this.getLabelContainer();if(y){x.style.display="none"}else{x.style.display=""}this.labelsHidden=y},clearLabels:function(x){for(var y in this.labels){if(x||!this.viz.graph.hasNode(y)){this.disposeLabel(y);delete this.labels[y]}}},disposeLabel:function(y){var x=this.getLabel(y);if(x&&x.parentNode){x.parentNode.removeChild(x)}},hideLabel:function(B,x){B=d.splat(B);var y=x?"":"none",z,A=this;d.each(B,function(C){z=A.getLabel(C.id);if(z){z.style.display=y}})},fitsInCanvas:function(z,x){var y=x.getSize();if(z.w&&z.h){if(z.x>=y.width||z.x<-z.w||z.y>=y.height||z.y<-z.h){return false}}else{if(z.x>=y.width||z.x<0||z.y>=y.height||z.y<0){return false}}return true}});f.Label.HTML=new r({Implements:f.Label.DOM,plotLabel:function(A,B,z){var C=B.id,x=this.getLabel(C);if(!x&&!(x=document.getElementById(C))){x=document.createElement("div");var y=this.getLabelContainer();x.id=C;x.className="node";x.style.position="absolute";z.onCreateLabel(x,B);y.appendChild(x);this.labels[B.id]=x}this.placeLabel(x,B,z)}});f.Label.SVG=new r({Implements:f.Label.DOM,plotLabel:function(A,C,z){var E=C.id,x=this.getLabel(E);if(!x&&!(x=document.getElementById(E))){var B="http://www.w3.org/2000/svg";x=document.createElementNS(B,"svg:text");var D=document.createElementNS(B,"svg:tspan");x.appendChild(D);var y=this.getLabelContainer();x.setAttribute("id",E);x.setAttribute("class","node");y.appendChild(x);z.onCreateLabel(x,C);this.labels[C.id]=x}this.placeLabel(x,C,z)}});f.Geom=new r({initialize:function(x){this.viz=x;this.config=x.config;this.node=x.config.Node;this.edge=x.config.Edge},translate:function(y,x){x=d.splat(x);this.viz.graph.eachNode(function(z){d.each(x,function(A){z.getPos(A).$add(y)})})},setRightLevelToShow:function(A,x,C){var B=this.getRightLevelToShow(A,x),z=this.viz.labels,y=d.merge({execShow:true,execHide:true,onHide:d.empty,onShow:d.empty},C||{});A.eachLevel(0,this.config.levelsToShow,function(E){var D=E._depth-A._depth;if(D>B){y.onHide(E);if(y.execHide){E.drawn=false;E.exist=false;z.hideLabel(E,false)}}else{y.onShow(E);if(y.execShow){E.exist=true}}});A.drawn=true},getRightLevelToShow:function(A,y){var x=this.config;var B=x.levelsToShow;var z=x.constrained;if(!z){return B}while(!this.treeFitsInCanvas(A,y,B)&&B>1){B--}return B}});var e={construct:function(y){var z=(d.type(y)=="array");var x=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);if(!z){(function(A,C){A.addNode(C);if(C.children){for(var B=0,D=C.children;B<D.length;B++){A.addAdjacence(C,D[B]);arguments.callee(A,D[B])}}})(x,y)}else{(function(I,J){var B=function(N){for(var M=0,K=J.length;M<K;M++){if(J[M].id==N){return J[M]}}var L={id:N,name:N};return I.addNode(L)};for(var F=0,C=J.length;F<C;F++){I.addNode(J[F]);var G=J[F].adjacencies;if(G){for(var D=0,H=G.length;D<H;D++){var A=G[D],E={};if(typeof G[D]!="string"){E=d.merge(A.data,{});A=A.nodeTo}I.addAdjacence(J[F],B(A),E)}}}})(x,y)}return x},loadJSON:function(y,x){this.json=y;if(this.labels&&this.labels.clearLabels){this.labels.clearLabels(true)}this.graph=this.construct(y);if(d.type(y)!="array"){this.root=y.id}else{this.root=y[x?x:0].id}},toJSON:function(B){B=B||"tree";if(B=="tree"){var z={};var y=this.graph.getNode(this.root);var z=(function x(E){var C={};C.id=E.id;C.name=E.name;C.data=E.data;var D=[];E.eachSubnode(function(F){D.push(x(F))});C.children=D;return C})(y);return z}else{var z=[];var A=!!this.graph.getNode(this.root).visited;this.graph.eachNode(function(D){var C={};C.id=D.id;C.name=D.name;C.data=D.data;var E=[];D.eachAdjacency(function(F){var H=F.nodeTo;if(!!H.visited===A){var G={};G.nodeTo=H.id;G.data=F.data;E.push(G)}});C.adjacencies=E;z.push(C);D.visited=!A});return z}}};var h=$jit.Layouts={};var g={label:null,compute:function(A,B,y){this.initializeLabel(y);var x=this.label,z=x.style;A.eachNode(function(E){var I=E.getData("autoWidth"),J=E.getData("autoHeight");if(I||J){delete E.data.$width;delete E.data.$height;delete E.data.$dim;var C=E.getData("width"),K=E.getData("height");z.width=I?"auto":C+"px";z.height=J?"auto":K+"px";x.innerHTML=E.name;var G=x.offsetWidth,D=x.offsetHeight;var H=E.getData("type");if(d.indexOf(["circle","square","triangle","star"],H)===-1){E.setData("width",G);E.setData("height",D)}else{var F=G>D?G:D;E.setData("width",F);E.setData("height",F);E.setData("dim",F)}}})},initializeLabel:function(x){if(!this.label){this.label=document.createElement("div");document.body.appendChild(this.label)}this.setLabelStyles(x)},setLabelStyles:function(x){d.extend(this.label.style,{visibility:"hidden",position:"absolute",width:"auto",height:"auto"});this.label.className="jit-autoadjust-label"}};h.Tree=(function(){var G=Array.prototype.slice;function E(Q,L,I,O,J){var N=L.Node;var K=L.multitree;if(N.overridable){var P=-1,M=-1;Q.eachNode(function(T){if(T._depth==I&&(!K||("$orn" in T.data)&&T.data.$orn==O)){var R=T.getData("width",J);var S=T.getData("height",J);P=(P<R)?R:P;M=(M<S)?S:M}});return{width:P<0?N.width:P,height:M<0?N.height:M}}else{return N}}function H(J,M,L,I){var K=(I=="left"||I=="right")?"y":"x";J.getPos(M)[K]+=L}function C(J,K){var I=[];d.each(J,function(L){L=G.call(L);L[0]+=K;L[1]+=K;I.push(L)});return I}function F(L,I){if(L.length==0){return I}if(I.length==0){return L}var K=L.shift(),J=I.shift();return[[K[0],J[1]]].concat(F(L,I))}function A(I,J){J=J||[];if(I.length==0){return J}var K=I.pop();return A(I,F(K,J))}function D(L,J,M,I,K){if(L.length<=K||J.length<=K){return 0}var O=L[K][1],N=J[K][0];return Math.max(D(L,J,M,I,++K)+M,O-N+I)}function B(L,J,I){function K(O,Q,N){if(Q.length<=N){return[]}var P=Q[N],M=D(O,P,J,I,0);return[M].concat(K(F(O,C(P,M)),Q,++N))}return K([],L,0)}function y(M,L,K){function I(P,R,O){if(R.length<=O){return[]}var Q=R[O],N=-D(Q,P,L,K,0);return[N].concat(I(F(C(Q,N),P),R,++O))}M=G.call(M);var J=I([],M.reverse(),0);return J.reverse()}function x(O,M,J,P){var K=B(O,M,J),N=y(O,M,J);if(P=="left"){N=K}else{if(P=="right"){K=N}}for(var L=0,I=[];L<K.length;L++){I[L]=(K[L]+N[L])/2}return I}function z(I,S,J,Z,X){var L=Z.multitree;var R=["x","y"],O=["width","height"];var K=+(X=="left"||X=="right");var P=R[K],Y=R[1-K];var U=Z.Node;var N=O[K],W=O[1-K];var M=Z.siblingOffset;var V=Z.subtreeOffset;var T=Z.align;function Q(ac,ag,ak){var ab=ac.getData(N,J);var aj=ag||(ac.getData(W,J));var an=[],al=[],ah=false;var aa=aj+Z.levelDistance;ac.eachSubnode(function(ap){if(ap.exist&&(!L||("$orn" in ap.data)&&ap.data.$orn==X)){if(Z.levelSpacing=="even"){if(!ah){ah=E(I,Z,ap._depth,X,J)}}else{ah={width:ap.getData("width"),height:ap.getData("height")}}var ao=Q(ap,ah[W],ak+aa);an.push(ao.tree);al.push(ao.extent)}});var af=x(al,V,M,T);for(var ae=0,ad=[],ai=[];ae<an.length;ae++){H(an[ae],J,af[ae],X);ai.push(C(al[ae],af[ae]))}var am=[[-ab/2,ab/2]].concat(A(ai));ac.getPos(J)[P]=0;if(X=="top"||X=="left"){ac.getPos(J)[Y]=ak}else{ac.getPos(J)[Y]=-ak}return{tree:ac,extent:am}}Q(S,false,0)}return new r({compute:function(K,J){var L=K||"start";var I=this.graph.getNode(this.root);d.extend(I,{drawn:true,exist:true,selected:true});g.compute(this.graph,L,this.config);if(!!J||!("_depth" in I)){this.graph.computeLevels(this.root,0,"ignore")}this.computePositions(I,L)},computePositions:function(M,I){var K=this.config;var J=K.multitree;var P=K.align;var L=P!=="center"&&K.indent;var Q=K.orientation;var O=J?["top","right","bottom","left"]:[Q];var N=this;d.each(O,function(R){z(N.graph,M,I,N.config,R,I);var S=["x","y"][+(R=="left"||R=="right")];(function T(U){U.eachSubnode(function(V){if(V.exist&&(!J||("$orn" in V.data)&&V.data.$orn==R)){V.getPos(I)[S]+=U.getPos(I)[S];if(L){V.getPos(I)[S]+=P=="left"?L:-L}T(V)}})})(M)})}})})();$jit.ST=(function(){var y=[];function z(E){E=E||this.clickedNode;if(!this.config.constrained){return[]}var B=this.geom;var I=this.graph;var C=this.canvas;var A=E._depth,F=[];I.eachNode(function(J){if(J.exist&&!J.selected){if(J.isDescendantOf(E.id)){if(J._depth<=A){F.push(J)}}else{F.push(J)}}});var G=B.getRightLevelToShow(E,C);E.eachLevel(G,G,function(J){if(J.exist&&!J.selected){F.push(J)}});for(var H=0;H<y.length;H++){var D=this.graph.getNode(y[H]);if(!D.isDescendantOf(E.id)){F.push(D)}}return F}function x(C){var B=[],A=this.config;C=C||this.clickedNode;this.clickedNode.eachLevel(0,A.levelsToShow,function(D){if(A.multitree&&!("$orn" in D.data)&&D.anySubnode(function(E){return E.exist&&!E.drawn})){B.push(D)}else{if(D.drawn&&!D.anySubnode("drawn")){B.push(D)}}});return B}return new r({Implements:[e,p,h.Tree],initialize:function(A){var C=$jit.ST;var B={levelsToShow:2,levelDistance:30,constrained:true,Node:{type:"rectangle"},duration:700,offsetX:0,offsetY:0};this.controller=this.config=d.merge(o("Canvas","Fx","Tree","Node","Edge","Controller","Tips","NodeStyles","Events","Navigation","Label"),B,A);var D=this.config;if(D.useCanvas){this.canvas=D.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(D.background){D.background=d.merge({type:"Circles"},D.background)}this.canvas=new m(this,D);this.config.labelContainer=(typeof D.injectInto=="string"?D.injectInto:D.injectInto.id)+"-label"}this.graphOptions={klass:q};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new C.Label[D.Label.type](this);this.fx=new C.Plot(this,C);this.op=new C.Op(this);this.group=new C.Group(this);this.geom=new C.Geom(this);this.clickedNode=null;this.initializeExtras()},plot:function(){this.fx.plot(this.controller)},switchPosition:function(F,E,D){var A=this.geom,B=this.fx,C=this;if(!B.busy){B.busy=true;this.contract({onComplete:function(){A.switchOrientation(F);C.compute("end",false);B.busy=false;if(E=="animate"){C.onClick(C.clickedNode.id,D)}else{if(E=="replot"){C.select(C.clickedNode.id,D)}}}},F)}},switchAlignment:function(C,B,A){this.config.align=C;if(B=="animate"){this.select(this.clickedNode.id,A)}else{if(B=="replot"){this.onClick(this.clickedNode.id,A)}}},addNodeInPath:function(A){y.push(A);this.select((this.clickedNode&&this.clickedNode.id)||this.root)},clearNodesInPath:function(A){y.length=0;this.select((this.clickedNode&&this.clickedNode.id)||this.root)},refresh:function(){this.reposition();this.select((this.clickedNode&&this.clickedNode.id)||this.root)},reposition:function(){this.graph.computeLevels(this.root,0,"ignore");this.geom.setRightLevelToShow(this.clickedNode,this.canvas);this.graph.eachNode(function(B){if(B.exist){B.drawn=true}});this.compute("end");if(this.clickedNode){var A={x:this.canvas.translateOffsetX+this.config.offsetX||0,y:this.canvas.translateOffsetY+this.config.offsetY||0};this.geom.translate(this.clickedNode.endPos.add(A).$scale(-1),"end")}},requestNodes:function(C,D){var B=d.merge(this.controller,D),A=this.config.levelsToShow;if(B.request){var F=[],E=C._depth;C.eachLevel(0,A,function(G){if(G.drawn&&!G.anySubnode()){F.push(G);G._level=A-(G._depth-E)}});this.group.requestNodes(F,B)}else{B.onComplete()}},contract:function(E,F){var D=this.config.orientation;var A=this.geom,C=this.group;if(F){A.switchOrientation(F)}var B=z.call(this);if(F){A.switchOrientation(D)}C.contract(B,d.merge(this.controller,E))},move:function(B,C){this.compute("end",false);var A=C.Move,D={x:A.offsetX,y:A.offsetY};if(A.enable){this.geom.translate(B.endPos.add(D).$scale(-1),"end")}else{this.geom.translate(s(D.x,D.y).$scale(-1),"end")}this.fx.animate(d.merge(this.controller,{modes:["linear"]},C))},expand:function(B,C){var A=x.call(this,B);this.group.expand(A,d.merge(this.controller,C))},selectPath:function(D){var C=this;this.graph.eachNode(function(F){F.selected=false});function E(G){if(G==null||G.selected){return}G.selected=true;d.each(C.group.getSiblings([G])[G.id],function(H){H.exist=true;H.drawn=true});var F=G.getParents();F=(F.length>0)?F[0]:null;E(F)}for(var A=0,B=[D.id].concat(y);A<B.length;A++){E(this.graph.getNode(B[A]))}},setRoot:function(H,G,F){if(this.busy){return}this.busy=true;var E=this,C=this.canvas;var A=this.graph.getNode(this.root);var B=this.graph.getNode(H);function D(){if(this.config.multitree&&B.data.$orn){var J=B.data.$orn;var K={left:"right",right:"left",top:"bottom",bottom:"top"}[J];A.data.$orn=K;(function I(L){L.eachSubnode(function(M){if(M.id!=H){M.data.$orn=K;I(M)}})})(A);delete B.data.$orn}this.root=H;this.clickedNode=B;this.graph.computeLevels(this.root,0,"ignore");this.geom.setRightLevelToShow(B,C,{execHide:false,onShow:function(L){if(!L.drawn){L.drawn=true;L.setData("alpha",1,"end");L.setData("alpha",0);L.pos.setc(B.pos.x,B.pos.y)}}});this.compute("end");this.busy=true;this.fx.animate({modes:["linear","node-property:alpha"],onComplete:function(){E.busy=false;E.onClick(H,{onComplete:function(){F&&F.onComplete()}})}})}delete A.data.$orns;if(G=="animate"){D.call(this);E.selectPath(B)}else{if(G=="replot"){D.call(this);this.select(this.root)}}},addSubtree:function(A,C,B){if(C=="replot"){this.op.sum(A,d.extend({type:"replot"},B||{}))}else{if(C=="animate"){this.op.sum(A,d.extend({type:"fade:seq"},B||{}))}}},removeSubtree:function(F,B,E,D){var C=this.graph.getNode(F),A=[];C.eachLevel(+!B,false,function(G){A.push(G.id)});if(E=="replot"){this.op.removeNode(A,d.extend({type:"replot"},D||{}))}else{if(E=="animate"){this.op.removeNode(A,d.extend({type:"fade:seq"},D||{}))}}},select:function(A,D){var I=this.group,G=this.geom;var E=this.graph.getNode(A),C=this.canvas;var H=this.graph.getNode(this.root);var B=d.merge(this.controller,D);var F=this;B.onBeforeCompute(E);this.selectPath(E);this.clickedNode=E;this.requestNodes(E,{onComplete:function(){I.hide(I.prepare(z.call(F)),B);G.setRightLevelToShow(E,C);F.compute("current");F.graph.eachNode(function(L){var K=L.pos.getc(true);L.startPos.setc(K.x,K.y);L.endPos.setc(K.x,K.y);L.visited=false});var J={x:B.offsetX,y:B.offsetY};F.geom.translate(E.endPos.add(J).$scale(-1),["start","current","end"]);I.show(x.call(F));F.plot();B.onAfterCompute(F.clickedNode);B.onComplete()}})},onClick:function(B,I){var D=this.canvas,H=this,A=this.geom,E=this.config;var G={Move:{enable:true,offsetX:D.translateOffsetX+E.offsetX||0,offsetY:D.translateOffsetY+E.offsetY||0},setRightLevelToShowConfig:false,onBeforeRequest:d.empty,onBeforeContract:d.empty,onBeforeMove:d.empty,onBeforeExpand:d.empty};var C=d.merge(this.controller,G,I);if(!this.busy){this.busy=true;var F=this.graph.getNode(B);this.selectPath(F,this.clickedNode);this.clickedNode=F;C.onBeforeCompute(F);C.onBeforeRequest(F);this.requestNodes(F,{onComplete:function(){C.onBeforeContract(F);H.contract({onComplete:function(){A.setRightLevelToShow(F,D,C.setRightLevelToShowConfig);C.onBeforeMove(F);H.move(F,{Move:C.Move,onComplete:function(){C.onBeforeExpand(F);H.expand(F,{onComplete:function(){H.busy=false;C.onAfterCompute(B);C.onComplete()}})}})}})}})}}})})();$jit.ST.$extend=true;$jit.ST.Op=new r({Implements:f.Op});$jit.ST.Group=new r({initialize:function(x){this.viz=x;this.canvas=x.canvas;this.config=x.config;this.animation=new v;this.nodes=null},requestNodes:function(C,B){var A=0,y=C.length,E={};var z=function(){B.onComplete()};var x=this.viz;if(y==0){z()}for(var D=0;D<y;D++){E[C[D].id]=C[D];B.request(C[D].id,C[D]._level,{onComplete:function(G,F){if(F&&F.children){F.id=G;x.op.sum(F,{type:"nothing"})}if(++A==y){x.graph.computeLevels(x.root,0);z()}}})}},contract:function(z,y){var x=this.viz;var A=this;z=this.prepare(z);this.animation.setOptions(d.merge(y,{$animating:false,compute:function(B){if(B==1){B=0.99}A.plotStep(1-B,y,this.$animating);this.$animating="contract"},complete:function(){A.hide(z,y)}})).start()},hide:function(z,y){var x=this.viz;for(var A=0;A<z.length;A++){if(true||!y||!y.request){z[A].eachLevel(1,false,function(C){if(C.exist){d.extend(C,{drawn:false,exist:false})}})}else{var B=[];z[A].eachLevel(1,false,function(C){B.push(C.id)});x.op.removeNode(B,{type:"nothing"});x.labels.clearLabels()}}y.onComplete()},expand:function(y,x){var z=this;this.show(y);this.animation.setOptions(d.merge(x,{$animating:false,compute:function(A){z.plotStep(A,x,this.$animating);this.$animating="expand"},complete:function(){z.plotStep(undefined,x,false);x.onComplete()}})).start()},show:function(x){var y=this.config;this.prepare(x);d.each(x,function(A){if(y.multitree&&!("$orn" in A.data)){delete A.data.$orns;var z=" ";A.eachSubnode(function(B){if(("$orn" in B.data)&&z.indexOf(B.data.$orn)<0&&B.exist&&!B.drawn){z+=B.data.$orn+" "}});A.data.$orns=z}A.eachLevel(0,y.levelsToShow,function(B){if(B.exist){B.drawn=true}})})},prepare:function(x){this.nodes=this.getNodesWithChildren(x);return this.nodes},getNodesWithChildren:function(z){var y=[],B=this.config,x=this.viz.root;z.sort(function(F,E){return(F._depth<=E._depth)-(F._depth>=E._depth)});for(var C=0;C<z.length;C++){if(z[C].anySubnode("exist")){for(var A=C+1,D=false;!D&&A<z.length;A++){if(!B.multitree||"$orn" in z[A].data){D=D||z[C].isDescendantOf(z[A].id)}}if(!D){y.push(z[C])}}}return y},plotStep:function(H,D,J){var G=this.viz,A=this.config,z=G.canvas,I=z.getCtx(),x=this.nodes;var C,B;var y={};for(C=0;C<x.length;C++){B=x[C];y[B.id]=[];var F=A.multitree&&!("$orn" in B.data);var E=F&&B.data.$orns;B.eachSubgraph(function(K){if(F&&E&&E.indexOf(K.data.$orn)>0&&K.drawn){K.drawn=false;y[B.id].push(K)}else{if((!F||!E)&&K.drawn){K.drawn=false;y[B.id].push(K)}}});B.drawn=true}if(x.length>0){G.fx.plot()}for(C in y){d.each(y[C],function(K){K.drawn=true})}for(C=0;C<x.length;C++){B=x[C];I.save();G.fx.plotSubtree(B,D,H,J);I.restore()}},getSiblings:function(x){var y={};d.each(x,function(B){var A=B.getParents();if(A.length==0){y[B.id]=[B]}else{var z=[];A[0].eachSubnode(function(C){z.push(C)});y[B.id]=z}});return y}});$jit.ST.Geom=new r({Implements:f.Geom,switchOrientation:function(x){this.config.orientation=x},dispatch:function(){var y=Array.prototype.slice.call(arguments);var z=y.shift(),x=y.length;var A=function(B){return typeof B=="function"?B():B};if(x==2){return(z=="top"||z=="bottom")?A(y[0]):A(y[1])}else{if(x==4){switch(z){case"top":return A(y[0]);case"right":return A(y[1]);case"bottom":return A(y[2]);case"left":return A(y[3])}}}return undefined},getSize:function(E,D){var C=E.data,z=this.config;var y=z.siblingOffset;var B=(z.multitree&&("$orn" in C)&&C.$orn)||z.orientation;var x=E.getData("width")+y;var A=E.getData("height")+y;if(!D){return this.dispatch(B,A,x)}else{return this.dispatch(B,x,A)}},getTreeBaseSize:function(B,C,y){var z=this.getSize(B,true),x=0,A=this;if(y(C,B)){return z}if(C===0){return 0}B.eachSubnode(function(D){x+=A.getTreeBaseSize(D,C-1,y)});return(z>x?z:x)+this.config.subtreeOffset},getEdge:function(C,B,A){var y=function(F,E){return function(){return C.pos.add(new q(F,E))}};var D=this.node;var x=C.getData("width");var z=C.getData("height");if(B=="begin"){if(D.align=="center"){return this.dispatch(A,y(0,z/2),y(-x/2,0),y(0,-z/2),y(x/2,0))}else{if(D.align=="left"){return this.dispatch(A,y(0,z),y(0,0),y(0,0),y(x,0))}else{if(D.align=="right"){return this.dispatch(A,y(0,0),y(-x,0),y(0,-z),y(0,0))}else{throw"align: not implemented"}}}}else{if(B=="end"){if(D.align=="center"){return this.dispatch(A,y(0,-z/2),y(x/2,0),y(0,z/2),y(-x/2,0))}else{if(D.align=="left"){return this.dispatch(A,y(0,0),y(x,0),y(0,z),y(0,0))}else{if(D.align=="right"){return this.dispatch(A,y(0,-z),y(0,0),y(0,0),y(-x,0))}else{throw"align: not implemented"}}}}}},getScaledTreePosition:function(B,D){var C=this.node;var x=B.getData("width");var A=B.getData("height");var z=(this.config.multitree&&("$orn" in B.data)&&B.data.$orn)||this.config.orientation;var y=function(F,E){return function(){return B.pos.add(new q(F,E)).$scale(1-D)}};if(C.align=="left"){return this.dispatch(z,y(0,A),y(0,0),y(0,0),y(x,0))}else{if(C.align=="center"){return this.dispatch(z,y(0,A/2),y(-x/2,0),y(0,-A/2),y(x/2,0))}else{if(C.align=="right"){return this.dispatch(z,y(0,0),y(-x,0),y(0,-A),y(0,0))}else{throw"align: not implemented"}}}},treeFitsInCanvas:function(C,x,D){var z=x.getSize();var A=(this.config.multitree&&("$orn" in C.data)&&C.data.$orn)||this.config.orientation;var y=this.dispatch(A,z.width,z.height);var B=this.getTreeBaseSize(C,D,function(F,E){return F===0||!E.anySubnode()});return(B<y)}});$jit.ST.Plot=new r({Implements:f.Plot,plotSubtree:function(A,x,B,F){var D=this.viz,y=D.canvas,z=D.config;B=Math.min(Math.max(0.001,B),1);if(B>=0){A.drawn=false;var E=y.getCtx();var C=D.geom.getScaledTreePosition(A,B);E.translate(C.x,C.y);E.scale(B,B)}this.plotTree(A,d.merge(x,{withLabels:true,hideLabels:!!B,plotSubtree:function(J,H){var G=z.multitree&&!("$orn" in A.data);var I=G&&A.getData("orns");return !G||I.indexOf(A.getData("orn"))>-1}}),F);if(B>=0){A.drawn=true}},getAlignedPos:function(C,A,x){var z=this.node;var B,y;if(z.align=="center"){B={x:C.x-A/2,y:C.y-x/2}}else{if(z.align=="left"){y=this.config.orientation;if(y=="bottom"||y=="top"){B={x:C.x-A/2,y:C.y}}else{B={x:C.x,y:C.y-x/2}}}else{if(z.align=="right"){y=this.config.orientation;if(y=="bottom"||y=="top"){B={x:C.x-A/2,y:C.y-x}}else{B={x:C.x-A,y:C.y-x/2}}}else{throw"align: not implemented"}}}return B},getOrientation:function(x){var z=this.config;var y=z.orientation;if(z.multitree){var A=x.nodeFrom;var B=x.nodeTo;y=(("$orn" in A.data)&&A.data.$orn)||(("$orn" in B.data)&&B.data.$orn)}return y}});$jit.ST.Label={};$jit.ST.Label.Native=new r({Implements:f.Label.Native,renderLabel:function(A,C,z){var y=A.getCtx(),E=C.pos.getc(true),B=C.getData("width"),x=C.getData("height"),D=this.viz.fx.getAlignedPos(E,B,x);y.fillText(C.name,D.x+B/2,D.y+x/2)}});$jit.ST.Label.DOM=new r({Implements:f.Label.DOM,placeLabel:function(P,J,F){var B=J.pos.getc(true),O=this.viz.config,K=O.Node,x=this.viz.canvas,C=J.getData("width"),M=J.getData("height"),y=x.getSize(),G,N;var A=x.translateOffsetX,z=x.translateOffsetY,E=x.scaleOffsetX,D=x.scaleOffsetY,I=B.x*E+A,H=B.y*D+z;if(K.align=="center"){G={x:Math.round(I-C/2+y.width/2),y:Math.round(H-M/2+y.height/2)}}else{if(K.align=="left"){N=O.orientation;if(N=="bottom"||N=="top"){G={x:Math.round(I-C/2+y.width/2),y:Math.round(H+y.height/2)}}else{G={x:Math.round(I+y.width/2),y:Math.round(H-M/2+y.height/2)}}}else{if(K.align=="right"){N=O.orientation;if(N=="bottom"||N=="top"){G={x:Math.round(I-C/2+y.width/2),y:Math.round(H-M+y.height/2)}}else{G={x:Math.round(I-C+y.width/2),y:Math.round(H-M/2+y.height/2)}}}else{throw"align: not implemented"}}}G.w=C;G.h=M;var L=P.style;L.left=G.x+"px";L.top=G.y+"px";L.display=this.fitsInCanvas(G,x)?"":"none";F.onPlaceLabel(P,J)}});$jit.ST.Label.SVG=new r({Implements:[$jit.ST.Label.DOM,f.Label.SVG],initialize:function(x){this.viz=x}});$jit.ST.Label.HTML=new r({Implements:[$jit.ST.Label.DOM,f.Label.HTML],initialize:function(x){this.viz=x}});$jit.ST.Plot.NodeTypes=new r({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(y,x){var A=y.getData("dim"),B=this.getAlignedPos(y.pos.getc(true),A,A),z=A/2;this.nodeHelper.circle.render("fill",{x:B.x+z,y:B.y+z},z,x)},contains:function(x,B){var z=x.getData("dim"),A=this.getAlignedPos(x.pos.getc(true),z,z),y=z/2;return this.nodeHelper.circle.contains({x:A.x+y,y:A.y+y},B,y)}},square:{render:function(y,x){var A=y.getData("dim"),z=A/2,B=this.getAlignedPos(y.pos.getc(true),A,A);this.nodeHelper.square.render("fill",{x:B.x+z,y:B.y+z},z,x)},contains:function(x,B){var z=x.getData("dim"),A=this.getAlignedPos(x.pos.getc(true),z,z),y=z/2;return this.nodeHelper.square.contains({x:A.x+y,y:A.y+y},B,y)}},ellipse:{render:function(A,y){var z=A.getData("width"),x=A.getData("height"),B=this.getAlignedPos(A.pos.getc(true),z,x);this.nodeHelper.ellipse.render("fill",{x:B.x+z/2,y:B.y+x/2},z,x,y)},contains:function(z,B){var y=z.getData("width"),x=z.getData("height"),A=this.getAlignedPos(z.pos.getc(true),y,x);return this.nodeHelper.ellipse.contains({x:A.x+y/2,y:A.y+x/2},B,y,x)}},rectangle:{render:function(A,y){var z=A.getData("width"),x=A.getData("height"),B=this.getAlignedPos(A.pos.getc(true),z,x);this.nodeHelper.rectangle.render("fill",{x:B.x+z/2,y:B.y+x/2},z,x,y)},contains:function(z,B){var y=z.getData("width"),x=z.getData("height"),A=this.getAlignedPos(z.pos.getc(true),y,x);return this.nodeHelper.rectangle.contains({x:A.x+y/2,y:A.y+x/2},B,y,x)}}});$jit.ST.Plot.EdgeTypes=new r({none:d.empty,line:{render:function(y,A){var z=this.getOrientation(y),B=y.nodeFrom,C=y.nodeTo,x=B._depth<C._depth,E=this.viz.geom.getEdge(x?B:C,"begin",z),D=this.viz.geom.getEdge(x?C:B,"end",z);this.edgeHelper.line.render(E,D,A)},contains:function(y,E){var z=this.getOrientation(y),A=y.nodeFrom,B=y.nodeTo,x=A._depth<B._depth,D=this.viz.geom.getEdge(x?A:B,"begin",z),C=this.viz.geom.getEdge(x?B:A,"end",z);return this.edgeHelper.line.contains(D,C,E,this.edge.epsilon)}},arrow:{render:function(D,y){var C=this.getOrientation(D),z=D.nodeFrom,x=D.nodeTo,H=(z._depth<x._depth),B=D.getData("dim"),G=this.viz.geom.getEdge((H?z:x),"begin",C),F=this.viz.geom.getEdge((H?x:z),"end",C),E=D.data.$direction,A=(E&&E.length>1&&E[0]!=z.id);this.edgeHelper.arrow.render(G,F,B,A,y)},contains:function(y,E){var z=this.getOrientation(y),A=y.nodeFrom,B=y.nodeTo,x=A._depth<B._depth,D=this.viz.geom.getEdge(x?A:B,"begin",z),C=this.viz.geom.getEdge(x?B:A,"end",z);return this.edgeHelper.arrow.contains(D,C,E,this.edge.epsilon)}},"quadratic:begin":{render:function(D,x){var C=this.getOrientation(D);var B=D.nodeFrom,E=D.nodeTo,G=B._depth<E._depth,y=this.viz.geom.getEdge(G?B:E,"begin",C),z=this.viz.geom.getEdge(G?E:B,"end",C),A=D.getData("dim"),F=x.getCtx();F.beginPath();F.moveTo(y.x,y.y);switch(C){case"left":F.quadraticCurveTo(y.x+A,y.y,z.x,z.y);break;case"right":F.quadraticCurveTo(y.x-A,y.y,z.x,z.y);break;case"top":F.quadraticCurveTo(y.x,y.y+A,z.x,z.y);break;case"bottom":F.quadraticCurveTo(y.x,y.y-A,z.x,z.y);break}F.stroke()}},"quadratic:end":{render:function(D,x){var C=this.getOrientation(D);var B=D.nodeFrom,E=D.nodeTo,G=B._depth<E._depth,y=this.viz.geom.getEdge(G?B:E,"begin",C),z=this.viz.geom.getEdge(G?E:B,"end",C),A=D.getData("dim"),F=x.getCtx();F.beginPath();F.moveTo(y.x,y.y);switch(C){case"left":F.quadraticCurveTo(z.x-A,z.y,z.x,z.y);break;case"right":F.quadraticCurveTo(z.x+A,z.y,z.x,z.y);break;case"top":F.quadraticCurveTo(z.x,z.y-A,z.x,z.y);break;case"bottom":F.quadraticCurveTo(z.x,z.y+A,z.x,z.y);break}F.stroke()}},bezier:{render:function(D,x){var C=this.getOrientation(D),B=D.nodeFrom,E=D.nodeTo,G=B._depth<E._depth,y=this.viz.geom.getEdge(G?B:E,"begin",C),z=this.viz.geom.getEdge(G?E:B,"end",C),A=D.getData("dim"),F=x.getCtx();F.beginPath();F.moveTo(y.x,y.y);switch(C){case"left":F.bezierCurveTo(y.x+A,y.y,z.x-A,z.y,z.x,z.y);break;case"right":F.bezierCurveTo(y.x-A,y.y,z.x+A,z.y,z.x,z.y);break;case"top":F.bezierCurveTo(y.x,y.y+A,z.x,z.y-A,z.x,z.y);break;case"bottom":F.bezierCurveTo(y.x,y.y-A,z.x,z.y+A,z.x,z.y);break}F.stroke()}}});$jit.ST.Plot.NodeTypes.implement({"areachart-stacked":{render:function(X,E){var V=X.pos.getc(true),z=X.getData("width"),B=X.getData("height"),H=this.getAlignedPos(V,z,B),ac=H.x,ab=H.y,M=X.getData("stringArray"),G=X.getData("dimArray"),C=X.getData("valueArray"),ae=d.reduce(C,function(al,am){return al+am[0]},0),ad=d.reduce(C,function(al,am){return al+am[1]},0),J=X.getData("colorArray"),D=J.length,Z=X.getData("config"),K=X.getData("gradient"),ak=Z.showLabels,O=Z.showAggregates,ag=Z.Label,U=X.getData("prev");var N=E.getCtx(),I=X.getData("border");if(J&&G&&M){for(var aj=0,ah=G.length,L=0,F=0,Y=0;aj<ah;aj++){N.fillStyle=N.strokeStyle=J[aj%D];N.save();if(K&&(G[aj][0]>0||G[aj][1]>0)){var S=L+G[aj][0],Q=F+G[aj][1],ai=Math.atan((Q-S)/z),aa=55;var W=N.createLinearGradient(ac+z/2,ab-(S+Q)/2,ac+z/2+aa*Math.sin(ai),ab-(S+Q)/2+aa*Math.cos(ai));var R=d.rgbToHex(d.map(d.hexToRgb(J[aj%D].slice(1)),function(x){return(x*0.85)>>0}));W.addColorStop(0,J[aj%D]);W.addColorStop(1,R);N.fillStyle=W}N.beginPath();N.moveTo(ac,ab-L);N.lineTo(ac+z,ab-F);N.lineTo(ac+z,ab-F-G[aj][1]);N.lineTo(ac,ab-L-G[aj][0]);N.lineTo(ac,ab-L);N.fill();N.restore();if(I){var T=I.name==M[aj];var A=T?0.7:0.8;var R=d.rgbToHex(d.map(d.hexToRgb(J[aj%D].slice(1)),function(x){return(x*A)>>0}));N.strokeStyle=R;N.lineWidth=T?4:1;N.save();N.beginPath();if(I.index===0){N.moveTo(ac,ab-L);N.lineTo(ac,ab-L-G[aj][0])}else{N.moveTo(ac+z,ab-F);N.lineTo(ac+z,ab-F-G[aj][1])}N.stroke();N.restore()}L+=(G[aj][0]||0);F+=(G[aj][1]||0);if(G[aj][0]>0){Y+=(C[aj][0]||0)}}if(U&&ag.type=="Native"){N.save();N.beginPath();N.fillStyle=N.strokeStyle=ag.color;N.font=ag.style+" "+ag.size+"px "+ag.family;N.textAlign="center";N.textBaseline="middle";var P=O(X.name,ae,ad,X,Y);if(P!==false){N.fillText(P!==true?P:Y,ac,ab-L-Z.labelOffset-ag.size/2,z)}var af=ak(X.name,ae,ad,X);if(af!==false){N.fillText(af!==true?af:X.name,ac,ab+ag.size/2+Z.labelOffset)}N.restore()}}},contains:function(D,F){var K=D.pos.getc(true),A=D.getData("width"),O=D.getData("height"),N=this.getAlignedPos(K,A,O),M=N.x,L=N.y,P=D.getData("dimArray"),z=F.x-M;if(F.x<M||F.x>M+A||F.y>L||F.y<L-O){return false}for(var G=0,E=P.length,J=L,B=L;G<E;G++){var C=P[G];J-=C[0];B-=C[1];var H=J+(B-J)*z/A;if(F.y>=H){var I=+(z>A/2);return{name:D.getData("stringArray")[G],color:D.getData("colorArray")[G],value:D.getData("valueArray")[G][I],index:I}}}return false}}});$jit.AreaChart=new r({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(z){this.controller=this.config=d.merge(o("Canvas","Margin","Label","AreaChart"),{Label:{type:"Native"}},z);var A=this.config.showLabels,y=d.type(A),B=this.config.showAggregates,x=d.type(B);this.config.showLabels=y=="function"?A:d.lambda(A);this.config.showAggregates=x=="function"?B:d.lambda(B);this.initializeViz()},initializeViz:function(){var y=this.config,C=this,x=y.type.split(":")[0],B={};var A=new $jit.ST({injectInto:y.injectInto,width:y.width,height:y.height,orientation:"bottom",levelDistance:0,siblingOffset:0,subtreeOffset:0,withLabels:y.Label.type!="Native",useCanvas:y.useCanvas,Label:{type:y.Label.type},Node:{overridable:true,type:"areachart-"+x,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:y.Tips.enable,type:"Native",force:true,onShow:function(H,G,E){var F=E;y.Tips.onShow(H,F,G)}},Events:{enable:true,type:"Native",onClick:function(G,H,E){if(!y.filterOnClick&&!y.Events.enable){return}var F=H.getContains();if(F){y.filterOnClick&&C.filter(F.name)}y.Events.enable&&y.Events.onClick(F,H,E)},onRightClick:function(F,G,E){if(!y.restoreOnRightClick){return}C.restore()},onMouseMove:function(G,H,E){if(!y.selectOnHover){return}if(G){var F=H.getContains();C.select(G.id,F.name,F.index)}else{C.select(false,false,false)}}},onCreateLabel:function(K,H){var Q=y.Label,P=H.getData("valueArray"),I=d.reduce(P,function(R,S){return R+S[0]},0),N=d.reduce(P,function(R,S){return R+S[1]},0);if(H.getData("prev")){var M={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")};var E=M.wrapper,O=M.label,F=M.aggregate,G=E.style,L=O.style,J=F.style;B[H.id]=M;E.appendChild(O);E.appendChild(F);if(!y.showLabels(H.name,I,N,H)){O.style.display="none"}if(!y.showAggregates(H.name,I,N,H)){F.style.display="none"}G.position="relative";G.overflow="visible";G.fontSize=Q.size+"px";G.fontFamily=Q.family;G.color=Q.color;G.textAlign="center";J.position=L.position="absolute";K.style.width=H.getData("width")+"px";K.style.height=H.getData("height")+"px";O.innerHTML=H.name;K.appendChild(E)}},onPlaceLabel:function(W,Q){if(!Q.getData("prev")){return}var U=B[Q.id],F=U.wrapper.style,E=U.label.style,P=U.aggregate.style,N=Q.getData("width"),L=Q.getData("height"),K=Q.getData("dimArray"),H=Q.getData("valueArray"),M=d.reduce(H,function(X,Y){return X+Y[0]},0),I=d.reduce(H,function(X,Y){return X+Y[1]},0),J=parseInt(F.fontSize,10),O=W.style;if(K&&H){if(y.showLabels(Q.name,M,I,Q)){E.display=""}else{E.display="none"}var G=y.showAggregates(Q.name,M,I,Q);if(G!==false){P.display=""}else{P.display="none"}F.width=P.width=E.width=W.style.width=N+"px";P.left=E.left=-N/2+"px";for(var T=0,R=H.length,S=0,V=0;T<R;T++){if(K[T][0]>0){S+=H[T][0];V+=K[T][0]}}P.top=(-J-y.labelOffset)+"px";E.top=(y.labelOffset+V)+"px";W.style.top=parseInt(W.style.top,10)-V+"px";W.style.height=F.height=V+"px";U.aggregate.innerHTML=G!==true?G:S}}});var z=A.canvas.getSize(),D=y.Margin;A.config.offsetY=-z.height/2+D.bottom+(y.showLabels&&(y.labelOffset+y.Label.size));A.config.offsetX=(D.right-D.left)/2;this.delegate=A;this.canvas=this.delegate.canvas},loadJSON:function(O){var K=d.time(),C=[],N=this.delegate,R=d.splat(O.label),J=d.splat(O.color||this.colors),P=this.config,y=!!P.type.split(":")[1],A=P.animate;for(var L=0,z=O.values,I=z.length;L<I-1;L++){var Q=z[L],F=z[L-1],G=z[L+1];var M=d.splat(z[L].values),x=d.splat(z[L+1].values);var B=d.zip(M,x);var E=0,D=0;C.push({id:K+Q.label,name:Q.label,data:{value:B,"$valueArray":B,"$colorArray":J,"$stringArray":R,"$next":G.label,"$prev":F?F.label:false,"$config":P,"$gradient":y},children:[]})}var H={id:K+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:C};N.loadJSON(H);this.normalizeDims();N.compute();N.select(N.root);if(A){N.fx.animate({modes:["node-property:height:dimArray"],duration:1500})}},updateJSON:function(H,y){if(this.busy){return}this.busy=true;var E=this.delegate,G=E.graph,B=H.label&&d.splat(H.label),F=H.values,x=this.config.animate,D=this,C={};for(var A=0,z=F.length;A<z;A++){C[F[A].label]=F[A]}G.eachNode(function(M){var I=C[M.name],J=M.getData("stringArray"),L=M.getData("valueArray"),K=M.getData("next");if(I){I.values=d.splat(I.values);d.each(L,function(N,O){N[0]=I.values[O];if(B){J[O]=B[O]}});M.setData("valueArray",L)}if(K){I=C[K];if(I){d.each(L,function(N,O){N[1]=I.values[O]})}}});this.normalizeDims();E.compute();E.select(E.root);if(x){E.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){D.busy=false;y&&y.onComplete()}})}},filter:function(A,B){if(this.busy){return}this.busy=true;if(this.config.Tips.enable){this.delegate.tips.hide()}this.select(false,false,false);var y=d.splat(A);var x=this.delegate.graph.getNode(this.delegate.root);var z=this;this.normalizeDims();x.eachAdjacency(function(C){var F=C.nodeTo,E=F.getData("dimArray","end"),D=F.getData("stringArray");F.setData("dimArray",d.map(E,function(H,G){return(d.indexOf(y,D[G])>-1)?H:[0,0]}),"end")});this.delegate.fx.animate({modes:["node-property:dimArray"],duration:1500,onComplete:function(){z.busy=false;B&&B.onComplete()}})},restore:function(y){if(this.busy){return}this.busy=true;if(this.config.Tips.enable){this.delegate.tips.hide()}this.select(false,false,false);this.normalizeDims();var x=this;this.delegate.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){x.busy=false;y&&y.onComplete()}})},select:function(C,y,x){if(!this.config.selectOnHover){return}var z=this.selected;if(z.id!=C||z.name!=y||z.index!=x){z.id=C;z.name=y;z.index=x;this.delegate.graph.eachNode(function(D){D.setData("border",false)});if(C){var B=this.delegate.graph.getNode(C);B.setData("border",z);var A=x===0?"prev":"next";A=B.getData(A);if(A){B=this.delegate.graph.getByName(A);if(B){B.setData("border",{name:y,index:1-x})}}}this.delegate.plot()}},getLegend:function(){var z={};var A;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(B){A=B.nodeTo});var y=A.getData("colorArray"),x=y.length;d.each(A.getData("stringArray"),function(C,B){z[C]=y[B%x]});return z},getMaxValue:function(){var x=0;this.delegate.graph.eachNode(function(C){var z=C.getData("valueArray"),y=0,B=0;d.each(z,function(D){y+=+D[0];B+=+D[1]});var A=B>y?B:y;x=x>A?x:A});return x},normalizeDims:function(){var D=this.delegate.graph.getNode(this.delegate.root),A=0;D.eachAdjacency(function(){A++});var C=this.getMaxValue()||1,G=this.delegate.canvas.getSize(),z=this.config,B=z.Margin,E=z.labelOffset+z.Label.size,x=(G.width-(B.left+B.right))/A,y=z.animate,F=G.height-(B.top+B.bottom)-(z.showAggregates&&E)-(z.showLabels&&E);this.delegate.graph.eachNode(function(M){var J=0,L=0,H=[];d.each(M.getData("valueArray"),function(N){J+=+N[0];L+=+N[1];H.push([0,0])});var K=L>J?L:J;M.setData("width",x);if(y){M.setData("height",K*F/C,"end");M.setData("dimArray",d.map(M.getData("valueArray"),function(N){return[N[0]*F/C,N[1]*F/C]}),"end");var I=M.getData("dimArray");if(!I){M.setData("dimArray",H)}}else{M.setData("height",K*F/C);M.setData("dimArray",d.map(M.getData("valueArray"),function(N){return[N[0]*F/C,N[1]*F/C]}))}})}});o.BarChart={$extend:true,animate:true,type:"stacked",labelOffset:3,barsOffset:0,hoveredColor:"#9fd4ff",orientation:"horizontal",showAggregates:true,showLabels:true,Tips:{enable:false,onShow:d.empty,onHide:d.empty},Events:{enable:false,onClick:d.empty}};$jit.ST.Plot.NodeTypes.implement({"barchart-stacked":{render:function(S,D){var I=S.pos.getc(true),R=S.getData("width"),P=S.getData("height"),N=this.getAlignedPos(I,R,P),M=N.x,L=N.y,O=S.getData("dimArray"),G=S.getData("valueArray"),F=S.getData("colorArray"),C=F.length,Z=S.getData("stringArray");var U=D.getCtx(),z={},V=S.getData("border"),A=S.getData("gradient"),ab=S.getData("config"),B=ab.orientation=="horizontal",E=ab.showAggregates,Q=ab.showLabels,K=ab.Label;if(F&&O&&Z){for(var Y=0,T=O.length,X=0,H=0;Y<T;Y++){U.fillStyle=U.strokeStyle=F[Y%C];if(A){var aa;if(B){aa=U.createLinearGradient(M+X+O[Y]/2,L,M+X+O[Y]/2,L+P)}else{aa=U.createLinearGradient(M,L-X-O[Y]/2,M+R,L-X-O[Y]/2)}var W=d.rgbToHex(d.map(d.hexToRgb(F[Y%C].slice(1)),function(x){return(x*0.5)>>0}));aa.addColorStop(0,W);aa.addColorStop(0.5,F[Y%C]);aa.addColorStop(1,W);U.fillStyle=aa}if(B){U.fillRect(M+X,L,O[Y],P)}else{U.fillRect(M,L-X-O[Y],R,O[Y])}if(V&&V.name==Z[Y]){z.acum=X;z.dimValue=O[Y]}X+=(O[Y]||0);H+=(G[Y]||0)}if(V){U.save();U.lineWidth=2;U.strokeStyle=V.color;if(B){U.strokeRect(M+z.acum+1,L+1,z.dimValue-2,P-2)}else{U.strokeRect(M+1,L-z.acum-z.dimValue+1,R-2,z.dimValue-2)}U.restore()}if(K.type=="Native"){U.save();U.fillStyle=U.strokeStyle=K.color;U.font=K.style+" "+K.size+"px "+K.family;U.textBaseline="middle";var J=E(S.name,H,S);if(J!==false){J=J!==true?J:H;if(B){U.textAlign="right";U.fillText(J,M+X-ab.labelOffset,L+P/2)}else{U.textAlign="center";U.fillText(J,M+R/2,L-P-K.size/2-ab.labelOffset)}}if(Q(S.name,H,S)){if(B){U.textAlign="center";U.translate(M-ab.labelOffset-K.size/2,L+P/2);U.rotate(Math.PI/2);U.fillText(S.name,0,0)}else{U.textAlign="center";U.fillText(S.name,M+R/2,L+K.size/2+ab.labelOffset)}}U.restore()}}},contains:function(E,G){var J=E.pos.getc(true),B=E.getData("width"),O=E.getData("height"),N=this.getAlignedPos(J,B,O),M=N.x,K=N.y,P=E.getData("dimArray"),C=E.getData("config"),A=G.x-M,z=C.orientation=="horizontal";if(z){if(G.x<M||G.x>M+B||G.y>K+O||G.y<K){return false}}else{if(G.x<M||G.x>M+B||G.y>K||G.y<K-O){return false}}for(var H=0,F=P.length,L=(z?M:K);H<F;H++){var D=P[H];if(z){L+=D;var I=L;if(G.x<=I){return{name:E.getData("stringArray")[H],color:E.getData("colorArray")[H],value:E.getData("valueArray")[H],label:E.name}}}else{L-=D;var I=L;if(G.y>=I){return{name:E.getData("stringArray")[H],color:E.getData("colorArray")[H],value:E.getData("valueArray")[H],label:E.name}}}}return false}},"barchart-grouped":{render:function(U,D){var J=U.pos.getc(true),T=U.getData("width"),R=U.getData("height"),O=this.getAlignedPos(J,T,R),N=O.x,M=O.y,Q=U.getData("dimArray"),H=U.getData("valueArray"),aa=H.length,G=U.getData("colorArray"),C=G.length,ac=U.getData("stringArray");var W=D.getCtx(),z={},X=U.getData("border"),A=U.getData("gradient"),ae=U.getData("config"),B=ae.orientation=="horizontal",F=ae.showAggregates,S=ae.showLabels,L=ae.Label,E=(B?R:T)/aa;if(G&&Q&&ac){for(var ab=0,V=aa,Z=0,I=0;ab<V;ab++){W.fillStyle=W.strokeStyle=G[ab%C];if(A){var ad;if(B){ad=W.createLinearGradient(N+Q[ab]/2,M+E*ab,N+Q[ab]/2,M+E*(ab+1))}else{ad=W.createLinearGradient(N+E*ab,M-Q[ab]/2,N+E*(ab+1),M-Q[ab]/2)}var Y=d.rgbToHex(d.map(d.hexToRgb(G[ab%C].slice(1)),function(x){return(x*0.5)>>0}));ad.addColorStop(0,Y);ad.addColorStop(0.5,G[ab%C]);ad.addColorStop(1,Y);W.fillStyle=ad}if(B){W.fillRect(N,M+E*ab,Q[ab],E)}else{W.fillRect(N+E*ab,M-Q[ab],E,Q[ab])}if(X&&X.name==ac[ab]){z.acum=E*ab;z.dimValue=Q[ab]}Z+=(Q[ab]||0);I+=(H[ab]||0)}if(X){W.save();W.lineWidth=2;W.strokeStyle=X.color;if(B){W.strokeRect(N+1,M+z.acum+1,z.dimValue-2,E-2)}else{W.strokeRect(N+z.acum+1,M-z.dimValue+1,E-2,z.dimValue-2)}W.restore()}if(L.type=="Native"){W.save();W.fillStyle=W.strokeStyle=L.color;W.font=L.style+" "+L.size+"px "+L.family;W.textBaseline="middle";var K=F(U.name,I,U);if(K!==false){K=K!==true?K:I;if(B){W.textAlign="right";W.fillText(K,N+Math.max.apply(null,Q)-ae.labelOffset,M+R/2)}else{W.textAlign="center";W.fillText(K,N+T/2,M-Math.max.apply(null,Q)-L.size/2-ae.labelOffset)}}var P=S(U.name,I,U);if(P!==false){P=P!==true?P:U.name;if(B){W.textAlign="center";W.translate(N-ae.labelOffset-L.size/2,M+R/2);W.rotate(Math.PI/2);W.fillText(P,0,0)}else{W.textAlign="center";W.fillText(P,N+T/2,M+L.size/2+ae.labelOffset)}}W.restore()}}},contains:function(K,G){var C=K.pos.getc(true),J=K.getData("width"),I=K.getData("height"),F=this.getAlignedPos(C,J,I),E=F.x,D=F.y,H=K.getData("dimArray"),N=H.length,Q=K.getData("config"),B=G.x-E,z=Q.orientation=="horizontal",A=(z?I:J)/N;if(z){if(G.x<E||G.x>E+J||G.y>D+I||G.y<D){return false}}else{if(G.x<E||G.x>E+J||G.y>D||G.y<D-I){return false}}for(var M=0,L=H.length;M<L;M++){var P=H[M];if(z){var O=D+A*M;if(G.x<=E+P&&G.y>=O&&G.y<=O+A){return{name:K.getData("stringArray")[M],color:K.getData("colorArray")[M],value:K.getData("valueArray")[M],label:K.name}}}else{var O=E+A*M;if(G.x>=O&&G.x<=O+A&&G.y>=D-P){return{name:K.getData("stringArray")[M],color:K.getData("colorArray")[M],value:K.getData("valueArray")[M],label:K.name}}}}return false}}});$jit.BarChart=new r({st:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(z){this.controller=this.config=d.merge(o("Canvas","Margin","Label","BarChart"),{Label:{type:"Native"}},z);var A=this.config.showLabels,y=d.type(A),B=this.config.showAggregates,x=d.type(B);this.config.showLabels=y=="function"?A:d.lambda(A);this.config.showAggregates=x=="function"?B:d.lambda(B);this.initializeViz()},initializeViz:function(){var y=this.config,C=this;var x=y.type.split(":")[0],E=y.orientation=="horizontal",B={};var A=new $jit.ST({injectInto:y.injectInto,width:y.width,height:y.height,orientation:E?"left":"bottom",levelDistance:0,siblingOffset:y.barsOffset,subtreeOffset:0,withLabels:y.Label.type!="Native",useCanvas:y.useCanvas,Label:{type:y.Label.type},Node:{overridable:true,type:"barchart-"+x,align:"left",width:1,height:1},Edge:{type:"none"},Tips:{enable:y.Tips.enable,type:"Native",force:true,onShow:function(I,H,F){var G=F;y.Tips.onShow(I,G,H)}},Events:{enable:true,type:"Native",onClick:function(H,I,F){if(!y.Events.enable){return}var G=I.getContains();y.Events.onClick(G,I,F)},onMouseMove:function(H,I,F){if(!y.hoveredColor){return}if(H){var G=I.getContains();C.select(H.id,G.name,G.index)}else{C.select(false,false,false)}}},onCreateLabel:function(K,I){var Q=y.Label,O=I.getData("valueArray"),N=d.reduce(O,function(R,S){return R+S},0);var M={wrapper:document.createElement("div"),aggregate:document.createElement("div"),label:document.createElement("div")};var F=M.wrapper,P=M.label,G=M.aggregate,H=F.style,L=P.style,J=G.style;B[I.id]=M;F.appendChild(P);F.appendChild(G);if(!y.showLabels(I.name,N,I)){L.display="none"}if(!y.showAggregates(I.name,N,I)){J.display="none"}H.position="relative";H.overflow="visible";H.fontSize=Q.size+"px";H.fontFamily=Q.family;H.color=Q.color;H.textAlign="center";J.position=L.position="absolute";K.style.width=I.getData("width")+"px";K.style.height=I.getData("height")+"px";J.left=L.left="0px";P.innerHTML=I.name;K.appendChild(F)},onPlaceLabel:function(V,Q){if(!B[Q.id]){return}var U=B[Q.id],H=U.wrapper.style,F=U.label.style,P=U.aggregate.style,W=y.type.split(":")[0]=="grouped",G=y.orientation=="horizontal",L=Q.getData("dimArray"),J=Q.getData("valueArray"),N=(W&&G)?Math.max.apply(null,L):Q.getData("width"),M=(W&&!G)?Math.max.apply(null,L):Q.getData("height"),K=parseInt(H.fontSize,10),O=V.style;if(L&&J){H.width=P.width=F.width=V.style.width=N+"px";for(var T=0,R=J.length,S=0;T<R;T++){if(L[T]>0){S+=J[T]}}if(y.showLabels(Q.name,S,Q)){F.display=""}else{F.display="none"}var I=y.showAggregates(Q.name,S,Q);if(I!==false){P.display=""}else{P.display="none"}if(y.orientation=="horizontal"){P.textAlign="right";F.textAlign="left";F.textIndex=P.textIndent=y.labelOffset+"px";P.top=F.top=(M-K)/2+"px";V.style.height=H.height=M+"px"}else{P.top=(-K-y.labelOffset)+"px";F.top=(y.labelOffset+M)+"px";V.style.top=parseInt(V.style.top,10)-M+"px";V.style.height=H.height=M+"px"}U.aggregate.innerHTML=I!==true?I:S}}});var z=A.canvas.getSize(),D=y.Margin;if(E){A.config.offsetX=z.width/2-D.left-(y.showLabels&&(y.labelOffset+y.Label.size));A.config.offsetY=(D.bottom-D.top)/2}else{A.config.offsetY=-z.height/2+D.bottom+(y.showLabels&&(y.labelOffset+y.Label.size));A.config.offsetX=(D.right-D.left)/2}this.delegate=A;this.canvas=this.delegate.canvas},loadJSON:function(L){if(this.busy){return}this.busy=true;var I=d.time(),D=[],K=this.delegate,O=d.splat(L.label),H=d.splat(L.color||this.colors),M=this.config,x=!!M.type.split(":")[1],A=M.animate,z=M.orientation=="horizontal",B=this;for(var J=0,y=L.values,F=y.length;J<F;J++){var N=y[J];var C=d.splat(y[J].values);var G=0;if(typeof N.id=="undefined"){N.id=N.label}D.push({id:I+N.id,name:N.label,data:{value:C,"$valueArray":C,"$colorArray":H,"$stringArray":O,"$gradient":x,"$config":M},children:[]})}var E={id:I+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:D};K.loadJSON(E);this.normalizeDims();K.compute();K.select(K.root);if(A){if(z){K.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){B.busy=false}})}else{K.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){B.busy=false}})}}else{this.busy=false}},updateJSON:function(z,D){if(this.busy){return}this.busy=true;this.select(false,false,false);var A=this.delegate;var C=A.graph;var y=z.values;var x=this.config.animate;var B=this;var E=this.config.orientation=="horizontal";d.each(y,function(F){var G=C.getByName(F.label);if(G){G.setData("valueArray",d.splat(F.values));if(z.label){G.setData("stringArray",d.splat(z.label))}}});this.normalizeDims();A.compute();A.select(A.root);if(x){if(E){A.fx.animate({modes:["node-property:width:dimArray"],duration:1500,onComplete:function(){B.busy=false;D&&D.onComplete()}})}else{A.fx.animate({modes:["node-property:height:dimArray"],duration:1500,onComplete:function(){B.busy=false;D&&D.onComplete()}})}}},select:function(z,x){if(!this.config.hoveredColor){return}var y=this.selected;if(y.id!=z||y.name!=x){y.id=z;y.name=x;y.color=this.config.hoveredColor;this.delegate.graph.eachNode(function(A){if(z==A.id){A.setData("border",y)}else{A.setData("border",false)}});this.delegate.plot()}},getLegend:function(){var z={};var A;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(B){A=B.nodeTo});var y=A.getData("colorArray"),x=y.length;d.each(A.getData("stringArray"),function(C,B){z[C]=y[B%x]});return z},getMaxValue:function(){var y=0,x=this.config.type.split(":")[0]=="stacked";this.delegate.graph.eachNode(function(B){var z=B.getData("valueArray"),A=0;if(!z){return}if(x){d.each(z,function(C){A+=+C})}else{A=Math.max.apply(null,z)}y=y>A?y:A});return y},setBarType:function(x){this.config.type=x;this.delegate.config.Node.type="barchart-"+x.split(":")[0]},normalizeDims:function(){var H=this.delegate.graph.getNode(this.delegate.root),C=0;H.eachAdjacency(function(){C++});var E=this.getMaxValue()||1,K=this.delegate.canvas.getSize(),A=this.config,D=A.Margin,I=D.left+D.right,B=D.top+D.bottom,y=A.orientation=="horizontal",x=(K[y?"height":"width"]-(y?B:I)-(C-1)*A.barsOffset)/C,z=A.animate,J=K[y?"width":"height"]-(y?I:B)-(!y&&A.showAggregates&&(A.Label.size+A.labelOffset))-(A.showLabels&&(A.Label.size+A.labelOffset)),G=y?"height":"width",F=y?"width":"height";this.delegate.graph.eachNode(function(O){var N=0,L=[];d.each(O.getData("valueArray"),function(P){N+=+P;L.push(0)});O.setData(G,x);if(z){O.setData(F,N*J/E,"end");O.setData("dimArray",d.map(O.getData("valueArray"),function(P){return P*J/E}),"end");var M=O.getData("dimArray");if(!M){O.setData("dimArray",L)}}else{O.setData(F,N*J/E);O.setData("dimArray",d.map(O.getData("valueArray"),function(P){return P*J/E}))}})}});o.PieChart={$extend:true,animate:true,offset:25,sliceOffset:0,labelOffset:3,type:"stacked",hoveredColor:"#9fd4ff",Events:{enable:false,onClick:d.empty},Tips:{enable:false,onShow:d.empty,onHide:d.empty},showLabels:true,resizeLabels:false,updateHeights:false};h.Radial=new r({compute:function(y){var z=d.splat(y||["current","start","end"]);g.compute(this.graph,z,this.config);this.graph.computeLevels(this.root,0,"ignore");var x=this.createLevelDistanceFunc();this.computeAngularWidths(z);this.computePositions(z,x)},computePositions:function(E,B){var G=E;var F=this.graph;var C=F.getNode(this.root);var D=this.parent;var x=this.config;for(var z=0,y=G.length;z<y;z++){var A=G[z];C.setPos(l(0,0),A);C.setData("span",Math.PI*2,A)}C.angleSpan={begin:0,end:2*Math.PI};F.eachBFS(this.root,function(L){var R=L.angleSpan.end-L.angleSpan.begin;var T=L.angleSpan.begin;var S=B(L);var U=0,H=[],K={};L.eachSubnode(function(X){U+=X._treeAngularWidth;for(var Y=0,W=G.length;Y<W;Y++){var aa=G[Y],Z=X.getData("dim",aa);K[aa]=(aa in K)?(Z>K[aa]?Z:K[aa]):Z}H.push(X)},"ignore");if(D&&D.id==L.id&&H.length>0&&H[0].dist){H.sort(function(X,W){return(X.dist>=W.dist)-(X.dist<=W.dist)})}for(var N=0,P=H.length;N<P;N++){var J=H[N];if(!J._flag){var V=J._treeAngularWidth/U*R;var I=T+V/2;for(var O=0,M=G.length;O<M;O++){var Q=G[O];J.setPos(l(I,S),Q);J.setData("span",V,Q);J.setData("dim-quotient",J.getData("dim",Q)/K[Q],Q)}J.angleSpan={begin:T,end:T+V};T+=V}}},"ignore")},setAngularWidthForNodes:function(x){this.graph.eachBFS(this.root,function(A,y){var z=A.getData("angularWidth",x[0])||5;A._angularWidth=z/y},"ignore")},setSubtreesAngularWidth:function(){var x=this;this.graph.eachNode(function(y){x.setSubtreeAngularWidth(y)},"ignore")},setSubtreeAngularWidth:function(A){var z=this,y=A._angularWidth,x=0;A.eachSubnode(function(B){z.setSubtreeAngularWidth(B);x+=B._treeAngularWidth},"ignore");A._treeAngularWidth=Math.max(y,x)},computeAngularWidths:function(x){this.setAngularWidthForNodes(x);this.setSubtreesAngularWidth()}});$jit.Sunburst=new r({Implements:[e,p,h.Radial],initialize:function(x){var z=$jit.Sunburst;var y={interpolation:"linear",levelDistance:100,Node:{type:"multipie",height:0},Edge:{type:"none"},Label:{textAlign:"start",textBaseline:"middle"}};this.controller=this.config=d.merge(o("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),y,x);var A=this.config;if(A.useCanvas){this.canvas=A.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(A.background){A.background=d.merge({type:"Circles"},A.background)}this.canvas=new m(this,A);this.config.labelContainer=(typeof A.injectInto=="string"?A.injectInto:A.injectInto.id)+"-label"}this.graphOptions={klass:b,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new z.Label[A.Label.type](this);this.fx=new z.Plot(this,z);this.op=new z.Op(this);this.json=null;this.root=null;this.rotated=null;this.busy=false;this.initializeExtras()},createLevelDistanceFunc:function(){var x=this.config.levelDistance;return function(y){return(y._depth+1)*x}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},rotate:function(z,A,y){var x=z.getPos(y.property||"current").getp(true).theta;this.rotated=z;this.rotateAngle(-x,A,y)},rotateAngle:function(z,C,y){var A=this;var x=d.merge(this.config,y||{},{modes:["polar"]});var B=y.property||(C==="animate"?"end":"current");if(C==="animate"){this.fx.animation.pause()}this.graph.eachNode(function(E){var D=E.getPos(B);D.theta+=z;if(D.theta<0){D.theta+=Math.PI*2}});if(C=="animate"){this.fx.animate(x)}else{if(C=="replot"){this.fx.plot();this.busy=false}}},plot:function(){this.fx.plot()}});$jit.Sunburst.$extend=true;(function(x){x.Op=new r({Implements:f.Op});x.Plot=new r({Implements:f.Plot});x.Label={};x.Label.Native=new r({Implements:f.Label.Native,initialize:function(y){this.viz=y;this.label=y.config.Label;this.config=y.config},renderLabel:function(C,E,G){var N=E.getData("span");if(N<Math.PI/2&&Math.tan(N)*this.config.levelDistance*E._depth<10){return}var O=C.getCtx();var A=O.measureText(E.name);if(E.id==this.viz.root){var M=-A.width/2,K=0,L=0;var z=0}else{var D=5;var z=G.levelDistance-D;var J=E.pos.clone();J.rho+=D;var B=J.getp(true);var H=J.getc(true);var M=H.x,K=H.y;var F=Math.PI;var I=(B.theta>F/2&&B.theta<3*F/2);var L=I?B.theta+F:B.theta;if(I){M-=Math.abs(Math.cos(B.theta)*A.width);K+=Math.sin(B.theta)*A.width}else{if(E.id==this.viz.root){M-=A.width/2}}}O.save();O.translate(M,K);O.rotate(L);O.fillText(E.name,0,0);O.restore()}});x.Label.SVG=new r({Implements:f.Label.SVG,initialize:function(y){this.viz=y},placeLabel:function(N,C,E){var J=C.pos.getc(true),M=this.viz,A=this.viz.canvas;var F=A.getSize();var B={x:Math.round(J.x+F.width/2),y:Math.round(J.y+F.height/2)};N.setAttribute("x",B.x);N.setAttribute("y",B.y);var G=N.getBBox();if(G){var L=N.getAttribute("x");var I=N.getAttribute("y");var z=C.pos.getp(true);var D=Math.PI;var H=(z.theta>D/2&&z.theta<3*D/2);if(H){N.setAttribute("x",L-G.width);N.setAttribute("y",I-G.height)}else{if(C.id==M.root){N.setAttribute("x",L-G.width/2)}}var K=H?z.theta+D:z.theta;if(C._depth){N.setAttribute("transform","rotate("+K*360/(2*D)+" "+L+" "+I+")")}}E.onPlaceLabel(N,C)}});x.Label.HTML=new r({Implements:f.Label.HTML,initialize:function(y){this.viz=y},placeLabel:function(H,B,D){var F=B.pos.clone(),z=this.viz.canvas,G=B.getData("height"),C=((G||B._depth==0)?G:this.viz.config.levelDistance)/2,E=z.getSize();F.rho+=C;F=F.getc(true);var A={x:Math.round(F.x+E.width/2),y:Math.round(F.y+E.height/2)};var y=H.style;y.left=A.x+"px";y.top=A.y+"px";y.display=this.fitsInCanvas(A,z)?"":"none";D.onPlaceLabel(H,B)}});x.Plot.NodeTypes=new r({none:{render:d.empty,contains:d.lambda(false),anglecontains:function(C,E){var B=C.getData("span")/2,z=C.pos.theta;var A=z-B,y=z+B;if(A<0){A+=Math.PI*2}var D=Math.atan2(E.y,E.x);if(D<0){D+=Math.PI*2}if(A>y){return(D>A&&D<=Math.PI*2)||D<y}else{return D>A&&D<y}}},pie:{render:function(D,B){var H=D.getData("span")/2,A=D.pos.theta;var C=A-H,E=A+H;var G=D.pos.getp(true);var y=new b(G.rho,C);var z=y.getc(true);y.theta=E;var F=y.getc(true);var I=B.getCtx();I.beginPath();I.moveTo(0,0);I.lineTo(z.x,z.y);I.moveTo(0,0);I.lineTo(F.x,F.y);I.moveTo(0,0);I.arc(0,0,G.rho*D.getData("dim-quotient"),C,E,false);I.fill()},contains:function(A,C){if(this.nodeTypes.none.anglecontains.call(this,A,C)){var y=Math.sqrt(C.x*C.x+C.y*C.y);var z=this.config.levelDistance,B=A._depth;return(y<=z*B)}return false}},multipie:{render:function(E,C){var L=E.getData("height");var F=L?L:this.config.levelDistance;var K=E.getData("span")/2,B=E.pos.theta;var D=B-K,H=B+K;var J=E.pos.getp(true);var z=new b(J.rho,D);var A=z.getc(true);z.theta=H;var I=z.getc(true);z.rho+=F;var y=z.getc(true);z.theta=D;var G=z.getc(true);var M=C.getCtx();M.moveTo(0,0);M.beginPath();M.arc(0,0,J.rho,D,H,false);M.arc(0,0,J.rho+F,H,D,true);M.moveTo(A.x,A.y);M.lineTo(G.x,G.y);M.moveTo(I.x,I.y);M.lineTo(y.x,y.y);M.fill();if(E.collapsed){M.save();M.lineWidth=2;M.moveTo(0,0);M.beginPath();M.arc(0,0,J.rho+F+5,H-0.01,D+0.01,true);M.stroke();M.restore()}},contains:function(B,E){if(this.nodeTypes.none.anglecontains.call(this,B,E)){var z=Math.sqrt(E.x*E.x+E.y*E.y);var y=B.getData("height");var C=y?y:this.config.levelDistance;var A=this.config.levelDistance,D=B._depth;return(z>=A*D)&&(z<=(A*D+C))}return false}},"gradient-multipie":{render:function(B,y){var G=y.getCtx();var F=B.getData("height");var C=F?F:this.config.levelDistance;var z=G.createRadialGradient(0,0,B.getPos().rho,0,0,B.getPos().rho+C);var E=d.hexToRgb(B.getData("color")),D=[];d.each(E,function(H){D.push(parseInt(H*0.5,10))});var A=d.rgbToHex(D);z.addColorStop(0,A);z.addColorStop(1,B.getData("color"));G.fillStyle=z;this.nodeTypes.multipie.render.call(this,B,y)},contains:function(y,z){return this.nodeTypes.multipie.contains.call(this,y,z)}},"gradient-pie":{render:function(D,A){var y=A.getCtx();var E=y.createRadialGradient(0,0,0,0,0,D.getPos().rho);var C=d.hexToRgb(D.getData("color")),z=[];d.each(C,function(F){z.push(parseInt(F*0.5,10))});var B=d.rgbToHex(z);E.addColorStop(1,B);E.addColorStop(0,D.getData("color"));y.fillStyle=E;this.nodeTypes.pie.render.call(this,D,A)},contains:function(y,z){return this.nodeTypes.pie.contains.call(this,y,z)}}});x.Plot.EdgeTypes=new r({none:d.empty,line:{render:function(y,z){var B=y.nodeFrom.pos.getc(true),A=y.nodeTo.pos.getc(true);this.edgeHelper.line.render(B,A,z)},contains:function(y,B){var A=y.nodeFrom.pos.getc(true),z=y.nodeTo.pos.getc(true);return this.edgeHelper.line.contains(A,z,B,this.edge.epsilon)}},arrow:{render:function(z,A){var E=z.nodeFrom.pos.getc(true),D=z.nodeTo.pos.getc(true),C=z.getData("dim"),B=z.data.$direction,y=(B&&B.length>1&&B[0]!=z.nodeFrom.id);this.edgeHelper.arrow.render(E,D,C,y,A)},contains:function(y,B){var A=y.nodeFrom.pos.getc(true),z=y.nodeTo.pos.getc(true);return this.edgeHelper.arrow.contains(A,z,B,this.edge.epsilon)}},hyperline:{render:function(y,z){var C=y.nodeFrom.pos.getc(),B=y.nodeTo.pos.getc(),A=Math.max(C.norm(),B.norm());this.edgeHelper.hyperline.render(C.$scale(1/A),B.$scale(1/A),A,z)},contains:d.lambda(false)}})})($jit.Sunburst);$jit.Sunburst.Plot.NodeTypes.implement({"piechart-stacked":{render:function(V,B){var U=V.pos.getp(true),D=V.getData("dimArray"),T=V.getData("valueArray"),H=V.getData("colorArray"),A=H.length,N=V.getData("stringArray"),Q=V.getData("span")/2,L=V.pos.theta,G=L-Q,K=L+Q,S=new b;var O=B.getCtx(),M={},J=V.getData("gradient"),E=V.getData("border"),aa=V.getData("config"),aj=aa.showLabels,Z=aa.resizeLabels,ac=aa.Label;var af=aa.sliceOffset*Math.cos((G+K)/2);var F=aa.sliceOffset*Math.sin((G+K)/2);if(H&&D&&N){for(var ag=0,ad=D.length,x=0,Y=0;ag<ad;ag++){var C=D[ag],ah=H[ag%A];if(C<=0){continue}O.fillStyle=O.strokeStyle=ah;if(J&&C){var ae=O.createRadialGradient(af,F,x+aa.sliceOffset,af,F,x+C+aa.sliceOffset);var y=d.hexToRgb(ah),X=d.map(y,function(am){return(am*0.8)>>0}),z=d.rgbToHex(X);ae.addColorStop(0,ah);ae.addColorStop(0.5,ah);ae.addColorStop(1,z);O.fillStyle=ae}S.rho=x+aa.sliceOffset;S.theta=G;var ai=S.getc(true);S.theta=K;var P=S.getc(true);S.rho+=C;var ak=S.getc(true);S.theta=G;var R=S.getc(true);O.beginPath();O.arc(af,F,x+0.01,G,K,false);O.arc(af,F,x+C+0.01,K,G,true);O.fill();if(E&&E.name==N[ag]){M.acum=x;M.dimValue=D[ag];M.begin=G;M.end=K}x+=(C||0);Y+=(T[ag]||0)}if(E){O.save();O.globalCompositeOperation="source-over";O.lineWidth=2;O.strokeStyle=E.color;var ab=G<K?1:-1;O.beginPath();O.arc(af,F,M.acum+0.01+1,M.begin,M.end,false);O.arc(af,F,M.acum+M.dimValue+0.01-1,M.end,M.begin,true);O.closePath();O.stroke();O.restore()}if(aj&&ac.type=="Native"){O.save();O.fillStyle=O.strokeStyle=ac.color;var W=Z?V.getData("normalizedDim"):1,I=(ac.size*W)>>0;I=I<+Z?+Z:I;O.font=ac.style+" "+I+"px "+ac.family;O.textBaseline="middle";O.textAlign="center";S.rho=x+aa.labelOffset+aa.sliceOffset;S.theta=V.pos.theta;var al=S.getc(true);O.fillText(V.name,al.x,al.y);O.restore()}}},contains:function(A,E){if(this.nodeTypes.none.anglecontains.call(this,A,E)){var G=Math.sqrt(E.x*E.x+E.y*E.y);var x=this.config.levelDistance,D=A._depth;var y=A.getData("config");if(G<=x*D+y.sliceOffset){var H=A.getData("dimArray");for(var C=0,B=H.length,F=y.sliceOffset;C<B;C++){var z=H[C];if(G>=F&&G<=F+z){return{name:A.getData("stringArray")[C],color:A.getData("colorArray")[C],value:A.getData("valueArray")[C],label:A.name}}F+=z}}return false}return false}}});$jit.PieChart=new r({sb:null,colors:["#416D9C","#70A35E","#EBB056","#C74243","#83548B","#909291","#557EAA"],selected:{},busy:false,initialize:function(x){this.controller=this.config=d.merge(o("Canvas","PieChart","Label"),{Label:{type:"Native"}},x);this.initializeViz()},initializeViz:function(){var y=this.config,C=this;var x=y.type.split(":")[0];var B=new $jit.Sunburst({injectInto:y.injectInto,width:y.width,height:y.height,useCanvas:y.useCanvas,withLabels:y.Label.type!="Native",Label:{type:y.Label.type},Node:{overridable:true,type:"piechart-"+x,width:1,height:1},Edge:{type:"none"},Tips:{enable:y.Tips.enable,type:"Native",force:true,onShow:function(G,F,D){var E=D;y.Tips.onShow(G,E,F)}},Events:{enable:true,type:"Native",onClick:function(F,G,D){if(!y.Events.enable){return}var E=G.getContains();y.Events.onClick(E,G,D)},onMouseMove:function(F,G,D){if(!y.hoveredColor){return}if(F){var E=G.getContains();C.select(F.id,E.name,E.index)}else{C.select(false,false,false)}}},onCreateLabel:function(G,F){var D=y.Label;if(y.showLabels){var E=G.style;E.fontSize=D.size+"px";E.fontFamily=D.family;E.color=D.color;E.textAlign="center";G.innerHTML=F.name}},onPlaceLabel:function(T,N){if(!y.showLabels){return}var H=N.pos.getp(true),K=N.getData("dimArray"),Q=N.getData("span")/2,I=N.pos.theta,S=I-Q,E=I+Q,V=new b;var M=y.showLabels,G=y.resizeLabels,J=y.Label;if(K){for(var R=0,O=K.length,P=0;R<O;R++){P+=K[R]}var U=G?N.getData("normalizedDim"):1,D=(J.size*U)>>0;D=D<+G?+G:D;T.style.fontSize=D+"px";V.rho=P+y.labelOffset+y.sliceOffset;V.theta=(S+E)/2;var H=V.getc(true);var F=C.canvas.getSize();var L={x:Math.round(H.x+F.width/2),y:Math.round(H.y+F.height/2)};T.style.left=L.x+"px";T.style.top=L.y+"px"}}});var A=B.canvas.getSize(),z=Math.min;B.config.levelDistance=z(A.width,A.height)/2-y.offset-y.sliceOffset;this.delegate=B;this.canvas=this.delegate.canvas;this.canvas.getCtx().globalCompositeOperation="lighter"},loadJSON:function(L){var I=d.time(),C=[],K=this.delegate,O=d.splat(L.label),E=O.length,H=d.splat(L.color||this.colors),z=H.length,M=this.config,x=!!M.type.split(":")[1],A=M.animate,G=E==1;for(var J=0,y=L.values,F=y.length;J<F;J++){var N=y[J];var B=d.splat(N.values);C.push({id:I+N.label,name:N.label,data:{value:B,"$valueArray":B,"$colorArray":G?d.splat(H[J%z]):H,"$stringArray":O,"$gradient":x,"$config":M,"$angularWidth":d.reduce(B,function(P,Q){return P+Q})},children:[]})}var D={id:I+"$root",name:"",data:{"$type":"none","$width":1,"$height":1},children:C};K.loadJSON(D);this.normalizeDims();K.refresh();if(A){K.fx.animate({modes:["node-property:dimArray"],duration:1500})}},updateJSON:function(z,D){if(this.busy){return}this.busy=true;var A=this.delegate;var C=A.graph;var y=z.values;var x=this.config.animate;var B=this;d.each(y,function(E){var G=C.getByName(E.label),F=d.splat(E.values);if(G){G.setData("valueArray",F);G.setData("angularWidth",d.reduce(F,function(H,I){return H+I}));if(z.label){G.setData("stringArray",d.splat(z.label))}}});this.normalizeDims();if(x){A.compute("end");A.fx.animate({modes:["node-property:dimArray:span","linear"],duration:1500,onComplete:function(){B.busy=false;D&&D.onComplete()}})}else{A.refresh()}},select:function(z,x){if(!this.config.hoveredColor){return}var y=this.selected;if(y.id!=z||y.name!=x){y.id=z;y.name=x;y.color=this.config.hoveredColor;this.delegate.graph.eachNode(function(A){if(z==A.id){A.setData("border",y)}else{A.setData("border",false)}});this.delegate.plot()}},getLegend:function(){var z={};var A;this.delegate.graph.getNode(this.delegate.root).eachAdjacency(function(B){A=B.nodeTo});var y=A.getData("colorArray"),x=y.length;d.each(A.getData("stringArray"),function(C,B){z[C]=y[B%x]});return z},getMaxValue:function(){var x=0;this.delegate.graph.eachNode(function(A){var y=A.getData("valueArray"),z=0;d.each(y,function(B){z+=+B});x=x>z?x:z});return x},normalizeDims:function(){var y=this.delegate.graph.getNode(this.delegate.root),x=0;y.eachAdjacency(function(){x++});var C=this.getMaxValue()||1,B=this.config,z=B.animate,A=this.delegate.config.levelDistance;this.delegate.graph.eachNode(function(H){var G=0,D=[];d.each(H.getData("valueArray"),function(I){G+=+I;D.push(1)});var F=(D.length==1)&&!B.updateHeights;if(z){H.setData("dimArray",d.map(H.getData("valueArray"),function(I){return F?A:(I*A/C)}),"end");var E=H.getData("dimArray");if(!E){H.setData("dimArray",D)}}else{H.setData("dimArray",d.map(H.getData("valueArray"),function(I){return F?A:(I*A/C)}))}H.setData("normalizedDim",G/C)})}});h.TM={};h.TM.SliceAndDice=new r({compute:function(C){var y=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(y);var A=this.canvas.getSize(),z=this.config,B=A.width,x=A.height;this.graph.computeLevels(this.root,0,"ignore");y.getPos(C).setc(-B/2,-x/2);y.setData("width",B,C);y.setData("height",x+z.titleHeight,C);this.computePositions(y,y,this.layout.orientation,C);this.controller.onAfterCompute(y)},computePositions:function(H,F,Q,z){var O=0;H.eachSubnode(function(S){O+=S.getData("area",z)});var R=this.config,C=R.offset,L=H.getData("width",z),J=Math.max(H.getData("height",z)-R.titleHeight,0),y=H==F?1:(F.getData("area",z)/O);var K,I,N,D,B,G,E;var P=(Q=="h");if(P){Q="v";K=J;I=L*y;N="height";D="y";B="x";G=R.titleHeight;E=0}else{Q="h";K=J*y;I=L;N="width";D="x";B="y";G=0;E=R.titleHeight}var x=F.getPos(z);F.setData("width",I,z);F.setData("height",K,z);var M=0,A=this;F.eachSubnode(function(T){var S=T.getPos(z);S[D]=M+x[D]+G;S[B]=x[B]+E;A.computePositions(F,T,Q,z);M+=T.getData(N,z)})}});h.TM.Area={compute:function(x){x=x||"current";var D=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root);this.controller.onBeforeCompute(D);var z=this.config,G=this.canvas.getSize(),y=G.width,F=G.height,E=z.offset,A=y-E,C=F-E;this.graph.computeLevels(this.root,0,"ignore");D.getPos(x).setc(-y/2,-F/2);D.setData("width",y,x);D.setData("height",F,x);var B={top:-F/2+z.titleHeight+E/2,left:-y/2+E/2,width:A,height:C-z.titleHeight};this.computePositions(D,B,x);this.controller.onAfterCompute(D)},computeDim:function(B,C,E,A,z,x){if(B.length+C.length==1){var y=(B.length==1)?B:C;this.layoutLast(y,E,A,x);return}if(B.length>=2&&C.length==0){C=[B.shift()]}if(B.length==0){if(C.length>0){this.layoutRow(C,E,A,x)}return}var D=B[0];if(z(C,E)>=z([D].concat(C),E)){this.computeDim(B.slice(1),C.concat([D]),E,A,z,x)}else{var F=this.layoutRow(C,E,A,x);this.computeDim(B,[],F.dim,F,z,x)}},worstAspectRatio:function(x,F){if(!x||x.length==0){return Number.MAX_VALUE}var y=0,G=0,B=Number.MAX_VALUE;for(var D=0,C=x.length;D<C;D++){var z=x[D]._area;y+=z;B=B<z?B:z;G=G>z?G:z}var E=F*F,A=y*y;return Math.max(E*G/A,A/(E*B))},avgAspectRatio:function(B,y){if(!B||B.length==0){return Number.MAX_VALUE}var D=0;for(var z=0,x=B.length;z<x;z++){var C=B[z]._area;var A=C/y;D+=y>A?y/A:A/y}return D/x},layoutLast:function(y,x,B,A){var z=y[0];z.getPos(A).setc(B.left,B.top);z.setData("width",B.width,A);z.setData("height",B.height,A)}};h.TM.Squarified=new r({Implements:h.TM.Area,computePositions:function(B,E,y){var A=this.config,G=Math.max;if(E.width>=E.height){this.layout.orientation="h"}else{this.layout.orientation="v"}var x=B.getSubnodes([1,1],"ignore");if(x.length>0){this.processChildrenLayout(B,x,E,y);for(var D=0,C=x.length;D<C;D++){var H=x[D],I=A.offset,J=G(H.getData("height",y)-I-A.titleHeight,0),z=G(H.getData("width",y)-I,0),F=H.getPos(y);E={width:z,height:J,top:F.y+A.titleHeight+I/2,left:F.x+I/2};this.computePositions(H,E,y)}}},processChildrenLayout:function(H,x,D,y){var B=D.width*D.height;var C,z=x.length,E=0,I=[];for(C=0;C<z;C++){I[C]=parseFloat(x[C].getData("area",y));E+=I[C]}for(C=0;C<z;C++){x[C]._area=B*I[C]/E}var A=this.layout.horizontal()?D.height:D.width;x.sort(function(K,J){var L=J._area-K._area;return L?L:(J.id==K.id?0:(J.id<K.id?1:-1))});var G=[x[0]];var F=x.slice(1);this.squarify(F,G,A,D,y)},squarify:function(y,B,x,A,z){this.computeDim(y,B,x,A,this.worstAspectRatio,z)},layoutRow:function(y,x,A,z){if(this.layout.horizontal()){return this.layoutV(y,x,A,z)}else{return this.layoutH(y,x,A,z)}},layoutV:function(x,J,E,y){var K=0,A=function(L){return L};d.each(x,function(L){K+=L._area});var z=A(K/J)||0,G=0;for(var C=0,B=x.length;C<B;C++){var D=A(x[C]._area/z)||0;var H=x[C];var F=d.getDir()==="rtl"?(-1*E.left)-z:E.left;H.getPos(y).setc(F,E.top+G);H.setData("width",z,y);H.setData("height",D,y);G+=D}var I={height:E.height,width:E.width-z,top:E.top,left:E.left+z};I.dim=Math.min(I.width,I.height);if(I.dim!=I.height){this.layout.change()}return I},layoutH:function(x,H,C,y){var J=0;d.each(x,function(K){J+=K._area});var I=J/H||0,E=C.top,z=0;for(var B=0,A=x.length;B<A;B++){var F=x[B];var H=F._area/I||0;var D=d.getDir()==="rtl"?(-1*(C.left+z))-H:C.left+z;F.getPos(y).setc(D,E);F.setData("width",H,y);F.setData("height",I,y);z+=H}var G={height:C.height-I,width:C.width,top:C.top+I,left:C.left};G.dim=Math.min(G.width,G.height);if(G.dim!=G.width){this.layout.change()}return G},layoutLast:function(z,y,C,B){var A=z[0];var x=d.getDir()==="rtl"?-1*C.left-C.width:C.left;A.getPos(B).setc(x,C.top);A.setData("width",C.width,B);A.setData("height",C.height,B)}});h.TM.Strip=new r({Implements:h.TM.Area,computePositions:function(B,E,y){var x=B.getSubnodes([1,1],"ignore"),A=this.config,G=Math.max;if(x.length>0){this.processChildrenLayout(B,x,E,y);for(var D=0,C=x.length;D<C;D++){var H=x[D];var I=A.offset,J=G(H.getData("height",y)-I-A.titleHeight,0),z=G(H.getData("width",y)-I,0);var F=H.getPos(y);E={width:z,height:J,top:F.y+A.titleHeight+I/2,left:F.x+I/2};this.computePositions(H,E,y)}}},processChildrenLayout:function(H,x,C,y){var A=C.width*C.height;var B,z=x.length,D=0,I=[];for(B=0;B<z;B++){I[B]=+x[B].getData("area",y);D+=I[B]}for(B=0;B<z;B++){x[B]._area=A*I[B]/D}var G=this.layout.horizontal()?C.width:C.height;var F=[x[0]];var E=x.slice(1);this.stripify(E,F,G,C,y)},stripify:function(y,B,x,A,z){this.computeDim(y,B,x,A,this.avgAspectRatio,z)},layoutRow:function(y,x,A,z){if(this.layout.horizontal()){return this.layoutH(y,x,A,z)}else{return this.layoutV(y,x,A,z)}},layoutV:function(x,G,D,y){var H=0;d.each(x,function(I){H+=I._area});var z=H/G||0,E=0;for(var B=0,A=x.length;B<A;B++){var F=x[B];var C=F._area/z||0;F.getPos(y).setc(D.left,D.top+(G-C-E));F.setData("width",z,y);F.setData("height",C,y);E+=C}return{height:D.height,width:D.width-z,top:D.top,left:D.left+z,dim:G}},layoutH:function(x,F,C,y){var H=0;d.each(x,function(J){H+=J._area});var G=H/F||0,D=C.height-G,z=0;for(var B=0,A=x.length;B<A;B++){var E=x[B];var I=E._area/G||0;E.getPos(y).setc(C.left+z,C.top+D);E.setData("width",I,y);E.setData("height",G,y);z+=I}return{height:C.height-G,width:C.width,top:C.top,left:C.left,dim:F}}});h.TM.Voronoi=new r({Implements:h.TM.Area,compute:function(E){this.controller.onBeforeCompute(y);var y=this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root),A=this.canvas.getSize(),z=this.config,D=z.offset,C=A.width,x=A.height;this.graph.computeLevels(this.root,0,0);y.getPos(E).setc(-5,-5);if(!y.histoPos){y.histoPos=[]}y.histoPos[0]=s(0,0);var B=[s(-C*0.5,-x*0.5),s(C*0.5,-x*0.5),s(C*0.5,x*0.5),s(-C*0.5,x*0.5)];B=Geometry.offsetConvex(B,-D*0.5);y.setData("vertices",B,E);y.setData("width",0,E);y.setData("height",0,E);B=Geometry.offsetConvex(B,-D*1.5);this.computePositions(y,B,E,0);this.controller.onAfterCompute(y)},computePositions:function(A,B,x,y){var G=this,C=A.getSubnodes([1,1],"ignore"),z=this.config,D=z.offset,F=A.histoPos[y]||c(0,0),E,H;A.setData("width",0,x);A.setData("height",0,x);A.getPos(x).setc(F.x,F.y);if(C.length>0){if(!C[0].histoPos||!C[0].histoPos[y+1]){E=$jit.util.map(C,function(I){var J=Geometry.randPointInPolygon(B);if(I.data&&I.data.$area){J.area=I.data.$area}return J});E=G[G.config.centroidType](E,B);$jit.util.each(E,function(J,I){if(!C[I].histoPos){C[I].histoPos=[]}C[I].histoPos[y+1]=J})}E=$jit.util.map(C,function(I){return I.histoPos[y+1]});H=Geometry.voronoi(E,B);$jit.util.each(C,function(L,K){var J=H[K];var I=J.slice(0);if(Geometry.area(J)<0){J.reverse()}if(D){I=Geometry.offsetConvex(J,-D*2);J=Geometry.offsetConvex(J,-D*0.5);L.offset=D}L.setData("vertices",J,x);G.computePositions(L,I,x,y+1)})}},centroid:function(A,z){var y=2,x;while(y>0.001){x=Geometry.voronoi(A,z);y=0;A=x.map(function(C,B){var D=Geometry.centroid(C);y+=Geometry.dist2(D,A[B]);return D})}return A},doLayoutPressure:function(){var y=this,x=y.graph.getNode(y.clickedNode&&y.clickedNode.id||y.root);x.eachNode(function(){})},weightedCentroid:function(A,y){var G=[];var z=2,B,E=Geometry.area(y),x=0,D;d.each(A,function(H,I){x+=H.area});D=E/x;B=Geometry.voronoi(A,y);d.each(B,function(I,H){G[H]=A[H].area*D/Geometry.area(I)});var F=0,C=0;d.each(G,function(I,H){F+=I;C+=I*I});console.log("from "+(C-F*F/G.length)/G.length);while(z>0.001){B=Geometry.voronoi(A,y);d.each(B,function(I,H){G[H]=A[H].area*D/Geometry.area(I)});z=0;A=B.map(function(I,H){var K=s(0,0),J=0;d.each(I,function(M,O){var P=[A[H],M,I[O+1]||I[0]],N=(M.attached)?G[M.attached[0]]:1,L=Geometry.area(P)*Math.exp((G[H]-N)*2);J+=L;K.$add(M.add(P[2]).scale(0.5*L))});K.$scale(1/J);K.area=A[H].area;z+=Geometry.dist(K,A[H]);return K})}var F=0,C=0;d.each(G,function(I,H){F+=I;C+=I*I});console.log("to "+(C-F*F/G.length)/G.length);return A},byArea:function(D,B){D=this.centroid(D,B);var z=0,y=0,x,C,x;$jit.util.each(D,function(E){z+=E.area});z=Geometry.area(B)/z;for(;y<100;y++){x=Geometry.voronoi(D,B);for(var A=0;A<D.length;A++){if(x[A].length==0){D=x.map(function(F,E){return Geometry.centroid(F)});break}}C=x.map(function(F,E){return F.area*z/(Geometry.area(F)+1e-10)});x=Geometry.voronoi(D,B);D=x.map(function(H,G){var E=s(D[G].x,D[G].y),I,F;E.area=D[G].area;I=s(0,0);$jit.util.each(H,function(P,M){var N=(P.attached)?P.attached:-1,J=(P.attached)?C[P.attached[0]]:1,L=P,O=H[M+1]||H[0],K=(C[G]-J),R=O.x-L.x,Q=O.y-L.y;I.x+=Q*K;I.y-=R*K});E.x+=I.x/10;E.y+=I.y/10;E.tp=I;return E})}return D}});h.Icicle=new r({compute:function(F){F=F||"current";var E=this.graph.getNode(this.root),A=this.config,I=this.canvas.getSize(),x=I.width,H=I.height,B=A.offset,D=A.constrained?A.levelsToShow:Number.MAX_VALUE;this.controller.onBeforeCompute(E);f.Util.computeLevels(this.graph,E.id,0,"ignore");var G=0;f.Util.eachLevel(E,0,false,function(K,J){if(J>G){G=J}});var z=this.graph.getNode(this.clickedNode&&this.clickedNode.id||E.id);var y=Math.min(G,D-1);var C=z._depth;if(this.layout.horizontal()){this.computeSubtree(z,-x/2,-H/2,x/(y+1),H,C,y,F)}else{this.computeSubtree(z,-x/2,-H/2,x,H/(y+1),C,y,F)}},computeSubtree:function(H,J,G,z,M,F,B,I){H.getPos(I).setc(J,G);H.setData("width",z,I);H.setData("height",M,I);var D,L=0,K=0;var A=f.Util.getSubnodes(H,[1,1],"ignore");if(!A.length){return}d.each(A,function(x){K+=x.getData("dim")});for(var E=0,C=A.length;E<C;E++){if(this.layout.horizontal()){D=M*A[E].getData("dim")/K;this.computeSubtree(A[E],J+z,G,z,D,F,B,I);G+=D}else{D=z*A[E].getData("dim")/K;this.computeSubtree(A[E],J,G+M,D,M,F,B,I);J+=D}}}});$jit.Icicle=new r({Implements:[e,p,h.Icicle],layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(x){var y={animate:false,orientation:"h",offset:2,levelsToShow:Number.MAX_VALUE,constrained:false,Node:{type:"rectangle",overridable:true},Edge:{type:"none"},Label:{type:"Native"},duration:700,fps:45};var A=o("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label");this.controller=this.config=d.merge(A,y,x);this.layout.orientation=this.config.orientation;var z=this.config;if(z.useCanvas){this.canvas=z.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{this.canvas=new m(this,z);this.config.labelContainer=(typeof z.injectInto=="string"?z.injectInto:z.injectInto.id)+"-label"}this.graphOptions={klass:q,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge,this.config.Label);this.labels=new $jit.Icicle.Label[this.config.Label.type](this);this.fx=new $jit.Icicle.Plot(this,$jit.Icicle);this.op=new $jit.Icicle.Op(this);this.group=new $jit.Icicle.Group(this);this.clickedNode=null;this.initializeExtras()},refresh:function(){var x=this.config.Label.type;if(x!="Native"){var y=this;this.graph.eachNode(function(z){y.labels.hideLabel(z,false)})}this.compute();this.plot()},plot:function(){this.fx.plot(this.config)},enter:function(A){if(this.busy){return}this.busy=true;var z=this,y=this.config,x=A;var B={onComplete:function(){if(y.request){z.compute()}if(y.animate){z.graph.nodeList.setDataset(["current","end"],{alpha:[1,0]});f.Util.eachSubgraph(A,function(C){C.setData("alpha",1,"end")},"ignore");z.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){z.clickedNode=A;z.compute("end");z.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){z.busy=false;z.clickedNode=A}})}})}else{z.clickedNode=A;z.busy=false;z.refresh()}}};if(y.request){this.requestNodes(A,B)}else{B.onComplete()}},out:function(){if(this.busy){return}var y=this,z=f.Util,x=this.config,E=this.graph,B=z.getParents(E.getNode(this.clickedNode&&this.clickedNode.id||this.root)),C=B[0],F=C,A=this.clickedNode,D;this.busy=true;this.events.hoveredNode=false;if(!C){this.busy=false;return}D={onComplete:function(){y.clickedNode=C;if(x.request){y.requestNodes(C,{onComplete:function(){y.compute();y.plot();y.busy=false}})}else{y.compute();y.plot();y.busy=false}}};if(x.animate){this.clickedNode=F;this.compute("end");this.clickedNode=A;this.fx.animate({modes:["linear","node-property:width:height"],duration:1000,onComplete:function(){y.clickedNode=F;E.nodeList.setDataset(["current","end"],{alpha:[0,1]});z.eachSubgraph(A,function(G){G.setData("alpha",1)},"ignore");y.fx.animate({duration:500,modes:["node-property:alpha"],onComplete:function(){D.onComplete()}})}})}else{D.onComplete()}},requestNodes:function(z,A){var y=d.merge(this.controller,A),x=this.config.constrained?this.config.levelsToShow:Number.MAX_VALUE;if(y.request){var C=[],B=z._depth;f.Util.eachLevel(z,0,x,function(D){if(D.drawn&&!f.Util.anySubnode(D)){C.push(D);D._level=D._depth-B}});this.group.requestNodes(C,y)}else{y.onComplete()}}});$jit.Icicle.Op=new r({Implements:f.Op});$jit.Icicle.Group=new r({initialize:function(x){this.viz=x;this.canvas=x.canvas;this.config=x.config},requestNodes:function(C,B){var A=0,y=C.length,E={};var z=function(){B.onComplete()};var x=this.viz;if(y==0){z()}for(var D=0;D<y;D++){E[C[D].id]=C[D];B.request(C[D].id,C[D]._level,{onComplete:function(G,F){if(F&&F.children){F.id=G;x.op.sum(F,{type:"nothing"})}if(++A==y){f.Util.computeLevels(x.graph,x.root,0);z()}}})}}});$jit.Icicle.Plot=new r({Implements:f.Plot,plot:function(B,z){B=B||this.viz.controller;var x=this.viz,C=x.graph,y=C.getNode(x.clickedNode&&x.clickedNode.id||x.root),A=y._depth;x.canvas.clear();this.plotTree(y,d.merge(B,{withLabels:true,hideLabels:false,plotSubtree:function(D,E){return !x.config.constrained||(E._depth-A<x.config.levelsToShow)}}),z)}});$jit.Icicle.Label={};$jit.Icicle.Label.Native=new r({Implements:f.Label.Native,renderLabel:function(y,z,B){var E=y.getCtx(),x=z.getData("width"),D=z.getData("height"),F=z.getLabelData("size"),A=E.measureText(z.name);if(D<(F*1.5)||x<A.width){return}var C=z.pos.getc(true);E.fillText(z.name,C.x+x/2,C.y+D/2)}});$jit.Icicle.Label.SVG=new r({Implements:f.Label.SVG,initialize:function(x){this.viz=x},placeLabel:function(y,B,z){var D=B.pos.getc(true),A=this.viz.canvas;var x=A.getSize();var C={x:Math.round(D.x+x.width/2),y:Math.round(D.y+x.height/2)};y.setAttribute("x",C.x);y.setAttribute("y",C.y);z.onPlaceLabel(y,B)}});$jit.Icicle.Label.HTML=new r({Implements:f.Label.HTML,initialize:function(x){this.viz=x},placeLabel:function(y,C,z){var E=C.pos.getc(true),A=this.viz.canvas;var x=A.getSize();var D={x:Math.round(E.x+x.width/2),y:Math.round(E.y+x.height/2)};var B=y.style;B.left=D.x+"px";B.top=D.y+"px";B.display="";z.onPlaceLabel(y,C)}});$jit.Icicle.Plot.NodeTypes=new r({none:{render:d.empty},rectangle:{render:function(A,y,L){var z=this.viz.config;var D=z.offset;var x=A.getData("width");var I=A.getData("height");var C=A.getData("border");var H=A.pos.getc(true);var G=H.x+D/2,E=H.y+D/2;var K=y.getCtx();if(x-D<2||I-D<2){return}if(z.cushion){var B=A.getData("color");var J=K.createRadialGradient(G+(x-D)/2,E+(I-D)/2,1,G+(x-D)/2,E+(I-D)/2,x<I?I:x);var F=d.rgbToHex(d.map(d.hexToRgb(B),function(M){return M*0.3>>0}));J.addColorStop(0,B);J.addColorStop(1,F);K.fillStyle=J}if(C){K.strokeStyle=C;K.lineWidth=3}K.fillRect(G,E,Math.max(0,x-D),Math.max(0,I-D));C&&K.strokeRect(H.x,H.y,x,I)},contains:function(z,B){if(this.viz.clickedNode&&!$jit.Graph.Util.isDescendantOf(z,this.viz.clickedNode.id)){return false}var A=z.pos.getc(true),y=z.getData("width"),x=z.getData("height");return this.nodeHelper.rectangle.contains({x:A.x+y/2,y:A.y+x/2},B,y,x)}}});$jit.Icicle.Plot.EdgeTypes=new r({none:d.empty});QuadTreeNode=new r({com:[0,0],children:[null,null,null,null],hasChildren:false,mass:null,fItem:null});QuadTreeNodeFactory=new r({maxNodes:50000,nodes:null,setup:function(){this.nodes=new Array()},getQuadTreeNode:function(){if(this.nodes.length>0){return this.nodes.pop()}else{return new QuadTreeNode()}},reclaim:function(x){x.mass=0;x.com[0]=0;x.com[1]=0;x.fItem=null;x.hasChildren=false;x.children=[null,null,null,null];if(this.nodes.length<this.maxNodes){this.nodes.push(x)}}});NBodyForce=new r({pnames:["GravitationalConstant","Distance","BarnesHutTheta"],DEFAULT_GRAV_CONSTANT:-1,DEFAULT_MIN_GRAV_CONSTANT:-10,DEFAULT_MAX_GRAV_CONSTANT:10,DEFAULT_DISTANCE:-1,DEFAULT_MIN_DISTANCE:-1,DEFAULT_MAX_DISTANCE:500,DEFAULT_THETA:0.9,DEFAULT_MIN_THETA:0,DEFAULT_MAX_THETA:1,GRAVITATIONAL_CONST:0,MIN_DISTANCE:1,BARNES_HUT_THETA:2,xMin:null,xMax:null,yMin:null,yMax:null,params:null,minValues:null,maxValues:null,factory:null,root:null,setup:function(){this.params=[this.DEFAULT_GRAV_CONSTANT,this.DEFAULT_DISTANCE,this.DEFAULT_THETA];this.minValues=[this.DEFAULT_MIN_GRAV_CONSTANT,this.DEFAULT_MIN_DISTANCE,this.DEFAULT_MIN_THETA];this.maxValues=[this.DEFAULT_MAX_GRAV_CONSTANT,this.DEFAULT_MAX_DISTANCE,this.DEFAULT_MAX_THETA];this.factory=new QuadTreeNodeFactory();this.factory.setup();this.root=this.factory.getQuadTreeNode()},setBounds:function(y,x,A,z){this.xMin=y;this.yMin=x;this.xMax=A;this.yMax=z},insertHelper:function(A,C,B,I,z,H){var J=A.location[0];var G=A.location[1];var F=(B+z)/2;var E=(I+H)/2;var D=(J>=F?1:0)+(G>=E?2:0);if(C.children[D]==null){C.children[D]=this.factory.getQuadTreeNode();C.hasChildren=true}if(D==1||D==3){B=F}else{z=F}if(D>1){I=E}else{H=E}this.insert(A,C.children[D],B,I,z,H)},isSameLocation:function(A,z){var y=Math.abs(A.location[0]-z.location[0]);var x=Math.abs(A.location[1]-z.location[1]);return(y<0.01&&x<0.01)},insert:function(C,D,z,B,y,A){if(D.hasChildren){this.insertHelper(C,D,z,B,y,A)}else{if(D.fItem!=null){if(this.isSameLocation(D.fItem,C)){this.insertHelper(C,D,z,B,y,A)}else{var x=D.fItem;D.fItem=null;this.insertHelper(x,D,z,B,y,A);this.insertHelper(C,D,z,B,y,A)}}else{D.fItem=C}}},calcMass:function(A){var z=0;var x=0;A.mass=0;if(A.hasChildren){for(var y=0;y<A.children.length;y++){if(A.children[y]!=null){this.calcMass(A.children[y]);A.mass+=A.children[y].mass;z+=A.children[y].mass*A.children[y].com[0];x+=A.children[y].mass*A.children[y].com[1]}}}if(A.fItem!=null){A.mass+=A.fItem.mass;z+=A.fItem.mass*A.fItem.location[0];x+=A.fItem.mass*A.fItem.location[1]}A.com[0]=z/A.mass;A.com[1]=x/A.mass},insertRoot:function(x){this.insert(x,this.root,this.xMin,this.yMin,this.xMax,this.yMax)},clearHelper:function(y){for(var x=0;x<y.children.length;x++){if(y.children[x]!=null){this.clearHelper(y.children[x])}}this.factory.reclaim(y)},clear:function(){this.clearHelper(this.root);this.root=this.factory.getQuadTreeNode()},init:function(B){this.clear();var A=Number.MAX_VALUE;var F=Number.MAX_VALUE;var z=Number.MIN_VALUE;var E=Number.MIN_VALUE;for(var C=0;C<B.items.length;C++){var G=B.items[C].location[0];var D=B.items[C].location[1];if(G<A){A=G}if(D<F){F=D}if(G>z){z=G}if(D>E){E=D}}var I=z-A;var H=E-F;if(I>H){E=F+I}else{z=A+H}this.setBounds(A,F,z,E);for(var C=0;C<B.items.length;C++){this.insertRoot(B.items[C])}this.calcMass(this.root)},getForce:function(x){this.forceHelper(x,this.root,this.xMin,this.yMin,this.xMax,this.yMax)},forceHelper:function(J,A,z,G,y,E){var L=A.com[0]-J.location[0];var K=A.com[1]-J.location[1];var x=Math.sqrt(L*L+K*K);var F=false;if(x==0){L=(Math.random()-0.5)/50;K=(Math.random()-0.5)/50;x=Math.sqrt(L*L+K*K);F=true}var H=this.params[this.MIN_DISTANCE]>0&&x>this.params[this.MIN_DISTANCE];if((!A.hasChildren&&A.fItem!=J)||(!F&&(y-z)/x<this.params[this.BARNES_HUT_THETA])){if(H){return}var I=this.params[this.GRAVITATIONAL_CONST]*J.mass*A.mass/(x*x*x);J.force[0]+=I*L;J.force[1]+=I*K}else{if(A.hasChildren){var D=(z+y)/2;var C=(G+E)/2;for(var B=0;B<A.children.length;B++){if(A.children[B]!=null){this.forceHelper(J,A.children[B],(B==1||B==3?D:z),(B>1?C:G),(B==1||B==3?y:D),(B>1?E:C))}}if(H){return}if(A.fItem!=null&&A.fItem!=J){var I=this.params[this.GRAVITATIONAL_CONST]*J.mass*A.fItem.mass/(x*x*x);J.force[0]+=I*L;J.force[1]+=I*K}}}}});SpringForce=new r({pnames:["SpringCoefficient","DefaultSpringLength"],DEFAULT_SPRING_COEFF:0.0001,DEFAULT_MAX_SPRING_COEFF:0.001,DEFAULT_MIN_SPRING_COEFF:0.00001,DEFAULT_SPRING_LENGTH:50,DEFAULT_MIN_SPRING_LENGTH:0,DEFAULT_MAX_SPRING_LENGTH:200,SPRING_COEFF:0,SPRING_LENGTH:1,params:null,minValues:null,maxValues:null,setup:function(){this.params=[this.DEFAULT_SPRING_COEFF,this.DEFAULT_SPRING_LENGTH];this.minValues=[this.DEFAULT_MIN_SPRING_COEFF,this.DEFAULT_MIN_SPRING_LENGTH];this.maxValues=[this.DEFAULT_MAX_SPRING_COEFF,this.DEFAULT_MAX_SPRING_LENGTH]},getForce:function(J){var D=J.item1;var C=J.item2;var A=(J.length<0?this.params[this.SPRING_LENGTH]:J.length);var z=D.location[0];var G=D.location[1];var y=C.location[0];var F=C.location[1];var I=y-z;var H=F-G;var x=Math.sqrt(I*I+H*H);if(x==0){I=(Math.random()-0.5)/50;H=(Math.random()-0.5)/50;x=Math.sqrt(I*I+H*H)}var E=x-A;var B=(J.coeff<0?this.params[this.SPRING_COEFF]:J.coeff)*E/x;D.force[0]+=B*I;D.force[1]+=B*H;C.force[0]+=-B*I;C.force[1]+=-B*H},init:function(){}});DragForce=new r({pnames:["DragCoefficient"],DEFAULT_DRAG_COEFF:0.01,DEFAULT_MIN_DRAG_COEFF:0,DEFAULT_MAX_DRAG_COEFF:0.1,DRAG_COEFF:0,params:null,minValues:null,maxValues:null,setup:function(){this.params=[this.DEFAULT_DRAG_COEFF];this.minValues=[this.DEFAULT_MIN_DRAG_COEFF];this.maxValues=[this.DEFAULT_MAX_DRAG_COEFF]},getForce:function(x){x.force[0]-=this.params[this.DRAG_COEFF]*x.velocity[0];x.force[1]-=this.params[this.DRAG_COEFF]*x.velocity[1]},init:function(){}});RungeKuttaIntegrator=new r({integrate:function(G,y){var z=G.speedLimit;var F,E,H,D;var B,A;for(var C=0;C<G.items.length;C++){var I=G.items[C];D=y/I.mass;B=I.k;A=I.l;I.plocation[0]=I.location[0];I.plocation[1]=I.location[1];B[0][0]=y*I.velocity[0];B[0][1]=y*I.velocity[1];A[0][0]=D*I.force[0];A[0][1]=D*I.force[1];I.location[0]+=0.5*B[0][0];I.location[1]+=0.5*B[0][1]}G.accumulate();for(var C=0;C<G.items.length;C++){var I=G.items[C];D=y/I.mass;B=I.k;A=I.l;F=I.velocity[0]+0.5*A[0][0];E=I.velocity[1]+0.5*A[0][1];H=Math.sqrt(F*F+E*E);if(H>z){F=z*F/H;E=z*E/H}B[1][0]=y*F;B[1][1]=y*E;A[1][0]=D*I.force[0];A[1][1]=D*I.force[1];I.location[0]=I.plocation[0]+0.5*B[1][0];I.location[1]=I.plocation[1]+0.5*B[1][1]}G.accumulate();for(var C=0;C<G.items.length;C++){var I=G.items[C];D=y/I.mass;B=I.k;A=I.l;F=I.velocity[0]+0.5*A[1][0];E=I.velocity[1]+0.5*A[1][1];H=Math.sqrt(F*F+E*E);if(H>z){F=z*F/H;E=z*E/H}B[2][0]=y*F;B[2][1]=y*E;A[2][0]=D*I.force[0];A[2][1]=D*I.force[1];I.location[0]=I.plocation[0]+0.5*B[2][0];I.location[1]=I.plocation[1]+0.5*B[2][1]}G.accumulate();for(var C=0;C<G.items.length;C++){var I=G.items[C];D=y/I.mass;B=I.k;A=I.l;var x=I.plocation;F=I.velocity[0]+A[2][0];E=I.velocity[1]+A[2][1];H=Math.sqrt(F*F+E*E);if(H>z){F=z*F/H;E=z*E/H}B[3][0]=y*F;B[3][1]=y*E;A[3][0]=D*I.force[0];A[3][1]=D*I.force[1];I.location[0]=x[0]+(B[0][0]+B[3][0])/6+(B[1][0]+B[2][0])/3;I.location[1]=x[1]+(B[0][1]+B[3][1])/6+(B[1][1]+B[2][1])/3;F=(A[0][0]+A[3][0])/6+(A[1][0]+A[2][0])/3;E=(A[0][1]+A[3][1])/6+(A[1][1]+A[2][1])/3;H=Math.sqrt(F*F+E*E);if(H>z){F=z*F/H;E=z*E/H}I.velocity[0]+=F;I.velocity[1]+=E}}});ForceSimulator=new r({speedLimit:1,iflen:0,sflen:0,integrator:null,items:null,springs:null,iforces:null,sforces:null,setup:function(){this.items=new Array();this.springs=new Array();this.iforces=new Array();this.sforces=new Array();this.integrator=new RungeKuttaIntegrator()},accumulate:function(){for(var y=0;y<this.iforces.length;y++){this.iforces[y].init(this)}for(var y=0;y<this.sforces.length;y++){this.sforces[y].init(this)}for(var y=0;y<this.items.length;y++){this.items[y].force[0]=0;this.items[y].force[1]=0;for(var x=0;x<this.iforces.length;x++){this.iforces[x].getForce(this.items[y])}}for(var y=0;y<this.springs.length;y++){for(var x=0;x<this.sforces.length;x++){this.sforces[x].getForce(this.springs[y])}}},runSimulator:function(x){this.accumulate();this.integrator.integrate(this,x)},addForce:function(x,y){if(y){this.iforces.push(x);this.iflen++}else{this.sforces.push(x);this.sflen++}},addItem:function(x){this.items.push(x)},addSpring:function(x){this.springs.push(x)}});Spring=new r({item1:null,item2:null,coeff:null,length:null,setup:function(A,z,y,x){this.item1=A;this.item2=z;this.coeff=y;this.length=x}});ForceItem=new r({mass:1,force:null,velocity:null,location:null,plocation:null,k:[[0,0],[0,0],[0,0],[0,0]],l:[[0,0],[0,0],[0,0],[0,0]],setup:function(){this.force=new Array();this.velocity=new Array();this.location=new Array();this.plocation=new Array()},init:function(y,x){this.force[0]=0;this.force[1]=0;this.velocity[0]=0;this.velocity[1]=0;this.location[0]=y;this.location[1]=x;this.plocation[0]=0;this.plocation[1]=0}});h.ForceDirected=new r({getOptions:function(D){var B=this.canvas.getSize();var y=B.width,A=B.height;var C=0;this.graph.eachNode(function(F){C++});var E=y*A/C,z=Math.sqrt(E);var x=this.config.levelDistance;return{width:y-x,height:A-x,tstart:y*0.1,nodef:function(F){return E/(F||1)},edgef:function(F){return z*(F-x)}}},compute:function(y,z){var A=d.splat(y||["current","start","end"]);var x=this.getOptions();g.compute(this.graph,A,this.config);this.graph.computeLevels(this.root,0,"ignore");this.graph.eachNode(function(B){d.each(A,function(C){var D=B.getPos(C);if(D.equals(q.KER)){D.x=x.width/5*(Math.random()-0.5);D.y=x.height/5*(Math.random()-0.5)}B.disp={};d.each(A,function(E){B.disp[E]=s(0,0)})})});this.computePositions(A,x,z)},computePositions:function(B,z,C){var D=this.config.iterations,y=0,A=this;if(C){(function x(){for(var F=C.iter,E=0;E<F;E++){z.t=z.tstart;if(D){z.t*=(1-y++/(D-1))}A.computePositionStep(B,z);if(D&&y>=D){C.onComplete();return}}C.onStep(Math.round(y/(D-1)*100));setTimeout(x,1)})()}else{for(;y<D;y++){z.t=z.tstart*(1-y/(D-1));this.computePositionStep(B,z)}}},computePositionStep:function(E,x){var F=this.graph;var z=Math.min,D=Math.max;var C=s(0,0);F.eachNode(function(H){d.each(E,function(I){H.disp[I].x=0;H.disp[I].y=0});F.eachNode(function(I){if(I.id!=H.id){d.each(E,function(M){var K=H.getPos(M),J=I.getPos(M);C.x=K.x-J.x;C.y=K.y-J.y;var L=C.norm()||1;H.disp[M].$add(C.$scale(x.nodef(L)/L))})}})});var y=!!F.getNode(this.root).visited;F.eachNode(function(H){H.eachAdjacency(function(I){var J=I.nodeTo;if(!!J.visited===y){d.each(E,function(N){var L=H.getPos(N),K=J.getPos(N);C.x=L.x-K.x;C.y=L.y-K.y;var M=C.norm()||1;H.disp[N].$add(C.$scale(-x.edgef(M)/M));J.disp[N].$add(C.$scale(-1))})}});H.visited=!y});var G=x.t,A=x.width/2,B=x.height/2;F.eachNode(function(H){d.each(E,function(K){var I=H.disp[K];var J=I.norm()||1;var K=H.getPos(K);K.$add(s(I.x*z(Math.abs(I.x),G)/J,I.y*z(Math.abs(I.y),G)/J));K.x=z(A,D(-A,K.x));K.y=z(B,D(-B,K.y))})})},computeFast:function(K,E){var G=new ForceSimulator();G.setup();var N=new NBodyForce();N.setup();var L=new SpringForce();L.setup();var D=new DragForce();D.setup();G.addForce(N,true);G.addForce(L,false);G.addForce(D,true);var B=1000;var y=d.splat(K||["current","start","end"]);var A=this.getOptions();var I=[];g.compute(this.graph,y,this.config);this.graph.computeLevels(this.root,0,"ignore");this.graph.eachNode(function(O){d.each(y,function(P){var Q=O.getPos(P);Q.x=A.width/2;Q.y=A.height/2;O.forceItem=new ForceItem();O.forceItem.setup();O.forceItem.init(Q.x,Q.y);G.addItem(O.forceItem);O.disp={};d.each(y,function(R){O.disp[R]=s(0,0)})})});this.graph.eachNode(function(O){O.eachAdjacency(function(P){if(I[P.nodeTo.id]===undefined){var Q=new Spring();Q.setup(P.nodeFrom.forceItem,P.nodeTo.forceItem,-1,-1);G.addSpring(Q);I[P.nodeFrom.id]=[];I[P.nodeFrom.id][P.nodeTo.id]=true}})});var z=Math.ceil(this.config.iterations/E.iter);var H=0;var J=0;var x=this.config.iterations;var C=0;var M=this.graph;(function F(){for(var X=E.iter,W=0;W<X;W++){A.t=A.tstart;if(x){A.t*=(1-C++/(x-1))}B*=(1-C/x);var S=B+50;G.runSimulator(S);if(x&&C>=x){var R=0;var Z=0;var Q=A.width/2;var Y=A.height/2;M.eachNode(function(ab){d.each(y,function(ah){var ad=ab.forceItem.location[0];var aj=ab.forceItem.location[1];var ac=ab.getData("dim")*2;var ag=ab.getData("dim")*2;var ae=ab.disp[ah];var af=ae.norm()||1;var ai=ab.getPos(ah);ai.x=ad;ai.y=aj})});E.onComplete();var P=-Number.MAX_VALUE;var V=Number.MAX_VALUE;var O=-Number.MAX_VALUE;var U=Number.MAX_VALUE;M.eachNode(function(ab){d.each(y,function(ad){var ac=ab.getPos(ad);if(ac.x>P){P=ac.x}if(ac.x<V){V=ac.x}if(ac.y>O){O=ac.y}if(ac.y<U){U=ac.y}})});var aa;var T;if(P<0){T=Math.ceil(Math.floor(Math.abs(V))-Math.floor(Math.abs(P)))}else{if(V>=0){T=Math.ceil(P-V)}else{T=Math.ceil(P+Math.abs(V))}}if(O<0){aa=Math.ceil(Math.floor(Math.abs(U))-Math.floor(Math.abs(O)))}else{if(U>=0){aa=Math.ceil(O-U)}else{aa=Math.ceil(O+Math.abs(U))}}var Q=A.width/2;var Y=A.height/2;M.eachNode(function(ab){d.each(y,function(ae){var ac=ab.getPos(ae);var ad=ab.getData("dim");if(V<0){ac.x=((ac.x+Math.abs(V))*(A.width/T))-(A.width/2)}else{ac.x=((ac.x-V)*(A.width/T))-(A.width/2)}if(ac.x<=-Q+ad){ac.x=-Q+(ad*2)}if(ac.x>=Q-ad){ac.x=Q-(ad*2)}if(U<0){ac.y=((ac.y+Math.abs(U))*(A.height/aa))-(A.height/2)}else{ac.y=((ac.y-U)*(A.height/aa))-(A.height/2)}if(ac.y<=-Y+ad){ac.y=-Y+(ad*2)}if(ac.y>=Y-ad){ac.y=Y-(ad*2)}})});return}}E.onStep(Math.round(C/(x-1)*100));setTimeout(F,1)})()}});$jit.ForceDirected=new r({Implements:[e,p,h.ForceDirected],initialize:function(y){var x=$jit.ForceDirected;var z={iterations:50,levelDistance:50};this.controller=this.config=d.merge(o("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),z,y);var A=this.config;if(A.useCanvas){this.canvas=A.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(A.background){A.background=d.merge({type:"Circles"},A.background)}this.canvas=new m(this,A);this.config.labelContainer=(typeof A.injectInto=="string"?A.injectInto:A.injectInto.id)+"-label"}this.graphOptions={klass:q,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new x.Label[A.Label.type](this);this.fx=new x.Plot(this,x);this.op=new x.Op(this);this.json=null;this.busy=false;this.initializeExtras()},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},computeIncremental:function(x){x=d.merge({iter:20,property:"end",onStep:d.empty,onComplete:d.empty},x||{});this.config.onBeforeCompute(this.graph.getNode(this.root));this.compute(x.property,x)},computePrefuse:function(x){x=d.merge({iter:20,property:"end",onStep:d.empty,onComplete:d.empty},x||{});this.config.onBeforeCompute(this.graph.getNode(this.root));this.computeFast(x.property,x)},plot:function(){this.fx.plot()},animate:function(x){this.fx.animate(d.merge({modes:["linear"]},x||{}))}});$jit.ForceDirected.$extend=true;(function(x){x.Op=new r({Implements:f.Op});x.Plot=new r({Implements:f.Plot});x.Label={};x.Label.Native=new r({Implements:f.Label.Native});x.Label.SVG=new r({Implements:f.Label.SVG,initialize:function(y){this.viz=y},placeLabel:function(I,C,D){var G=C.pos.getc(true),z=this.viz.canvas,A=z.translateOffsetX,y=z.translateOffsetY,H=z.scaleOffsetX,F=z.scaleOffsetY,E=z.getSize();var B={x:Math.round(G.x*H+A+E.width/2),y:Math.round(G.y*F+y+E.height/2)};I.setAttribute("x",B.x);I.setAttribute("y",B.y);D.onPlaceLabel(I,C)}});x.Label.HTML=new r({Implements:f.Label.HTML,initialize:function(y){this.viz=y},placeLabel:function(J,D,E){var H=D.pos.getc(true),A=this.viz.canvas,B=A.translateOffsetX,z=A.translateOffsetY,I=A.scaleOffsetX,G=A.scaleOffsetY,F=A.getSize();var C={x:Math.round(H.x*I+B+F.width/2),y:Math.round(H.y*G+z+F.height/2)};var y=J.style;y.left=C.x+"px";y.top=C.y+"px";y.display=this.fitsInCanvas(C,A)?"":"none";E.onPlaceLabel(J,D)}});x.Plot.NodeTypes=new r({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.circle.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.circle.contains(A,B,z)}},ellipse:{render:function(B,z){var C=B.pos.getc(true),A=B.getData("width"),y=B.getData("height");this.nodeHelper.ellipse.render("fill",C,A,y,z)},contains:function(A,C){var B=A.pos.getc(true),z=A.getData("width"),y=A.getData("height");return this.nodeHelper.ellipse.contains(B,C,z,y)}},square:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.square.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.square.contains(A,B,z)}},rectangle:{render:function(B,z){var C=B.pos.getc(true),A=B.getData("width"),y=B.getData("height");this.nodeHelper.rectangle.render("fill",C,A,y,z)},contains:function(A,C){var B=A.pos.getc(true),z=A.getData("width"),y=A.getData("height");return this.nodeHelper.rectangle.contains(B,C,z,y)}},triangle:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.triangle.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.triangle.contains(A,B,z)}},star:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.star.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.star.contains(A,B,z)}}});x.Plot.EdgeTypes=new r({none:d.empty,line:{render:function(y,z){var B=y.nodeFrom.pos.getc(true),A=y.nodeTo.pos.getc(true);this.edgeHelper.line.render(B,A,z)},contains:function(y,B){var A=y.nodeFrom.pos.getc(true),z=y.nodeTo.pos.getc(true);return this.edgeHelper.line.contains(A,z,B,this.edge.epsilon)}},arrow:{render:function(z,A){var E=z.nodeFrom.pos.getc(true),D=z.nodeTo.pos.getc(true),C=z.getData("dim"),B=z.data.$direction,y=(B&&B.length>1&&B[0]!=z.nodeFrom.id);this.edgeHelper.arrow.render(E,D,C,y,A)},contains:function(y,B){var A=y.nodeFrom.pos.getc(true),z=y.nodeTo.pos.getc(true);return this.edgeHelper.arrow.contains(A,z,B,this.edge.epsilon)}}})})($jit.ForceDirected);$jit.TM={};var w=$jit.TM;$jit.TM.$extend=true;w.Base={layout:{orientation:"h",vertical:function(){return this.orientation=="v"},horizontal:function(){return this.orientation=="h"},change:function(){this.orientation=this.vertical()?"h":"v"}},initialize:function(x){var y={orientation:"h",titleHeight:13,offset:2,levelsToShow:0,labelsToShow:[0,-1],constrained:false,animate:false,Node:{type:"rectangle",overridable:true,width:3,height:3,color:"#444",props:"node-property:width:height"},Label:{textAlign:"center",textBaseline:"top"},Edge:{type:"none"},duration:700,fps:45};this.controller=this.config=d.merge(o("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),y,x);this.layout.orientation=this.config.orientation;var z=this.config;if(z.useCanvas){this.canvas=z.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(z.background){z.background=d.merge({type:"Circles"},z.background)}this.canvas=new m(this,z);this.config.labelContainer=(typeof z.injectInto=="string"?z.injectInto:z.injectInto.id)+"-label"}this.graphOptions={klass:q,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new w.Label[z.Label.type](this);this.fx=new w.Plot(this);this.op=new w.Op(this);this.group=new w.Group(this);this.geom=new w.Geom(this);this.clickedNode=null;this.busy=false;this.initializeExtras()},refresh:function(){if(this.busy){return}this.busy=true;var y=this;if(this.config.animate){this.compute("end");this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root));this.fx.animate(d.merge(this.config,{modes:["linear",this.config.Node.props],onComplete:function(){y.busy=false}}))}else{var x=this.config.Label.type;if(x!="Native"){this.graph.eachNode(function(z){y.labels.hideLabel(z,false)})}this.busy=false;this.compute();this.geom.setRightLevelToShow(this.graph.getNode(this.clickedNode&&this.clickedNode.id||this.root));this.plot()}},plot:function(){this.fx.plot()},leaf:function(x){return x.getSubnodes([1,1],"ignore").length==0},enter:function(D){if(this.busy){return}this.busy=true;var z=this,y=this.config,B=this.graph,x=D,A=this.clickedNode;var C={onComplete:function(){z.geom.setRightLevelToShow(D);if(y.request){z.compute()}if(y.animate){B.nodeList.setData("alpha",0,"end");D.eachSubgraph(function(E){E.setData("alpha",1,"end");E.selected=false},"ignore");x.selected=true;z.fx.animate({duration:z.config.duration/3,modes:["node-property:alpha"],onComplete:function(){z.clickedNode=x;z.compute("end");z.clickedNode=A;z.fx.animate({duration:2*z.config.duration/3,modes:["linear",z.config.Node.props],onComplete:function(){z.busy=false;z.clickedNode=x;z.geom.setRightLevelToShow(x)}})}})}else{z.busy=false;z.clickedNode=D;z.refresh()}}};this.geom.setRightLevelToShow(D);if(y.request){this.requestNodes(x,C)}else{C.onComplete()}},out:function(){if(this.busy){return}this.busy=true;this.events.hoveredNode=false;var B=this,z=this.config,D=this.graph,y=D.getNode(this.clickedNode&&this.clickedNode.id||this.root).getParents(),A=y[0],x=A,C=this.clickedNode;if(!A){this.busy=false;return}A.selected=true;var E={onComplete:function(){C.selected=false;B.clickedNode=A;if(z.request){B.requestNodes(A,{onComplete:function(){B.compute();B.plot();B.busy=false}})}else{B.compute();B.plot();B.busy=false}B.geom.setRightLevelToShow(A);B.plot()}};this.geom.setRightLevelToShow(A);if(z.animate){this.clickedNode=x;this.compute("end");this.clickedNode=C;this.fx.animate({duration:2*this.config.duration/3,modes:["linear",this.config.Node.props],onComplete:function(){B.clickedNode=x;x.eachSubgraph(function(F){F.setDataset(["current","end"],{alpha:[0,1]})},"ignore");C.eachSubgraph(function(F){F.setData("alpha",1)},"ignore");B.geom.setRightLevelToShow(A);B.fx.animate({duration:B.config.duration/3,modes:["node-property:alpha"],onComplete:function(){E.onComplete()}})}})}else{E.onComplete()}},requestNodes:function(z,A){var y=d.merge(this.controller,A),x=this.config.levelsToShow;if(y.request){var C=[],B=z._depth;z.eachLevel(0,x,function(E){var D=x-(E._depth-B);if(E.drawn&&!E.anySubnode()&&D>0){C.push(E);E._level=D}});this.group.requestNodes(C,y)}else{y.onComplete()}},reposition:function(){this.compute("end")}};w.Op=new r({Implements:f.Op,initialize:function(x){this.viz=x}});w.Geom=new r({Implements:f.Geom,getRightLevelToShow:function(){return this.viz.config.levelsToShow},setRightLevelToShow:function(y){var B=this.getRightLevelToShow(),A=this.viz.config.labelsToShow,x=this.viz.labels;var z={};y.eachLevel(0,false,function(D){var C=D._depth-y._depth;D._hideLabel=A[0]>=0&&C<A[0]||A[1]>=0&&C>A[1];if(B>0&&C>B){D.drawn=false;D.exist=false;D.ignore=true;x.hideLabel(D,false)}else{D.drawn=true;D.exist=true;delete D.ignore}z[D.name]=D._hideLabel});y.drawn=true;delete y.ignore}});w.Group=new r({initialize:function(x){this.viz=x;this.canvas=x.canvas;this.config=x.config},requestNodes:function(C,B){var A=0,y=C.length,E={};var z=function(){B.onComplete()};var x=this.viz;if(y==0){z()}for(var D=0;D<y;D++){E[C[D].id]=C[D];B.request(C[D].id,C[D]._level,{onComplete:function(G,F){if(F&&F.children){F.id=G;x.op.sum(F,{type:"nothing"})}if(++A==y){x.graph.computeLevels(x.root,0);z()}}})}}});w.Plot=new r({Implements:f.Plot,initialize:function(x){this.viz=x;this.config=x.config;this.node=this.config.Node;this.edge=this.config.Edge;this.animation=new v;this.nodeTypes=new w.Plot.NodeTypes;this.edgeTypes=new w.Plot.EdgeTypes;this.labels=x.labels},plot:function(z,y){var x=this.viz,A=x.graph;x.canvas.clear();this.plotTree(A.getNode(x.clickedNode&&x.clickedNode.id||x.root),d.merge(x.config,z||{},{withLabels:true,hideLabels:false,plotSubtree:function(C,B){return C.anySubnode("exist")}}),y)}});w.Label={};w.Label.Native=new r({Implements:f.Label.Native,initialize:function(x){this.config=x.config;this.leaf=x.leaf},renderLabel:function(A,B,C){if(B._hideLabel||!this.leaf(B)&&!this.config.titleHeight){return}var E=B.pos.getc(true),H=A.getCtx(),z=B.getData("width"),G=B.getData("height"),F=E.x+z/2,D=E.y;if(isNaN(z)||z===0){H.fillText(B.name,F,D)}else{H.fillText(B.name,F,D,z)}}});w.Label.SVG=new r({Implements:f.Label.SVG,initialize:function(x){this.viz=x;this.leaf=x.leaf;this.config=x.config},placeLabel:function(H,B,C){C=C||this.viz.controller;var F=B.pos.getc(true),y=this.viz.canvas,z=y.translateOffsetX,x=y.translateOffsetY,G=y.scaleOffsetX,E=y.scaleOffsetY,D=y.getSize();var A={x:Math.round(F.x*G+z+D.width/2),y:Math.round(F.y*E+x+D.height/2)};H.setAttribute("x",A.x);H.setAttribute("y",A.y);if(B._hideLabel||!this.leaf(B)&&!this.config.titleHeight){H.style.display="none"}C.onPlaceLabel(H,B)}});w.Label.HTML=new r({Implements:f.Label.HTML,initialize:function(x){this.viz=x;this.leaf=x.leaf;this.config=x.config},placeLabel:function(I,C,D){D=D||this.viz.controller;var G=C.pos.getc(true),z=this.viz.canvas,A=z.translateOffsetX,y=z.translateOffsetY,H=z.scaleOffsetX,F=z.scaleOffsetY,E=z.getSize();var B={x:Math.round(G.x*H+A+E.width/2),y:Math.round(G.y*F+y+E.height/2)};var x=I.style;x.left=B.x+"px";x.top=B.y+"px";x.width=Math.max(0,C.getData("width")*H)+"px";x.height=Math.max(0,C.getData("height")*F)+"px";x.zIndex=C._depth*100;x.display="";if(C._hideLabel||!this.leaf(C)&&!this.config.titleHeight){I.style.display="none"}D.onPlaceLabel(I,C)}});w.Plot.NodeTypes=new r({none:{render:d.empty},rectangle:{render:function(A,y,N){var E=this.viz.leaf(A),z=this.config,J=z.offset,D=z.titleHeight,I=A.pos.getc(true),x=A.getData("width"),K=A.getData("height"),C=A.getData("border"),M=y.getCtx(),H=I.x+J/2,F=I.y+J/2;if(x<=J||K<=J){return}if(E){if(z.cushion){var L=M.createRadialGradient(H+(x-J)/2,F+(K-J)/2,1,H+(x-J)/2,F+(K-J)/2,x<K?K:x);var B=A.getData("color");var G=d.rgbToHex(d.map(d.hexToRgb(B),function(O){return O*0.2>>0}));L.addColorStop(0,B);L.addColorStop(1,G);M.fillStyle=L}M.fillRect(H,F,x-J,K-J);if(C){M.save();M.strokeStyle=C;M.strokeRect(H,F,x-J,K-J);M.restore()}}else{if(D>0){M.fillRect(I.x+J/2,I.y+J/2,x-J,D-J);if(C){M.save();M.strokeStyle=C;M.strokeRect(I.x+J/2,I.y+J/2,x-J,K-J);M.restore()}}}},contains:function(A,C){if(this.viz.clickedNode&&!A.isDescendantOf(this.viz.clickedNode.id)||A.ignore){return false}var B=A.pos.getc(true),z=A.getData("width"),y=this.viz.leaf(A),x=y?A.getData("height"):this.config.titleHeight;return this.nodeHelper.rectangle.contains({x:B.x+z/2,y:B.y+x/2},C,z,x)}}});w.Plot.EdgeTypes=new r({none:d.empty});w.SliceAndDice=new r({Implements:[e,p,w.Base,h.TM.SliceAndDice]});w.Squarified=new r({Implements:[e,p,w.Base,h.TM.Squarified]});w.Strip=new r({Implements:[e,p,w.Base,h.TM.Strip]});$jit.RGraph=new r({Implements:[e,p,h.Radial],initialize:function(x){var y=$jit.RGraph;var z={interpolation:"linear",levelDistance:100};this.controller=this.config=d.merge(o("Canvas","Node","Edge","Fx","Controller","Tips","NodeStyles","Events","Navigation","Label"),z,x);var A=this.config;if(A.useCanvas){this.canvas=A.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(A.background){A.background=d.merge({type:"Circles"},A.background)}this.canvas=new m(this,A);this.config.labelContainer=(typeof A.injectInto=="string"?A.injectInto:A.injectInto.id)+"-label"}this.graphOptions={klass:b,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new y.Label[A.Label.type](this);this.fx=new y.Plot(this,y);this.op=new y.Op(this);this.json=null;this.root=null;this.busy=false;this.parent=false;this.initializeExtras()},createLevelDistanceFunc:function(){var x=this.config.levelDistance;return function(y){return(y._depth+1)*x}},refresh:function(){this.compute();this.plot()},reposition:function(){this.compute("end")},plot:function(){this.fx.plot()},getNodeAndParentAngle:function(E){var z=false;var D=this.graph.getNode(E);var B=D.getParents();var A=(B.length>0)?B[0]:false;if(A){var x=A.pos.getc(),C=D.pos.getc();var y=x.add(C.scale(-1));z=Math.atan2(y.y,y.x);if(z<0){z+=2*Math.PI}}return{parent:A,theta:z}},tagChildren:function(B,D){if(B.angleSpan){var C=[];B.eachAdjacency(function(E){C.push(E.nodeTo)},"ignore");var x=C.length;for(var A=0;A<x&&D!=C[A].id;A++){}for(var z=(A+1)%x,y=0;D!=C[z].id;z=(z+1)%x){C[z].dist=y++}}},onClick:function(C,y){if(this.root!=C&&!this.busy){this.busy=true;this.root=C;var z=this;this.controller.onBeforeCompute(this.graph.getNode(C));var A=this.getNodeAndParentAngle(C);this.tagChildren(A.parent,C);this.parent=A.parent;this.compute("end");var x=A.theta-A.parent.endPos.theta;this.graph.eachNode(function(D){D.endPos.set(D.endPos.getp().add(l(x,0)))});var B=this.config.interpolation;y=d.merge({onComplete:d.empty},y||{});this.fx.animate(d.merge({hideLabels:true,modes:[B]},y,{onComplete:function(){z.busy=false;y.onComplete()}}))}}});$jit.RGraph.$extend=true;(function(x){x.Op=new r({Implements:f.Op});x.Plot=new r({Implements:f.Plot});x.Label={};x.Label.Native=new r({Implements:f.Label.Native});x.Label.SVG=new r({Implements:f.Label.SVG,initialize:function(y){this.viz=y},placeLabel:function(I,C,D){var G=C.pos.getc(true),z=this.viz.canvas,A=z.translateOffsetX,y=z.translateOffsetY,H=z.scaleOffsetX,F=z.scaleOffsetY,E=z.getSize();var B={x:Math.round(G.x*H+A+E.width/2),y:Math.round(G.y*F+y+E.height/2)};I.setAttribute("x",B.x);I.setAttribute("y",B.y);D.onPlaceLabel(I,C)}});x.Label.HTML=new r({Implements:f.Label.HTML,initialize:function(y){this.viz=y},placeLabel:function(J,D,E){var H=D.pos.getc(true),A=this.viz.canvas,B=A.translateOffsetX,z=A.translateOffsetY,I=A.scaleOffsetX,G=A.scaleOffsetY,F=A.getSize();var C={x:Math.round(H.x*I+B+F.width/2),y:Math.round(H.y*G+z+F.height/2)};var y=J.style;y.left=C.x+"px";y.top=C.y+"px";y.display=this.fitsInCanvas(C,A)?"":"none";E.onPlaceLabel(J,D)}});x.Plot.NodeTypes=new r({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.circle.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.circle.contains(A,B,z)}},ellipse:{render:function(B,z){var C=B.pos.getc(true),A=B.getData("width"),y=B.getData("height");this.nodeHelper.ellipse.render("fill",C,A,y,z)},contains:function(A,C){var B=A.pos.getc(true),z=A.getData("width"),y=A.getData("height");return this.nodeHelper.ellipse.contains(B,C,z,y)}},square:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.square.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.square.contains(A,B,z)}},rectangle:{render:function(B,z){var C=B.pos.getc(true),A=B.getData("width"),y=B.getData("height");this.nodeHelper.rectangle.render("fill",C,A,y,z)},contains:function(A,C){var B=A.pos.getc(true),z=A.getData("width"),y=A.getData("height");return this.nodeHelper.rectangle.contains(B,C,z,y)}},triangle:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.triangle.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.triangle.contains(A,B,z)}},star:{render:function(z,y){var B=z.pos.getc(true),A=z.getData("dim");this.nodeHelper.star.render("fill",B,A,y)},contains:function(y,B){var A=y.pos.getc(true),z=y.getData("dim");return this.nodeHelper.star.contains(A,B,z)}}});x.Plot.EdgeTypes=new r({none:d.empty,line:{render:function(y,z){var B=y.nodeFrom.pos.getc(true),A=y.nodeTo.pos.getc(true);this.edgeHelper.line.render(B,A,z)},contains:function(y,B){var A=y.nodeFrom.pos.getc(true),z=y.nodeTo.pos.getc(true);return this.edgeHelper.line.contains(A,z,B,this.edge.epsilon)}},arrow:{render:function(z,A){var F=z.nodeFrom.pos.getc(true),E=z.nodeTo.pos.getc(true),D=z.getData("dim"),C=z.data.$direction,y=(C&&C.length>1&&C[0]!=z.nodeFrom.id),B=this.edge.arrowPosition||"end";this.edgeHelper.arrow.render(F,E,D,y,A,B)},contains:function(y,B){var A=y.nodeFrom.pos.getc(true),z=y.nodeTo.pos.getc(true);return this.edgeHelper.arrow.contains(A,z,B,this.edge.epsilon)}}})})($jit.RGraph);q.prototype.moebiusTransformation=function(z){var x=this.add(z);var y=z.$conjugate().$prod(this);y.x++;return x.$div(y)};f.Util.moebiusTransformation=function(z,B,A,y,x){this.eachNode(z,function(D){for(var C=0;C<A.length;C++){var F=B[C].scale(-1),E=y?y:A[C];D.getPos(A[C]).set(D.getPos(E).getc().moebiusTransformation(F))}},x)};$jit.Hypertree=new r({Implements:[e,p,h.Radial],initialize:function(x){var A=$jit.Hypertree;var y={radius:"auto",offset:0,Edge:{type:"hyperline"},duration:1500,fps:35};this.controller=this.config=d.merge(o("Canvas","Node","Edge","Fx","Tips","NodeStyles","Events","Navigation","Controller","Label"),y,x);var z=this.config;if(z.useCanvas){this.canvas=z.useCanvas;this.config.labelContainer=this.canvas.id+"-label"}else{if(z.background){z.background=d.merge({type:"Circles"},z.background)}this.canvas=new m(this,z);this.config.labelContainer=(typeof z.injectInto=="string"?z.injectInto:z.injectInto.id)+"-label"}this.graphOptions={klass:b,Node:{selected:false,exist:true,drawn:true}};this.graph=new f(this.graphOptions,this.config.Node,this.config.Edge);this.labels=new A.Label[z.Label.type](this);this.fx=new A.Plot(this,A);this.op=new A.Op(this);this.json=null;this.root=null;this.busy=false;this.initializeExtras()},createLevelDistanceFunc:function(){var B=this.getRadius();var D=0,x=Math.max,y=this.config;this.graph.eachNode(function(E){D=x(E._depth,D)},"ignore");D++;var C=function(E){return function(G){G.scale=B;var I=G._depth+1;var H=0,F=Math.pow;while(I){H+=F(E,I--)}return H-y.offset}};for(var A=0.51;A<=1;A+=0.01){var z=(1-Math.pow(A,D))/(1-A);if(z>=2){return C(A-0.01)}}return C(0.75)},getRadius:function(){var x=this.config.radius;if(x!=="auto"){return x}var y=this.canvas.getSize();return Math.min(y.width,y.height)/2},refresh:function(x){if(x){this.reposition();this.graph.eachNode(function(y){y.startPos.rho=y.pos.rho=y.endPos.rho;y.startPos.theta=y.pos.theta=y.endPos.theta})}else{this.compute()}this.plot()},reposition:function(){this.compute("end");var x=this.graph.getNode(this.root).pos.getc().scale(-1);f.Util.moebiusTransformation(this.graph,[x],["end"],"end","ignore");this.graph.eachNode(function(y){if(y.ignore){y.endPos.rho=y.pos.rho;y.endPos.theta=y.pos.theta}})},plot:function(){this.fx.plot()},onClick:function(z,x){var y=this.graph.getNode(z).pos.getc(true);this.move(y,x)},move:function(B,z){var y=s(B.x,B.y);if(this.busy===false&&y.norm()<1){this.busy=true;var x=this.graph.getClosestNodeToPos(y),A=this;this.graph.computeLevels(x.id,0);this.controller.onBeforeCompute(x);z=d.merge({onComplete:d.empty},z||{});this.fx.animate(d.merge({modes:["moebius"],hideLabels:true},z,{onComplete:function(){A.busy=false;z.onComplete()}}),y)}}});$jit.Hypertree.$extend=true;(function(x){x.Op=new r({Implements:f.Op});x.Plot=new r({Implements:f.Plot});x.Label={};x.Label.Native=new r({Implements:f.Label.Native,initialize:function(y){this.viz=y},renderLabel:function(A,C,z){var y=A.getCtx();var D=C.pos.getc(true);var B=this.viz.getRadius();y.fillText(C.name,D.x*B,D.y*B)}});x.Label.SVG=new r({Implements:f.Label.SVG,initialize:function(y){this.viz=y},placeLabel:function(J,D,E){var H=D.pos.getc(true),A=this.viz.canvas,B=A.translateOffsetX,z=A.translateOffsetY,I=A.scaleOffsetX,G=A.scaleOffsetY,F=A.getSize(),y=this.viz.getRadius();var C={x:Math.round((H.x*I)*y+B+F.width/2),y:Math.round((H.y*G)*y+z+F.height/2)};J.setAttribute("x",C.x);J.setAttribute("y",C.y);E.onPlaceLabel(J,D)}});x.Label.HTML=new r({Implements:f.Label.HTML,initialize:function(y){this.viz=y},placeLabel:function(K,E,F){var I=E.pos.getc(true),B=this.viz.canvas,C=B.translateOffsetX,A=B.translateOffsetY,J=B.scaleOffsetX,H=B.scaleOffsetY,G=B.getSize(),y=this.viz.getRadius();var D={x:Math.round((I.x*J)*y+C+G.width/2),y:Math.round((I.y*H)*y+A+G.height/2)};var z=K.style;z.left=D.x+"px";z.top=D.y+"px";z.display=this.fitsInCanvas(D,B)?"":"none";F.onPlaceLabel(K,E)}});x.Plot.NodeTypes=new r({none:{render:d.empty,contains:d.lambda(false)},circle:{render:function(A,y){var z=this.node,C=A.getData("dim"),B=A.pos.getc();C=z.transform?C*(1-B.squaredNorm()):C;B.$scale(A.scale);if(C>0.2){this.nodeHelper.circle.render("fill",B,C,y)}},contains:function(y,B){var z=y.getData("dim"),A=y.pos.getc().$scale(y.scale);return this.nodeHelper.circle.contains(A,B,z)}},ellipse:{render:function(B,z){var C=B.pos.getc().$scale(B.scale),A=B.getData("width"),y=B.getData("height");this.nodeHelper.ellipse.render("fill",C,A,y,z)},contains:function(A,C){var z=A.getData("width"),y=A.getData("height"),B=A.pos.getc().$scale(A.scale);return this.nodeHelper.circle.contains(B,C,z,y)}},square:{render:function(A,y){var z=this.node,C=A.getData("dim"),B=A.pos.getc();C=z.transform?C*(1-B.squaredNorm()):C;B.$scale(A.scale);if(C>0.2){this.nodeHelper.square.render("fill",B,C,y)}},contains:function(y,B){var z=y.getData("dim"),A=y.pos.getc().$scale(y.scale);return this.nodeHelper.square.contains(A,B,z)}},rectangle:{render:function(C,z){var B=this.node,A=C.getData("width"),y=C.getData("height"),D=C.pos.getc();A=B.transform?A*(1-D.squaredNorm()):A;y=B.transform?y*(1-D.squaredNorm()):y;D.$scale(C.scale);if(A>0.2&&y>0.2){this.nodeHelper.rectangle.render("fill",D,A,y,z)}},contains:function(A,C){var z=A.getData("width"),y=A.getData("height"),B=A.pos.getc().$scale(A.scale);return this.nodeHelper.rectangle.contains(B,C,z,y)}},triangle:{render:function(A,y){var z=this.node,C=A.getData("dim"),B=A.pos.getc();C=z.transform?C*(1-B.squaredNorm()):C;B.$scale(A.scale);if(C>0.2){this.nodeHelper.triangle.render("fill",B,C,y)}},contains:function(y,B){var z=y.getData("dim"),A=y.pos.getc().$scale(y.scale);return this.nodeHelper.triangle.contains(A,B,z)}},star:{render:function(A,y){var z=this.node,C=A.getData("dim"),B=A.pos.getc();C=z.transform?C*(1-B.squaredNorm()):C;B.$scale(A.scale);if(C>0.2){this.nodeHelper.star.render("fill",B,C,y)}},contains:function(y,B){var z=y.getData("dim"),A=y.pos.getc().$scale(y.scale);return this.nodeHelper.star.contains(A,B,z)}}});x.Plot.EdgeTypes=new r({none:d.empty,line:{render:function(y,z){var C=y.nodeFrom.pos.getc(true),B=y.nodeTo.pos.getc(true),A=y.nodeFrom.scale;this.edgeHelper.line.render({x:C.x*A,y:C.y*A},{x:B.x*A,y:B.y*A},z)},contains:function(y,C){var B=y.nodeFrom.pos.getc(true),A=y.nodeTo.pos.getc(true),z=y.nodeFrom.scale;this.edgeHelper.line.contains({x:B.x*z,y:B.y*z},{x:A.x*z,y:A.y*z},C,this.edge.epsilon)}},arrow:{render:function(z,A){var F=z.nodeFrom.pos.getc(true),E=z.nodeTo.pos.getc(true),B=z.nodeFrom.scale,D=z.getData("dim"),C=z.data.$direction,y=(C&&C.length>1&&C[0]!=z.nodeFrom.id);this.edgeHelper.arrow.render({x:F.x*B,y:F.y*B},{x:E.x*B,y:E.y*B},D,y,A)},contains:function(y,C){var B=y.nodeFrom.pos.getc(true),A=y.nodeTo.pos.getc(true),z=y.nodeFrom.scale;this.edgeHelper.arrow.contains({x:B.x*z,y:B.y*z},{x:A.x*z,y:A.y*z},C,this.edge.epsilon)}},hyperline:{render:function(y,z){var C=y.nodeFrom.pos.getc(),B=y.nodeTo.pos.getc(),A=this.viz.getRadius();this.edgeHelper.hyperline.render(C,B,A,z)},contains:d.lambda(false)}})})($jit.Hypertree)})();
/*! openspending.aggregator.js - Aggregation API tools
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Aggregator=OpenSpending.Aggregator||{};OpenSpending.Aggregator.configFromQueryString=function(d){var b=OpenSpending.Common.parseQueryString(d);var a={};_.each(b,function(f,e){if(e=="breakdown"){a.breakdown=f}else{if(e=="drilldown"){a.drilldowns=f.split("|")}else{if(e=="cut"){a.cuts=f.split("|")}}}});return a};OpenSpending.Aggregator.get=function(b){var a=this;a.config=b;if(!a.config.processEntry){a.config.processEntry=function(d){return d}}if(!a.config.measure){a.config.measure="amount"}a.queryData=function(){var f={},d=a.config;f.dataset=d.dataset;f.drilldown=d.drilldowns.join("|");f.order=d.order;f.page=d.page;f.pagesize=d.pagesize;if(d.cuts!==undefined){f.cut=d.cuts.join("|")}var e=d.drilldowns.slice();if(d.breakdown!==undefined&&d.breakdown.length){e.push(d.breakdown)}e=jQuery.unique(e);f.drilldown=e.join("|");return f};a.queryUrl=function(){var e,d=a.config;if(d.localApiCache!==undefined){return d.localApiCache}apiUrl=d.apiUrl||d.siteUrl+"/api";return apiUrl+"/2/aggregate"};a.getTree=function(){var e=a.queryData();var d=window.btoa(jQuery.param(e)).replace(/\=/g,"");jQuery.ajax({url:a.queryUrl(),cache:true,data:e,jsonpCallback:"aggregate_"+d,dataType:a.config.localApiCache!==undefined?"json":"jsonp",context:a,success:a.onJSONTreeLoaded})};a.getCSVURL=function(){var d=a.queryUrl();var e=a.queryData();e.format="csv";return d+"?"+jQuery.param(e)};a.onJSONTreeLoaded=function(e){var d=a.buildTree(e);if(jQuery.isFunction(a.config.callback)){a.config.callback(d)}};a.buildTree=function(l){var m=l.drilldown,f=a.config,h=f.drilldowns,e=f.breakdown,g={label:f.rootNodeLabel},d={},o={id:"root",label:"Total",color:"#555",currency:l.summary.currency[a.config.measure],children:[],level:0,breakdowns:{}};o[a.config.measure]=0;if(g!==undefined){jQuery.extend(true,o,g)}d.root=o;for(var k in h){var j=h[k];d[j]={}}if(l.errors!==undefined){throw"Error"}for(var n=0;n<m.length;n++){var p=a.config.processEntry(m[n],l);a.processEntry(p,d)}return d.root};a.processEntry=function(l,e){var m=e.root,d=0,i,h=a.config.drilldowns,k,f,g;for(var j in h){i=h[j];d=d+1;k=l[i];g=a.toNode(k,m);f=e[g.id];if(f===undefined){f=g;f.children=[];f[a.config.measure]=0;f.color=k?k.color:undefined;f.level=d;f.breakdowns={};f.currency=m.currency;m.children.push(f);e[f.id]=f}f[a.config.measure]=f[a.config.measure]+l[a.config.measure];if(d===1){e.root[a.config.measure]=e.root[a.config.measure]+l[a.config.measure];a.addBreakdown(e.root,l)}a.addBreakdown(f,l);m=f}};a.addBreakdown=function(h,g){var i=a.config.breakdown;if(i===undefined){return}var f,j,e,d={},k;f=g[i];e=a.toNode(f);k=e.id;j=h.breakdowns[k];if(j===undefined){j=e;h.breakdowns[k]=j}j[a.config.measure]=j[a.config.measure]+g[a.config.measure]};a.toNode=function(g,e){var d=typeof(g);var f={};prefix=e?e.id+"__":"";if(g===undefined||g===null){f.id="others";f.label="Others";f.name="others"}else{if(d==="object"){if(g.id===undefined){f.id="others";f.label="Others";f.name="others"}else{jQuery.extend(true,f,g);if(!f.name){if(f.label){f.name=f.label.toLowerCase().replace(/\W/g,"-")}else{f.name=f.id}}}}else{if(d==="boolean"){if(g){f.id="yes";f.label="Yes";f.name="yes"}else{f.id="no";f.label="No";f.name="no"}}else{if(d==="string"||d==="number"){f.id=g+"";f.label=g+"";f.name=f.id.toLowerCase().replace(/\W/g,"-")}else{throw"unsupported type: "+d}}}}f.id=prefix+f.id;f[a.config.measure]=0;return f};a.getTree()};
/*! openspending.amounts.js - Amount formatting for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Amounts=OpenSpending.Amounts||{};OpenSpending.Amounts.shorthand=function(e){var b=1000000000;var a=1000000;var f=1000;var d=Math.abs(e);if(d>b){return OpenSpending.Amounts.format(e/b)+"bn"}else{if(d>a){return OpenSpending.Amounts.format(e/a)+"m"}else{if(d>f){return OpenSpending.Amounts.format(e/f)+"k"}else{return OpenSpending.Amounts.format(e,2)}}}};OpenSpending.Amounts.format=function(d,b,a){a=OpenSpending.Amounts.currencySymbol(a);return accounting.formatMoney(d,a,b||0,OpenSpending.localeGroupSeparator,OpenSpending.localeDecimalSeparator)};OpenSpending.Amounts.currencySymbol=function(a){if(a){return OpenSpending.Amounts.currencySymbols[a]||a}else{return""}};OpenSpending.Amounts.currencySymbols={AED:"د.إ",AFN:"؋",ALL:"L",AMD:"դր.",ANG:"ƒ",AOA:"Kz",ARS:"$",AUD:"$",AWG:"ƒ",AZN:"m",BAM:"KM",BBD:"$",BDT:"৳",BGN:"лв",BHD:"ب.د",BIF:"Fr",BMD:"$",BND:"$",BOB:"Bs.",BRL:"R$",BSD:"$",BTN:"Nu",BWP:"P",BYR:"Br",BZD:"$",CAD:"$",CDF:"Fr",CHF:"Fr",CLP:"$",CNY:"¥",COP:"$",CRC:"₡",CUP:"$",CVE:"$, Esc",CZK:"Kč",DJF:"Fr",DKK:"kr",DOP:"$",DZD:"د.ج",EEK:"KR",EGP:"£,ج.م",ERN:"Nfk",ETB:"Br",EUR:"€",FJD:"$",FKP:"£",GBP:"£",GEL:"ლ",GHS:"₵",GIP:"£",GMD:"D",GNF:"Fr",GTQ:"Q",GYD:"$",HKD:"$",HNL:"L",HRK:"kn",HTG:"G",HUF:"Ft",IDR:"Rp",ILS:"₪",INR:"₨",IQD:"ع.د",IRR:"﷼",ISK:"kr",JMD:"$",JOD:"د.ا",JPY:"¥",KES:"KSh",KGS:"лв",KHR:"៛",KMF:"Fr",KPW:"₩",KRW:"₩",KWD:"د.ك",KYD:"$",KZT:"Т",LAK:"₭",LBP:"ل.ل",LKR:"ரூ",LRD:"$",LSL:"L",LTL:"Lt",LVL:"Ls",LYD:"ل.د",MAD:"د.م.",MDL:"MDL",MGA:"Ar",MKD:"ден",MMK:"K",MNT:"₮",MOP:"P",MRO:"UM",MUR:"₨",MVR:"ރ.",MWK:"MK",MXN:"$",MYR:"RM",MZN:"MT",NAD:"$",NGN:"₦",NIO:"C$",NOK:"kr",NPR:"₨",NZD:"$",OMR:"ر.ع.",PAB:"B/.",PEN:"S/.",PGK:"K",PHP:"₱",PKR:"₨",PLN:"zł",PYG:"₲",QAR:"ر.ق",RON:"RON",RSD:"RSD",RUB:"р.",RWF:"Fr",SAR:"ر.س",SBD:"$",SCR:"₨",SDG:"S$",SEK:"kr",SGD:"$",SHP:"£",SLL:"Le",SOS:"Sh",SRD:"$",STD:"Db",SYP:"£, ل.س",SZL:"L",THB:"฿",TJS:"ЅМ",TMT:"m",TND:"د.ت",TOP:"T$",TRY:"₤",TTD:"$",TWD:"$",TZS:"Sh",UAH:"₴",UGX:"Sh",USD:"$",UYU:"$",UZS:"лв",VEF:"Bs",VND:"₫",VUV:"Vt",WST:"T",XAF:"Fr",XCD:"$",XOF:"Fr",XPF:"Fr",YER:"﷼",ZAR:"R",ZMK:"ZK",ZWL:"$"};
/*! openspending.colors.js - Color palettes for OpenSpending
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Colors=OpenSpending.Colors||{};OpenSpending.Colors.DefaultPalette=["#CA221D","#C22769","#3F93E1","#481B79","#6AAC32","#42928F","#D32645","#CD531C","#EDC92D","#A5B425","#211D79","#449256","#7A2077","#CA221D","#E29826","#44913D","#2458A3","#2458A3","#14388C"];OpenSpending.Colors.DefaultPalette.getColor=function(d,e){var b=this.slice(0);if(e){var a=b.indexOf(e.toUpperCase());if(a!==-1){b.splice(a,1)}}return b[d%(b.length)]};
/*! openspending.common.js - Common javascript utils for openspendingjs
 * ------------------------------------------------------------------------
 *
 * Copyright 2013 Open Knowledge Foundation
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
;var OpenSpending=OpenSpending||{};OpenSpending.Common=OpenSpending.Common||{};OpenSpending.Common.parseQueryString=function(a){var g=a||window.location.search.substring(1);var b={};var d=function(h){return unescape(h.replace(/\+/g," "))};var f=/([^&=]+)=?([^&]*)/g;var e=undefined;while(e=f.exec(g)){b[d(e[1])]=d(e[2])}return b};!function(a){a.treemap=function(h,g){var e=a(h);if(!e.attr("id")){e.attr("id",Math.random().toString().substr(2))}var f=a.extend(true,{},a.treemap.defaults,a.treemap.domopts(h),g);var j={drilldowns:f.data.drilldowns,cuts:f.data.cuts,year:f.data.year};var d=function(l){e.empty();if(!l.children.length){e.hide();return}e.show();var k=new $jit.TM.Squarified({injectInto:h,width:f.width,height:f.height,levelsToShow:1,titleHeight:0,animate:f.transition.animate,transition:f.transition.type,duration:f.transition.duration,offset:2,Label:{type:"HTML",size:12,family:"Tahoma, Verdana, Arial",color:"#DDE7F0"},onCreateLabel:function(n,m){f.node.label(n,m)},Tips:{enable:true,type:"Native",offsetX:20,offsetY:20,onShow:function(n,m){n.innerHTML=f.node.tooltip(m)}},Node:{color:"#243448",CanvasStyles:{shadowBlur:0,shadowColor:"#000"}},Events:{enable:true,onClick:function(n){if(n){var o=f.click(n);if(o){if(n.data.node.children.length){i(n.data.node)}else{if(n.data.link){var m=this.embed?n.data.link+"?embed=true":n.data.link;document.location.href=m}else{alert("Not able to go any further")}}}}},onMouseEnter:function(m,n,o){if(m){if(m.data.link===undefined){e.find("#"+m.id).css("cursor","default")}m.setCanvasStyle("shadowBlur",8);m.orig_color=m.getData("color");m.setData("color","#A3B3C7");k.fx.plotNode(m,k.canvas)}},onMouseLeave:function(m){if(m){m.removeData("color");m.removeCanvasStyle("shadowBlur");m.setData("color",m.orig_color);k.plot()}}},request:function(p,q,o){var m=json;var n=$jit.json.getSubtree(m,p);$jit.json.prune(n,1);o.onComplete(p,n)}});k.loadJSON(l);k.refresh()};var i=function(k){var l={children:_.map(k.children,function(n,m){return{id:n.id,name:n.label||n.name,data:{node:n,value:n.amount,currency:n.currency,percentage:(n.amount/k.amount)*100,$area:n.amount,link:n.html_url,$color:n.color||f.colorscale.getColor(m)}}})};d(l)};var b=function(){j.drilldowns=j.drilldowns||[j.drilldown];j.cuts=j.cuts||{};var k=[];for(var l in j.cuts){k.push(l+":"+j.cuts[l])}if(j.year){k.push("time.year:"+j.year)}if(j.drilldowns){OpenSpending.Aggregator.get({siteUrl:f.data.site,dataset:f.data.dataset,drilldowns:j.drilldowns,cuts:k,rootNodeLabel:"Total",callback:i})}};e.addClass("treemap-widget");b()};a.treemap.defaults={data:{site:"http://openspending.org",dataset:undefined,drilldowns:["from","to"],year:undefined,cuts:{}},click:function(b){return true},width:600,height:400,embed:false,colorscale:OpenSpending.Colors.DefaultPalette,transition:{animate:true,type:$jit.Trans.Expo.easeOut,duration:1000},node:{label:function(d,b){if(b.data.percentage>3){d.innerHTML=['<div class="desc"><div class="amount">',OpenSpending.Amounts.format(b.data.value,0,b.data.currency),'</div><div class="lbl">',b.name,"</div></div>"].join("")}},tooltip:function(b){return[b.name," (",OpenSpending.Amounts.format(b.data.percentage,2),"%)"].join("")}}};a.treemap.domopts=function(d){var b=a(d);return{data:{site:b.attr("data-site"),dataset:b.attr("data-dataset"),drilldowns:a(d).attr("data-drilldowns")?b.attr("data-drilldowns").split(","):undefined,year:b.attr("data-year"),cuts:a(d).attr("data-cuts")?JSON.parse(b.attr("data-cuts")):undefined},width:b.attr("data-width"),height:b.attr("data-height"),transition:{duration:b.attr("data-duration")}}};a.fn.extend({treemap:function(b){if(b==undefined){b={}}this.each(function(){a.treemap(this,b)})}});a(".treemap[data-dataset]").treemap()}(jQuery);